{"config":{"lang":["en"],"separator":"[\\s\\-\\.]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Papyrus","text":"<p>A cross-platform e-book reading and management application</p>"},{"location":"#overview","title":"Overview","text":"<p>Papyrus is an open-source application for reading and managing both physical and digital books. It provides a versatile, user-friendly system that makes reading comfortable and fun across Android, iOS, Web, Desktop (Windows, macOS, Linux), and e-ink devices. Papyrus features an intuitive, modern UI with extensive customization options, unifying book organization, reading, note-taking, progress tracking, and personalized settings in a single application.</p>"},{"location":"#why-papyrus","title":"Why Papyrus?","text":"<p>Existing solutions often fall short in one or more areas:</p> Problem How Papyrus Solves It Fragmented ecosystems (Kindle, Kobo) Single app works everywhere with your books Complex desktop-only tools (Calibre) Simple, intuitive interface on all platforms Subscription-based cloud services Self-hostable, no mandatory subscriptions Privacy concerns with analytics No analytics by default, opt-in telemetry Poor e-ink device support Optimized UI for e-ink displays No offline functionality Offline-first design with optional sync"},{"location":"#goals","title":"Goals","text":"<ol> <li>Cross-platform - Manage books seamlessly across all devices without relearning the UI</li> <li>Integrated reader - Read e-books with extensive customization options</li> <li>Flexible management - Organize books into shelves, categories, and tags with powerful filtering</li> <li>Progress tracking - Track reading time, books read, and achieve reading goals</li> <li>Storage flexibility - Choose between local, self-hosted, or cloud storage</li> <li>Data ownership - Export everything in open formats; your data is yours</li> <li>Privacy first - No default analytics; optional self-hosted synchronization</li> <li>Extensible - Plugin system for metadata sources, storage, and reader features</li> <li>Developer friendly - Public REST API and easy self-hosting</li> </ol>"},{"location":"#target-audience","title":"Target Audience","text":"<ul> <li>Regular readers who consume digital and/or physical books and need a centralized library management solution</li> <li>Habit builders who want to track reading statistics and build reading habits through goals</li> <li>Privacy-conscious users who prefer local control over their data</li> <li>Multi-device users who read on phones, tablets, e-readers, and computers</li> <li>E-ink device owners who want a dedicated reading experience optimized for their hardware</li> </ul>"},{"location":"#supported-platforms","title":"Supported Platforms","text":"Platform Status Notes Android (8.0+) Primary Full feature support iOS (12.0+) Primary Full feature support Web (Chrome, Firefox, Safari, Edge) Primary PWA with offline support Windows (10+) Primary Native desktop experience macOS (10.15+) Primary Native desktop experience Linux Primary Native desktop experience E-ink devices Secondary Optimized grayscale UI, reduced animations"},{"location":"#supported-e-book-formats","title":"Supported E-book Formats","text":"Format Read Convert To Notes EPUB Yes Yes Primary format, full feature support PDF Yes Yes Fixed layout support MOBI Yes Yes Kindle format AZW3 Yes No Kindle format (read-only) TXT Yes Yes Plain text CBR/CBZ Yes No Comic book archives FB2 Planned Planned Future support DOCX Planned Planned Future support"},{"location":"#feature-overview","title":"Feature Overview","text":""},{"location":"#core-features-mvp","title":"Core Features (MVP)","text":"<p>These features define the minimum viable product and are prioritized for initial release:</p>"},{"location":"#1-book-management","title":"1. Book Management","text":"<ul> <li>Import books from local storage, URL, or cloud services (Google Drive, OneDrive, Dropbox)</li> <li>Organize with shelves - user-defined collections (e.g., \"Currently Reading\", \"Sci-Fi\")</li> <li>Tag books with color-coded labels (0-10 tags per book)</li> <li>Edit metadata manually or fetch from online sources (Open Library, Google Books)</li> <li>Search and filter by title, author, tags, shelves, reading status, and more</li> <li>Physical book tracking - manually add and track physical books in your library</li> </ul>"},{"location":"#2-integrated-e-book-reader","title":"2. Integrated E-book Reader","text":"<p>Typography controls:</p> <ul> <li>Font family selection (built-in and custom fonts)</li> <li>Font size, weight, line spacing, paragraph spacing</li> <li>Text alignment (left, right, center, justified)</li> <li>RTL language support</li> </ul> <p>Appearance:</p> <ul> <li>Background color themes (light, dark, sepia, custom)</li> <li>Text and link color customization</li> <li>Adjustable margins and padding</li> <li>Brightness control (in-app)</li> </ul> <p>Navigation:</p> <ul> <li>Single-page and two-page layouts</li> <li>Paginated and continuous scroll modes</li> <li>Table of contents navigation</li> <li>Go-to-page/percentage jump</li> <li>Progress bar with position indicator</li> <li>Touch zones, swipe gestures, volume key navigation</li> </ul> <p>Reading profiles:</p> <ul> <li>Save named presets of all reader settings</li> <li>Quick profile switching</li> <li>Default profile per device</li> <li>Profile import/export</li> </ul>"},{"location":"#3-annotations-and-notes","title":"3. Annotations and Notes","text":"<ul> <li>Highlight text with multiple colors</li> <li>Add notes to highlights or create standalone book notes</li> <li>Bookmarks for quick navigation</li> <li>Export annotations to text, PDF, or Markdown</li> <li>Search across all annotations and notes</li> </ul>"},{"location":"#4-reading-progress-and-goals","title":"4. Reading Progress and Goals","text":"<p>Automatic tracking:</p> <ul> <li>Reading time per book and total</li> <li>Pages/percentage read</li> <li>Books started, in progress, completed</li> <li>Reading velocity statistics</li> </ul> <p>Goals:</p> <ul> <li>Time-based goals (e.g., \"Read 30 minutes daily\")</li> <li>Book count goals (e.g., \"Read 12 books this year\")</li> <li>Custom goals with manual progress updates</li> <li>Visual progress indicators and charts</li> </ul> <p>Synchronization:</p> <ul> <li>Reading position synced across devices</li> <li>Progress and statistics synchronized</li> </ul>"},{"location":"#5-storage-and-sync","title":"5. Storage and Sync","text":"<p>Storage options:</p> <ul> <li>Device local storage (default, no account required)</li> <li>Self-hosted server (for privacy-focused users)</li> <li>Cloud storage (Google Drive, OneDrive, Dropbox)</li> <li>Network storage (NAS, shared folders)</li> </ul> <p>Offline support:</p> <ul> <li>Full offline functionality without account</li> <li>Automatic sync when online</li> <li>Conflict resolution options</li> </ul>"},{"location":"#advanced-features-post-mvp","title":"Advanced Features (Post-MVP)","text":"<p>These features are planned for future releases:</p> <ul> <li>Format conversion between EPUB, PDF, and MOBI</li> <li>OPDS catalog browsing - download from online catalogs</li> <li>OCR processing - extract text from scanned documents</li> <li>Audiobook support - manage and play audiobooks with synchronized progress</li> <li>Text-to-speech - read books aloud</li> <li>Social features - share progress, reviews, and recommendations</li> <li>AI-powered features - summaries, recommendations, smart categorization</li> <li>ISBN barcode scanning - add physical books by scanning</li> <li>Plugin system - extend functionality with community plugins</li> </ul>"},{"location":"#documentation","title":"Documentation","text":"<p>This specification provides comprehensive documentation for development and maintenance:</p>"},{"location":"#requirements","title":"Requirements","text":"<ul> <li>Requirements Overview - Structure and traceability</li> <li>Functional Requirements - What the system does</li> <li>Non-Functional Requirements - How the system performs</li> </ul>"},{"location":"#system-design","title":"System Design","text":"<ul> <li>Actors - User types and their interactions</li> <li>Use Cases - Detailed workflows and scenarios</li> <li>Entities - Data model and relationships</li> <li>Database Model - Database schema and design</li> </ul>"},{"location":"#implementation","title":"Implementation","text":"<ul> <li>Technologies - Technology stack and architecture</li> <li>User Interface - Design guidelines and UI specifications</li> <li>Market Analysis - Competitive landscape and positioning</li> </ul>"},{"location":"#quick-reference","title":"Quick Reference","text":""},{"location":"#requirement-notation","title":"Requirement Notation","text":"Prefix Meaning Example FR-X.Y Functional Requirement FR-2.1 (Book conversion) NFR-X.Y Non-Functional Requirement NFR-4.1 (Startup time) UC-X.Y Use Case UC-2.1 (Import books)"},{"location":"#feature-priority-levels","title":"Feature Priority Levels","text":"Level Description P0 - Critical Must have for MVP launch P1 - High Should have for MVP, can defer if needed P2 - Medium Nice to have, planned for post-MVP P3 - Low Future consideration, not planned"},{"location":"SUMMARY/","title":"Table of Contents","text":""},{"location":"SUMMARY/#introduction","title":"Introduction","text":"<ul> <li>Papyrus Overview - Project goals, features, and supported platforms</li> </ul>"},{"location":"SUMMARY/#analysis","title":"Analysis","text":"<ul> <li>Market Analysis - Competitive landscape and target audience</li> </ul>"},{"location":"SUMMARY/#requirements","title":"Requirements","text":"<ul> <li>Requirements Overview - Requirement structure and traceability</li> <li>Functional Requirements - System capabilities and features</li> <li>Non-Functional Requirements - Performance, security, and quality attributes</li> </ul>"},{"location":"SUMMARY/#system-design","title":"System Design","text":"<ul> <li>Actors - User types, personas, and their goals</li> <li>Use Cases - Detailed workflows and user scenarios</li> <li>Entities - Data model, attributes, and relationships</li> <li>Database Model - Database schema, constraints, and design principles</li> <li>Server Architecture - Metadata server, file storage backends, and synchronization</li> </ul>"},{"location":"SUMMARY/#implementation","title":"Implementation","text":"<ul> <li>Technologies - Technology stack, architecture, and deployment</li> <li>User Interface - Design system, screen specifications, and accessibility</li> </ul>"},{"location":"SUMMARY/#reference","title":"Reference","text":"<ul> <li>External Resources - Supporting documents and references</li> </ul>"},{"location":"actors/","title":"Actors","text":"<p>This section defines the user types that interact with Papyrus. Each actor represents a distinct user group with specific needs, goals, and interaction patterns.</p>"},{"location":"actors/#actor-summary","title":"Actor Summary","text":"Actor Type Description Key Use Cases Reader Primary Core user who reads and manages books UC-2.x, UC-3.x, UC-4.x, UC-5.x Anonymous User Primary Uses app without account (offline mode) UC-1.4, UC-2.x, UC-3.x Registered User Primary Has account for sync and cloud features UC-1.x, UC-7.x E-ink Reader Primary Uses dedicated e-reader devices UC-3.x (reading-focused) System Administrator Secondary Manages self-hosted server instances UC-7.1 Developer Secondary Integrates via API or builds extensions API access"},{"location":"actors/#primary-actors","title":"Primary Actors","text":""},{"location":"actors/#reader","title":"Reader","text":"<p>The core user of Papyrus who uses the application for reading and managing their book collection.</p> <p>Profile:</p> <ul> <li>Regularly consumes digital and/or physical books</li> <li>Uses multiple devices (phone, tablet, computer, e-reader)</li> <li>Values a seamless reading experience across platforms</li> <li>Technical expertise ranges from beginner to advanced</li> </ul> <p>Goals:</p> <ul> <li>Read books comfortably on any device</li> <li>Organize and manage book collections efficiently</li> <li>Track reading progress and build reading habits</li> <li>Take notes and highlights while reading</li> <li>Achieve personal reading goals</li> </ul> <p>Primary Use Cases:</p> <ul> <li>UC-2.1 Import book files</li> <li>UC-2.4 Organize books into shelves</li> <li>UC-2.5 Tag books</li> <li>UC-2.6 Search books</li> <li>UC-3.1 Read with integrated viewer</li> <li>UC-3.2 Customize reading experience</li> <li>UC-4.1 Create annotations</li> <li>UC-5.1 Track reading progress</li> <li>UC-6.1 Create reading goals</li> </ul> <p>Requirements Addressed:</p> <ul> <li>FR-2.x (Book Management)</li> <li>FR-3.x (Integrated Viewer)</li> <li>FR-4.x (Annotations and Notes)</li> <li>FR-5.x (Progress Tracking)</li> <li>FR-6.x (Goal Management)</li> </ul>"},{"location":"actors/#anonymous-user","title":"Anonymous User","text":"<p>A user who accesses Papyrus without creating an account, using the application entirely in offline mode.</p> <p>Profile:</p> <ul> <li>Privacy-conscious individuals who avoid cloud services</li> <li>Users evaluating the application before committing</li> <li>Users in areas with limited or unreliable internet</li> <li>Users who prefer complete data control</li> </ul> <p>Goals:</p> <ul> <li>Use all reading features without registration</li> <li>Maintain complete privacy and local data control</li> <li>Access the application without internet dependency</li> <li>Optionally convert to registered user later without data loss</li> </ul> <p>Constraints:</p> <ul> <li>No cross-device synchronization</li> <li>No cloud storage options</li> <li>All data stored locally on device</li> <li>Must manually transfer data between devices</li> </ul> <p>Primary Use Cases:</p> <ul> <li>UC-1.4 Use application offline</li> <li>UC-2.1 Import book files</li> <li>UC-3.1 Read books</li> <li>UC-2.7 Export books and data</li> </ul> <p>Requirements Addressed:</p> <ul> <li>FR-1.4 (Offline Mode)</li> <li>NFR-2.1 (Online/Offline Parity)</li> <li>NFR-6.5 (No Default Analytics)</li> </ul>"},{"location":"actors/#registered-user","title":"Registered User","text":"<p>A user with an account who can access synchronization and cloud features.</p> <p>Profile:</p> <ul> <li>Users who want cross-device synchronization</li> <li>Users with multiple reading devices</li> <li>Users who value cloud backup and recovery</li> <li>May use official cloud or self-hosted server</li> </ul> <p>Goals:</p> <ul> <li>Synchronize library and progress across all devices</li> <li>Back up reading data securely</li> <li>Access books from anywhere</li> <li>Recover data if device is lost</li> </ul> <p>Primary Use Cases:</p> <ul> <li>UC-1.1 Create user account</li> <li>UC-1.2 Login with credentials</li> <li>UC-1.3 Login with Google</li> <li>UC-1.5 Recover password</li> <li>UC-7.1 Configure storage</li> <li>UC-7.3 Synchronize data</li> </ul> <p>Requirements Addressed:</p> <ul> <li>FR-1.x (User Management)</li> <li>FR-5.3 (Cross-Device Sync)</li> <li>FR-7.1 (Storage Options)</li> <li>NFR-2.x (Synchronization)</li> </ul>"},{"location":"actors/#e-ink-reader","title":"E-ink Reader","text":"<p>A user who primarily reads on dedicated e-ink devices (Kindle, Kobo, reMarkable, etc.).</p> <p>Profile:</p> <ul> <li>Owns one or more e-ink reading devices</li> <li>Values long reading sessions with minimal eye strain</li> <li>May have limited device capabilities (grayscale, slower refresh)</li> <li>Prefers distraction-free reading environment</li> </ul> <p>Goals:</p> <ul> <li>Comfortable extended reading sessions</li> <li>Optimized UI for e-ink display characteristics</li> <li>Minimal battery consumption</li> <li>Fast page turns with reduced screen flashing</li> </ul> <p>Specific Needs:</p> <ul> <li>High contrast, grayscale-optimized interface</li> <li>Reduced or disabled animations</li> <li>Simplified navigation for slower displays</li> <li>Large, clear touch targets</li> <li>Support for hardware buttons (page turn)</li> </ul> <p>Primary Use Cases:</p> <ul> <li>UC-3.1 Read books (primary focus)</li> <li>UC-3.2 Customize reading experience</li> <li>UC-3.3 Manage reading profiles</li> <li>UC-4.1 Create annotations</li> </ul> <p>Requirements Addressed:</p> <ul> <li>NFR-3.4 (E-Reader Support)</li> <li>NFR-5.2 (Accessibility)</li> <li>FR-3.2 (Viewer Customization)</li> <li>FR-3.3 (Reading Profiles)</li> </ul>"},{"location":"actors/#secondary-actors","title":"Secondary Actors","text":""},{"location":"actors/#system-administrator","title":"System Administrator","text":"<p>A technical user responsible for deploying and maintaining self-hosted Papyrus server instances.</p> <p>Profile:</p> <ul> <li>Technical expertise in server administration</li> <li>Manages Papyrus for personal use or organizations</li> <li>Responsible for security and maintenance</li> <li>Familiar with Docker, databases, networking</li> </ul> <p>Goals:</p> <ul> <li>Deploy Papyrus server with minimal friction</li> <li>Ensure system security and data protection</li> <li>Monitor performance and resource usage</li> <li>Manage user accounts (for organization deployments)</li> <li>Perform backups and disaster recovery</li> </ul> <p>Interactions:</p> <ul> <li>Server installation via Docker/Docker Compose</li> <li>Database configuration and maintenance</li> <li>Storage backend setup (local, MinIO, S3)</li> <li>SSL/TLS certificate management</li> <li>User account administration</li> <li>Log monitoring and troubleshooting</li> </ul> <p>Requirements Addressed:</p> <ul> <li>NFR-7.1 (Uptime)</li> <li>NFR-7.4 (Backup/Restore)</li> <li>NFR-1.2 (Storage Backends)</li> <li>NFR-6.x (Security)</li> </ul>"},{"location":"actors/#developer","title":"Developer","text":"<p>A technical user who integrates with Papyrus via API or develops extensions.</p> <p>Profile:</p> <ul> <li>Software developers and system integrators</li> <li>Plugin/extension developers</li> <li>Third-party service providers</li> <li>Researchers and data analysts</li> </ul> <p>Goals:</p> <ul> <li>Integrate Papyrus with other systems</li> <li>Build custom clients or frontends</li> <li>Develop plugins for extended functionality</li> <li>Export/analyze reading data programmatically</li> </ul> <p>Interactions:</p> <ul> <li>REST API authentication and usage</li> <li>API documentation (OpenAPI/Swagger)</li> <li>Plugin development framework</li> <li>Data export formats (JSON, CSV)</li> <li>Webhook integrations</li> </ul> <p>Requirements Addressed:</p> <ul> <li>FR-7.4 (Plugin System)</li> <li>NFR-8.1 (Extensibility)</li> </ul>"},{"location":"actors/#actor-relationships","title":"Actor Relationships","text":"<pre><code>flowchart TB\n    subgraph PapyrusSystem[\"Papyrus System\"]\n        subgraph PrimaryActors[\"Primary Actors\"]\n            Anonymous[\"Anonymous User\"]\n            Reader[\"Reader&lt;br/&gt;(Base Role)\"]\n            Registered[\"Registered User\"]\n\n            Anonymous --&gt; Reader\n            Registered --&gt; Reader\n\n            Reader --&gt; Eink[\"E-ink Reader\"]\n            Reader --&gt; DesktopMobile[\"Desktop/Mobile User\"]\n        end\n\n        Anonymous -.-&gt;|\"May upgrade to\"| Registered\n\n        subgraph SecondaryActors[\"Secondary Actors (Server/API Layer)\"]\n            Admin[\"System Administrator\"]\n            Developer[\"Developer\"]\n\n            Admin &lt;--&gt; Developer\n        end\n    end</code></pre> <p>Key Relationships:</p> <ul> <li>Anonymous User can upgrade to Registered User while preserving data</li> <li>Reader is the base role; Anonymous, Registered, and E-ink Reader inherit capabilities</li> <li>E-ink Reader is a specialized form of Reader with specific UI requirements</li> <li>System Administrator manages the infrastructure that Registered Users depend on</li> <li>Developer interacts with the system programmatically via API</li> </ul>"},{"location":"database-model/","title":"Database Model","text":"<p>This section presents the database schema for Papyrus, showing table structures, relationships, constraints, and design principles.</p>"},{"location":"database-model/#schema-overview","title":"Schema Overview","text":"<p>The database consists of 16 tables organized into functional groups:</p> Group Tables User Management USER Book Management BOOK, SHELF, TAG, SERIES Reading Experience ANNOTATION, NOTE, BOOKMARK Progress &amp; Goals READING_SESSION, READING_GOAL Configuration READING_PROFILE, METADATA_SERVER_CONFIG, FILE_STORAGE_BACKEND, SAVED_FILTER Junction Tables BOOK_SHELF, BOOK_TAG"},{"location":"database-model/#entity-relationship-diagram","title":"Entity Relationship Diagram","text":"<pre><code>erDiagram\n    USER {\n        uuid user_id PK\n        varchar email UK\n        varchar password_hash\n        varchar display_name\n        varchar avatar_url\n        varchar google_id UK\n        boolean is_anonymous\n        boolean is_active\n        boolean email_verified\n        timestamp created_at\n        timestamp updated_at\n        timestamp last_login_at\n        jsonb preferences\n    }\n\n    BOOK {\n        uuid book_id PK\n        uuid user_id FK\n        varchar title\n        varchar subtitle\n        varchar author\n        jsonb co_authors\n        varchar isbn\n        varchar isbn13\n        date publication_date\n        varchar publisher\n        varchar language\n        integer page_count\n        text description\n        varchar cover_image_url\n        uuid series_id FK\n        decimal series_number\n        varchar file_path\n        varchar file_format\n        bigint file_size\n        varchar file_hash\n        uuid storage_backend_id FK\n        boolean is_physical\n        varchar physical_location\n        varchar lent_to\n        timestamp lent_at\n        boolean is_favorite\n        smallint rating\n        varchar reading_status\n        integer current_page\n        decimal current_position\n        varchar current_cfi\n        timestamp started_at\n        timestamp completed_at\n        timestamp added_at\n        timestamp last_read_at\n        jsonb custom_metadata\n        boolean is_ocr_processed\n        decimal ocr_confidence\n    }\n\n    SHELF {\n        uuid shelf_id PK\n        uuid user_id FK\n        uuid parent_shelf_id FK\n        varchar name\n        text description\n        varchar color\n        varchar icon\n        boolean is_default\n        boolean is_smart\n        varchar smart_query\n        integer sort_order\n        timestamp created_at\n        timestamp updated_at\n    }\n\n    TAG {\n        uuid tag_id PK\n        uuid user_id FK\n        varchar name\n        varchar color\n        text description\n        integer usage_count\n        timestamp created_at\n    }\n\n    SERIES {\n        uuid series_id PK\n        uuid user_id FK\n        varchar name\n        text description\n        varchar author\n        integer total_books\n        boolean is_complete\n        timestamp created_at\n        timestamp updated_at\n    }\n\n    ANNOTATION {\n        uuid annotation_id PK\n        uuid book_id FK\n        uuid user_id FK\n        text selected_text\n        text note\n        varchar highlight_color\n        varchar start_position\n        varchar end_position\n        varchar chapter_title\n        integer chapter_index\n        integer page_number\n        timestamp created_at\n        timestamp updated_at\n    }\n\n    NOTE {\n        uuid note_id PK\n        uuid book_id FK\n        uuid user_id FK\n        varchar title\n        text content\n        boolean is_pinned\n        timestamp created_at\n        timestamp updated_at\n    }\n\n    BOOKMARK {\n        uuid bookmark_id PK\n        uuid book_id FK\n        uuid user_id FK\n        varchar position\n        integer page_number\n        varchar chapter_title\n        varchar note\n        varchar color\n        timestamp created_at\n    }\n\n    READING_SESSION {\n        uuid session_id PK\n        uuid book_id FK\n        uuid user_id FK\n        timestamp start_time\n        timestamp end_time\n        decimal start_position\n        decimal end_position\n        integer pages_read\n        integer duration_minutes\n        varchar device_type\n        varchar device_name\n        timestamp created_at\n    }\n\n    READING_GOAL {\n        uuid goal_id PK\n        uuid user_id FK\n        varchar title\n        text description\n        varchar goal_type\n        integer target_value\n        integer current_value\n        varchar time_period\n        date start_date\n        date end_date\n        boolean is_active\n        boolean is_completed\n        timestamp completed_at\n        timestamp created_at\n        timestamp updated_at\n    }\n\n    READING_PROFILE {\n        uuid profile_id PK\n        uuid user_id FK\n        varchar name\n        boolean is_default\n        varchar font_family\n        smallint font_size\n        smallint font_weight\n        decimal line_height\n        decimal letter_spacing\n        decimal paragraph_spacing\n        varchar text_align\n        smallint margin_horizontal\n        smallint margin_vertical\n        varchar background_color\n        varchar text_color\n        varchar link_color\n        varchar selection_color\n        varchar theme_mode\n        varchar reading_mode\n        boolean page_turn_animation\n        smallint column_count\n        boolean hyphenation\n        timestamp created_at\n        timestamp updated_at\n    }\n\n    METADATA_SERVER_CONFIG {\n        uuid config_id PK\n        uuid user_id FK \"unique\"\n        varchar server_url\n        varchar server_type\n        text auth_token\n        text refresh_token\n        boolean is_connected\n        boolean sync_enabled\n        integer sync_interval_seconds\n        timestamp last_sync_at\n        varchar sync_status\n        varchar sync_error_message\n        timestamp created_at\n        timestamp updated_at\n    }\n\n    FILE_STORAGE_BACKEND {\n        uuid backend_id PK\n        uuid user_id FK\n        varchar backend_type\n        varchar name\n        boolean is_primary\n        boolean is_active\n        text connection_config\n        text credentials\n        varchar base_path\n        bigint storage_used_bytes\n        bigint storage_quota_bytes\n        timestamp last_accessed_at\n        varchar connection_status\n        varchar error_message\n        timestamp created_at\n        timestamp updated_at\n    }\n\n    SAVED_FILTER {\n        uuid filter_id PK\n        uuid user_id FK\n        varchar name\n        text description\n        varchar query\n        varchar filter_type\n        varchar icon\n        varchar color\n        boolean is_pinned\n        integer usage_count\n        timestamp last_used_at\n        timestamp created_at\n        timestamp updated_at\n    }\n\n    BOOK_SHELF {\n        uuid book_id FK\n        uuid shelf_id FK\n        timestamp added_at\n        integer sort_order\n    }\n\n    BOOK_TAG {\n        uuid book_id FK\n        uuid tag_id FK\n        timestamp created_at\n    }\n\n    USER ||--o{ BOOK : owns\n    USER ||--o{ SHELF : creates\n    USER ||--o{ TAG : creates\n    USER ||--o{ SERIES : creates\n    USER ||--o{ ANNOTATION : makes\n    USER ||--o{ NOTE : writes\n    USER ||--o{ BOOKMARK : creates\n    USER ||--o{ READING_SESSION : has\n    USER ||--o{ READING_GOAL : sets\n    USER ||--o{ READING_PROFILE : configures\n    USER ||--o| METADATA_SERVER_CONFIG : connects_to\n    USER ||--o{ FILE_STORAGE_BACKEND : configures\n    USER ||--o{ SAVED_FILTER : saves\n\n    BOOK }o--o| FILE_STORAGE_BACKEND : stored_in\n    BOOK ||--o{ ANNOTATION : contains\n    BOOK ||--o{ NOTE : has\n    BOOK ||--o{ BOOKMARK : has\n    BOOK ||--o{ READING_SESSION : tracked_in\n\n    BOOK }o--o| SERIES : belongs_to\n    SHELF }o--o| SHELF : parent_of\n\n    BOOK }o--o{ SHELF : organized_in\n    BOOK }o--o{ TAG : tagged_with\n\n    BOOK_SHELF }o--|| BOOK : references\n    BOOK_SHELF }o--|| SHELF : references\n    BOOK_TAG }o--|| BOOK : references\n    BOOK_TAG }o--|| TAG : references</code></pre>"},{"location":"database-model/#table-definitions","title":"Table Definitions","text":""},{"location":"database-model/#user","title":"USER","text":"<pre><code>CREATE TABLE \"user\" (\n    user_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    email VARCHAR(255) UNIQUE,\n    password_hash VARCHAR(255),\n    display_name VARCHAR(100) NOT NULL,\n    avatar_url VARCHAR(500),\n    google_id VARCHAR(100) UNIQUE,\n    is_anonymous BOOLEAN NOT NULL DEFAULT FALSE,\n    is_active BOOLEAN NOT NULL DEFAULT TRUE,\n    email_verified BOOLEAN NOT NULL DEFAULT FALSE,\n    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n    updated_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n    last_login_at TIMESTAMPTZ,\n    preferences JSONB NOT NULL DEFAULT '{}'::jsonb,\n\n    CONSTRAINT email_or_anonymous CHECK (\n        (email IS NOT NULL AND is_anonymous = FALSE) OR\n        (email IS NULL AND is_anonymous = TRUE)\n    )\n);\n\nCREATE INDEX idx_user_email ON \"user\"(email);\nCREATE INDEX idx_user_google_id ON \"user\"(google_id);\n</code></pre>"},{"location":"database-model/#book","title":"BOOK","text":"<pre><code>CREATE TABLE book (\n    book_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    user_id UUID NOT NULL REFERENCES \"user\"(user_id) ON DELETE CASCADE,\n    title VARCHAR(500) NOT NULL,\n    subtitle VARCHAR(500),\n    author VARCHAR(255) NOT NULL,\n    co_authors JSONB NOT NULL DEFAULT '[]'::jsonb,\n    isbn VARCHAR(13),\n    isbn13 VARCHAR(17),\n    publication_date DATE,\n    publisher VARCHAR(255),\n    language VARCHAR(10) NOT NULL DEFAULT 'en',\n    page_count INTEGER,\n    description TEXT,\n    cover_image_url VARCHAR(1000),\n    series_id UUID REFERENCES series(series_id) ON DELETE SET NULL,\n    series_number DECIMAL(5,2),\n    file_path VARCHAR(1000),\n    file_format VARCHAR(20),\n    file_size BIGINT,\n    file_hash VARCHAR(64), -- SHA-256 hash\n    storage_backend_id UUID REFERENCES file_storage_backend(backend_id) ON DELETE SET NULL,\n    is_physical BOOLEAN NOT NULL DEFAULT FALSE,\n    physical_location VARCHAR(255),\n    lent_to VARCHAR(255),\n    lent_at TIMESTAMPTZ,\n    is_favorite BOOLEAN NOT NULL DEFAULT FALSE,\n    rating SMALLINT CHECK (rating &gt;= 1 AND rating &lt;= 5),\n    reading_status VARCHAR(20) NOT NULL DEFAULT 'not_started'\n        CHECK (reading_status IN ('not_started', 'in_progress', 'completed', 'paused', 'abandoned')),\n    current_page INTEGER,\n    current_position DECIMAL(5,4) CHECK (current_position &gt;= 0 AND current_position &lt;= 1),\n    current_cfi VARCHAR(500),\n    started_at TIMESTAMPTZ,\n    completed_at TIMESTAMPTZ,\n    added_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n    last_read_at TIMESTAMPTZ,\n    custom_metadata JSONB NOT NULL DEFAULT '{}'::jsonb,\n    is_ocr_processed BOOLEAN NOT NULL DEFAULT FALSE,\n    ocr_confidence DECIMAL(3,2) CHECK (ocr_confidence &gt;= 0 AND ocr_confidence &lt;= 1)\n);\n\nCREATE INDEX idx_book_user_id ON book(user_id);\nCREATE INDEX idx_book_title ON book(title);\nCREATE INDEX idx_book_author ON book(author);\nCREATE INDEX idx_book_reading_status ON book(reading_status);\nCREATE INDEX idx_book_series_id ON book(series_id);\nCREATE INDEX idx_book_storage_backend ON book(storage_backend_id);\nCREATE INDEX idx_book_added_at ON book(added_at DESC);\nCREATE INDEX idx_book_last_read_at ON book(last_read_at DESC NULLS LAST);\n</code></pre>"},{"location":"database-model/#shelf","title":"SHELF","text":"<pre><code>CREATE TABLE shelf (\n    shelf_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    user_id UUID NOT NULL REFERENCES \"user\"(user_id) ON DELETE CASCADE,\n    parent_shelf_id UUID REFERENCES shelf(shelf_id) ON DELETE CASCADE,\n    name VARCHAR(100) NOT NULL,\n    description TEXT,\n    color VARCHAR(7),\n    icon VARCHAR(50),\n    is_default BOOLEAN NOT NULL DEFAULT FALSE,\n    is_smart BOOLEAN NOT NULL DEFAULT FALSE,\n    smart_query VARCHAR(500),\n    sort_order INTEGER NOT NULL DEFAULT 0,\n    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n    updated_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n\n    CONSTRAINT unique_shelf_name_per_parent UNIQUE (user_id, parent_shelf_id, name)\n);\n\nCREATE INDEX idx_shelf_user_id ON shelf(user_id);\nCREATE INDEX idx_shelf_parent_id ON shelf(parent_shelf_id);\n</code></pre>"},{"location":"database-model/#tag","title":"TAG","text":"<pre><code>CREATE TABLE tag (\n    tag_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    user_id UUID NOT NULL REFERENCES \"user\"(user_id) ON DELETE CASCADE,\n    name VARCHAR(50) NOT NULL,\n    color VARCHAR(7) NOT NULL,\n    description TEXT,\n    usage_count INTEGER NOT NULL DEFAULT 0,\n    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n\n    CONSTRAINT unique_tag_name_per_user UNIQUE (user_id, name)\n);\n\nCREATE INDEX idx_tag_user_id ON tag(user_id);\nCREATE INDEX idx_tag_name ON tag(name);\n</code></pre>"},{"location":"database-model/#series","title":"SERIES","text":"<pre><code>CREATE TABLE series (\n    series_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    user_id UUID NOT NULL REFERENCES \"user\"(user_id) ON DELETE CASCADE,\n    name VARCHAR(255) NOT NULL,\n    description TEXT,\n    author VARCHAR(255),\n    total_books INTEGER,\n    is_complete BOOLEAN NOT NULL DEFAULT FALSE,\n    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n    updated_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n\n    CONSTRAINT unique_series_name_per_user UNIQUE (user_id, name)\n);\n\nCREATE INDEX idx_series_user_id ON series(user_id);\n</code></pre>"},{"location":"database-model/#annotation","title":"ANNOTATION","text":"<pre><code>CREATE TABLE annotation (\n    annotation_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    book_id UUID NOT NULL REFERENCES book(book_id) ON DELETE CASCADE,\n    user_id UUID NOT NULL REFERENCES \"user\"(user_id) ON DELETE CASCADE,\n    selected_text TEXT NOT NULL,\n    note TEXT,\n    highlight_color VARCHAR(7) NOT NULL,\n    start_position VARCHAR(200) NOT NULL,\n    end_position VARCHAR(200) NOT NULL,\n    chapter_title VARCHAR(255),\n    chapter_index INTEGER,\n    page_number INTEGER,\n    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n    updated_at TIMESTAMPTZ NOT NULL DEFAULT NOW()\n);\n\nCREATE INDEX idx_annotation_book_id ON annotation(book_id);\nCREATE INDEX idx_annotation_user_id ON annotation(user_id);\nCREATE INDEX idx_annotation_created_at ON annotation(created_at DESC);\n</code></pre>"},{"location":"database-model/#note","title":"NOTE","text":"<pre><code>CREATE TABLE note (\n    note_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    book_id UUID NOT NULL REFERENCES book(book_id) ON DELETE CASCADE,\n    user_id UUID NOT NULL REFERENCES \"user\"(user_id) ON DELETE CASCADE,\n    title VARCHAR(255) NOT NULL,\n    content TEXT NOT NULL,\n    is_pinned BOOLEAN NOT NULL DEFAULT FALSE,\n    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n    updated_at TIMESTAMPTZ NOT NULL DEFAULT NOW()\n);\n\nCREATE INDEX idx_note_book_id ON note(book_id);\nCREATE INDEX idx_note_user_id ON note(user_id);\n</code></pre>"},{"location":"database-model/#bookmark","title":"BOOKMARK","text":"<pre><code>CREATE TABLE bookmark (\n    bookmark_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    book_id UUID NOT NULL REFERENCES book(book_id) ON DELETE CASCADE,\n    user_id UUID NOT NULL REFERENCES \"user\"(user_id) ON DELETE CASCADE,\n    position VARCHAR(200) NOT NULL,\n    page_number INTEGER,\n    chapter_title VARCHAR(255),\n    note VARCHAR(500),\n    color VARCHAR(7) NOT NULL DEFAULT '#FF5722',\n    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW()\n);\n\nCREATE INDEX idx_bookmark_book_id ON bookmark(book_id);\nCREATE INDEX idx_bookmark_user_id ON bookmark(user_id);\n</code></pre>"},{"location":"database-model/#reading_session","title":"READING_SESSION","text":"<pre><code>CREATE TABLE reading_session (\n    session_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    book_id UUID NOT NULL REFERENCES book(book_id) ON DELETE CASCADE,\n    user_id UUID NOT NULL REFERENCES \"user\"(user_id) ON DELETE CASCADE,\n    start_time TIMESTAMPTZ NOT NULL,\n    end_time TIMESTAMPTZ,\n    start_position DECIMAL(5,4),\n    end_position DECIMAL(5,4),\n    pages_read INTEGER,\n    duration_minutes INTEGER GENERATED ALWAYS AS (\n        CASE WHEN end_time IS NOT NULL\n        THEN EXTRACT(EPOCH FROM (end_time - start_time)) / 60\n        ELSE NULL END\n    ) STORED,\n    device_type VARCHAR(50),\n    device_name VARCHAR(100),\n    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW()\n);\n\nCREATE INDEX idx_reading_session_book_id ON reading_session(book_id);\nCREATE INDEX idx_reading_session_user_id ON reading_session(user_id);\nCREATE INDEX idx_reading_session_start_time ON reading_session(start_time DESC);\n</code></pre>"},{"location":"database-model/#reading_goal","title":"READING_GOAL","text":"<pre><code>CREATE TABLE reading_goal (\n    goal_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    user_id UUID NOT NULL REFERENCES \"user\"(user_id) ON DELETE CASCADE,\n    title VARCHAR(255) NOT NULL,\n    description TEXT,\n    goal_type VARCHAR(20) NOT NULL\n        CHECK (goal_type IN ('books_count', 'pages_count', 'reading_time')),\n    target_value INTEGER NOT NULL CHECK (target_value &gt; 0),\n    current_value INTEGER NOT NULL DEFAULT 0,\n    time_period VARCHAR(20) NOT NULL\n        CHECK (time_period IN ('daily', 'weekly', 'monthly', 'yearly', 'custom')),\n    start_date DATE NOT NULL,\n    end_date DATE NOT NULL,\n    is_active BOOLEAN NOT NULL DEFAULT TRUE,\n    is_completed BOOLEAN NOT NULL DEFAULT FALSE,\n    completed_at TIMESTAMPTZ,\n    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n    updated_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n\n    CONSTRAINT valid_date_range CHECK (end_date &gt; start_date)\n);\n\nCREATE INDEX idx_reading_goal_user_id ON reading_goal(user_id);\nCREATE INDEX idx_reading_goal_is_active ON reading_goal(is_active);\n</code></pre>"},{"location":"database-model/#reading_profile","title":"READING_PROFILE","text":"<pre><code>CREATE TABLE reading_profile (\n    profile_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    user_id UUID NOT NULL REFERENCES \"user\"(user_id) ON DELETE CASCADE,\n    name VARCHAR(100) NOT NULL,\n    is_default BOOLEAN NOT NULL DEFAULT FALSE,\n    font_family VARCHAR(100) NOT NULL DEFAULT 'Georgia',\n    font_size SMALLINT NOT NULL DEFAULT 16 CHECK (font_size &gt;= 8 AND font_size &lt;= 72),\n    font_weight SMALLINT NOT NULL DEFAULT 400,\n    line_height DECIMAL(3,2) NOT NULL DEFAULT 1.5,\n    letter_spacing DECIMAL(3,2) NOT NULL DEFAULT 0,\n    paragraph_spacing DECIMAL(3,2) NOT NULL DEFAULT 1.0,\n    text_align VARCHAR(10) NOT NULL DEFAULT 'left'\n        CHECK (text_align IN ('left', 'right', 'center', 'justify')),\n    margin_horizontal SMALLINT NOT NULL DEFAULT 20,\n    margin_vertical SMALLINT NOT NULL DEFAULT 20,\n    background_color VARCHAR(7) NOT NULL DEFAULT '#FFFFFF',\n    text_color VARCHAR(7) NOT NULL DEFAULT '#000000',\n    link_color VARCHAR(7) NOT NULL DEFAULT '#0066CC',\n    selection_color VARCHAR(7) NOT NULL DEFAULT '#B3D4FC',\n    theme_mode VARCHAR(10) NOT NULL DEFAULT 'light'\n        CHECK (theme_mode IN ('light', 'dark', 'sepia', 'custom')),\n    reading_mode VARCHAR(15) NOT NULL DEFAULT 'paginated'\n        CHECK (reading_mode IN ('paginated', 'continuous')),\n    page_turn_animation BOOLEAN NOT NULL DEFAULT TRUE,\n    column_count SMALLINT NOT NULL DEFAULT 1 CHECK (column_count &gt;= 1 AND column_count &lt;= 3),\n    hyphenation BOOLEAN NOT NULL DEFAULT TRUE,\n    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n    updated_at TIMESTAMPTZ NOT NULL DEFAULT NOW()\n);\n\nCREATE INDEX idx_reading_profile_user_id ON reading_profile(user_id);\n</code></pre>"},{"location":"database-model/#metadata_server_config","title":"METADATA_SERVER_CONFIG","text":"<p>Stores the user's connection to a metadata server for cross-device synchronization. Each user has at most one configuration.</p> <pre><code>CREATE TABLE metadata_server_config (\n    config_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    user_id UUID NOT NULL UNIQUE REFERENCES \"user\"(user_id) ON DELETE CASCADE,\n    server_url VARCHAR(500) NOT NULL,\n    server_type VARCHAR(20) NOT NULL DEFAULT 'official'\n        CHECK (server_type IN ('official', 'self_hosted')),\n    auth_token TEXT, -- Encrypted JWT\n    refresh_token TEXT, -- Encrypted\n    is_connected BOOLEAN NOT NULL DEFAULT FALSE,\n    sync_enabled BOOLEAN NOT NULL DEFAULT TRUE,\n    sync_interval_seconds INTEGER NOT NULL DEFAULT 30,\n    last_sync_at TIMESTAMPTZ,\n    sync_status VARCHAR(20) NOT NULL DEFAULT 'idle'\n        CHECK (sync_status IN ('idle', 'syncing', 'error')),\n    sync_error_message TEXT,\n    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n    updated_at TIMESTAMPTZ NOT NULL DEFAULT NOW()\n);\n\n-- Unique constraint ensures one config per user\nCREATE UNIQUE INDEX idx_metadata_server_config_user ON metadata_server_config(user_id);\n</code></pre>"},{"location":"database-model/#file_storage_backend","title":"FILE_STORAGE_BACKEND","text":"<p>Stores configurations for file storage backends. Users can have multiple backends configured.</p> <pre><code>CREATE TABLE file_storage_backend (\n    backend_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    user_id UUID NOT NULL REFERENCES \"user\"(user_id) ON DELETE CASCADE,\n    backend_type VARCHAR(20) NOT NULL\n        CHECK (backend_type IN ('local', 'google_drive', 'onedrive', 'dropbox', 'webdav', 'minio', 's3', 'papyrus_server')),\n    name VARCHAR(100) NOT NULL,\n    is_primary BOOLEAN NOT NULL DEFAULT FALSE,\n    is_active BOOLEAN NOT NULL DEFAULT TRUE,\n    connection_config TEXT, -- Encrypted JSON (type-specific settings)\n    credentials TEXT, -- Encrypted JSON (OAuth tokens or API keys)\n    base_path VARCHAR(500),\n    storage_used_bytes BIGINT,\n    storage_quota_bytes BIGINT,\n    last_accessed_at TIMESTAMPTZ,\n    connection_status VARCHAR(20) NOT NULL DEFAULT 'disconnected'\n        CHECK (connection_status IN ('connected', 'disconnected', 'error')),\n    error_message TEXT,\n    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n    updated_at TIMESTAMPTZ NOT NULL DEFAULT NOW()\n);\n\nCREATE INDEX idx_file_storage_backend_user_id ON file_storage_backend(user_id);\n\n-- Ensure only one primary backend per user\nCREATE UNIQUE INDEX idx_file_storage_backend_primary\n    ON file_storage_backend(user_id)\n    WHERE is_primary = TRUE;\n</code></pre>"},{"location":"database-model/#saved_filter","title":"SAVED_FILTER","text":"<pre><code>CREATE TABLE saved_filter (\n    filter_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    user_id UUID NOT NULL REFERENCES \"user\"(user_id) ON DELETE CASCADE,\n    name VARCHAR(100) NOT NULL,\n    description TEXT,\n    query VARCHAR(1000) NOT NULL,\n    filter_type VARCHAR(20) NOT NULL DEFAULT 'custom'\n        CHECK (filter_type IN ('search', 'shelf', 'custom')),\n    icon VARCHAR(50),\n    color VARCHAR(7),\n    is_pinned BOOLEAN NOT NULL DEFAULT FALSE,\n    usage_count INTEGER NOT NULL DEFAULT 0,\n    last_used_at TIMESTAMPTZ,\n    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n    updated_at TIMESTAMPTZ NOT NULL DEFAULT NOW()\n);\n\nCREATE INDEX idx_saved_filter_user_id ON saved_filter(user_id);\n</code></pre>"},{"location":"database-model/#junction-tables","title":"Junction Tables","text":"<pre><code>CREATE TABLE book_shelf (\n    book_id UUID NOT NULL REFERENCES book(book_id) ON DELETE CASCADE,\n    shelf_id UUID NOT NULL REFERENCES shelf(shelf_id) ON DELETE CASCADE,\n    added_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n    sort_order INTEGER NOT NULL DEFAULT 0,\n    PRIMARY KEY (book_id, shelf_id)\n);\n\nCREATE INDEX idx_book_shelf_shelf_id ON book_shelf(shelf_id);\n\nCREATE TABLE book_tag (\n    book_id UUID NOT NULL REFERENCES book(book_id) ON DELETE CASCADE,\n    tag_id UUID NOT NULL REFERENCES tag(tag_id) ON DELETE CASCADE,\n    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n    PRIMARY KEY (book_id, tag_id)\n);\n\nCREATE INDEX idx_book_tag_tag_id ON book_tag(tag_id);\n</code></pre>"},{"location":"database-model/#design-principles","title":"Design Principles","text":""},{"location":"database-model/#data-integrity","title":"Data Integrity","text":"<ul> <li>Foreign key constraints ensure referential integrity</li> <li>Check constraints validate data ranges and enums</li> <li>Unique constraints prevent duplicate entries</li> <li>NOT NULL constraints ensure required fields</li> </ul>"},{"location":"database-model/#performance-optimization","title":"Performance Optimization","text":"<ul> <li>UUID primary keys for distributed systems</li> <li>Indexes on frequently queried columns</li> <li>JSONB for flexible metadata storage</li> <li>Partial indexes for filtered queries</li> <li>Generated columns for computed values</li> </ul>"},{"location":"database-model/#scalability","title":"Scalability","text":"<ul> <li>Cascade deletes for clean data removal</li> <li>Nullable foreign keys for optional relationships</li> <li>Timestamp fields for audit trails</li> <li>Soft deletes via is_active flags where appropriate</li> </ul>"},{"location":"database-model/#security","title":"Security","text":"<ul> <li>Encrypted columns for credentials</li> <li>Hashed passwords (stored externally via auth)</li> <li>No sensitive data in plain text</li> <li>User isolation via user_id foreign keys</li> </ul>"},{"location":"database-model/#migration-notes","title":"Migration Notes","text":""},{"location":"database-model/#initial-setup","title":"Initial Setup","text":"<ol> <li>Create tables in dependency order (USER first)</li> <li>Create indexes after data population for speed</li> <li>Insert default shelves per user on registration</li> </ol>"},{"location":"database-model/#version-history","title":"Version History","text":"Version Changes 1.0.0 Initial schema 1.1.0 Added SERIES, BOOKMARK, SAVED_FILTER tables 1.2.0 Added parent_shelf_id for nested shelves"},{"location":"entities/","title":"Entities","text":"<p>This section defines the data model entities for Papyrus. These entities form the foundation for the database schema and represent the core data structures managed by the application.</p>"},{"location":"entities/#entity-overview","title":"Entity Overview","text":"Entity Description Related Requirements User System user account FR-1.x Book Physical or digital book FR-2.x, FR-3.x Shelf User-defined book collection FR-2.9 Tag Color-coded book label FR-2.10 Series Book series grouping FR-2.2 Annotation Text highlight with note FR-4.1 Note Free-form book note FR-4.2 Bookmark Saved position in book FR-3.4 ReadingSession Reading activity record FR-5.1 ReadingGoal Reading objective FR-6.x ReadingProfile Viewer customization preset FR-3.3 MetadataServerConfig Sync server connection FR-7.1.1 FileStorageBackend File storage backend settings FR-7.1 SavedFilter Saved search/filter query FR-2.11"},{"location":"entities/#entity-relationship-diagram","title":"Entity Relationship Diagram","text":"<pre><code>erDiagram\n    USER ||--o{ BOOK : owns\n    USER ||--o{ SHELF : creates\n    USER ||--o{ TAG : creates\n    USER ||--o{ SERIES : creates\n    USER ||--o{ ANNOTATION : makes\n    USER ||--o{ NOTE : writes\n    USER ||--o{ BOOKMARK : creates\n    USER ||--o{ READING_SESSION : has\n    USER ||--o{ READING_GOAL : sets\n    USER ||--o{ READING_PROFILE : configures\n    USER ||--o| METADATA_SERVER_CONFIG : connects_to\n    USER ||--o{ FILE_STORAGE_BACKEND : configures\n    USER ||--o{ SAVED_FILTER : saves\n\n    BOOK }o--o| FILE_STORAGE_BACKEND : stored_in\n\n    BOOK ||--o{ ANNOTATION : contains\n    BOOK ||--o{ NOTE : has\n    BOOK ||--o{ BOOKMARK : has\n    BOOK ||--o{ READING_SESSION : tracked_in\n    BOOK }o--o| SERIES : belongs_to\n\n    BOOK }o--o{ SHELF : organized_in\n    BOOK }o--o{ TAG : tagged_with\n\n    SHELF }o--o| SHELF : parent_of\n\n    USER {\n        uuid user_id PK\n        string email UK\n        string display_name\n        boolean is_anonymous\n    }\n\n    BOOK {\n        uuid book_id PK\n        uuid user_id FK\n        string title\n        string author\n        boolean is_physical\n        string reading_status\n    }\n\n    SHELF {\n        uuid shelf_id PK\n        uuid user_id FK\n        uuid parent_shelf_id FK\n        string name\n    }\n\n    TAG {\n        uuid tag_id PK\n        uuid user_id FK\n        string name\n        string color\n    }\n\n    SERIES {\n        uuid series_id PK\n        uuid user_id FK\n        string name\n    }\n\n    ANNOTATION {\n        uuid annotation_id PK\n        uuid book_id FK\n        string selected_text\n        string highlight_color\n    }\n\n    NOTE {\n        uuid note_id PK\n        uuid book_id FK\n        string title\n        text content\n    }\n\n    BOOKMARK {\n        uuid bookmark_id PK\n        uuid book_id FK\n        string position\n        string note\n    }\n\n    READING_SESSION {\n        uuid session_id PK\n        uuid book_id FK\n        timestamp start_time\n        integer duration_minutes\n    }\n\n    READING_GOAL {\n        uuid goal_id PK\n        uuid user_id FK\n        string goal_type\n        integer target_value\n    }\n\n    READING_PROFILE {\n        uuid profile_id PK\n        uuid user_id FK\n        string name\n        json settings\n    }\n\n    STORAGE_CONFIG {\n        uuid config_id PK\n        uuid user_id FK\n        string storage_type\n        boolean is_primary\n    }\n\n    SAVED_FILTER {\n        uuid filter_id PK\n        uuid user_id FK\n        string name\n        string query\n    }</code></pre>"},{"location":"entities/#core-entities","title":"Core Entities","text":""},{"location":"entities/#user","title":"User","text":"<p>Represents a person who uses the system.</p> <p>Attributes:</p> Attribute Type Constraints Description user_id UUID PK Unique identifier email String Unique, nullable User's email (null for anonymous) password_hash String Nullable Encrypted password (null for OAuth) display_name String Required User's preferred name avatar_url String Nullable Profile image URL google_id String Unique, nullable Google OAuth identifier is_anonymous Boolean Default: false Anonymous user flag is_active Boolean Default: true Account status email_verified Boolean Default: false Email verification status created_at Timestamp Auto Account creation time updated_at Timestamp Auto Last update time last_login_at Timestamp Nullable Last login time preferences JSON Default: {} User preferences <p>Relationships:</p> <ul> <li>One-to-many with Book, Shelf, Tag, Series</li> <li>One-to-many with Annotation, Note, Bookmark</li> <li>One-to-many with ReadingSession, ReadingGoal</li> <li>One-to-many with ReadingProfile, FileStorageBackend, SavedFilter</li> <li>One-to-one with MetadataServerConfig (optional)</li> </ul>"},{"location":"entities/#book","title":"Book","text":"<p>Represents a physical or digital book in the user's library.</p> <p>Attributes:</p> Attribute Type Constraints Description book_id UUID PK Unique identifier user_id UUID FK \u2192 User Book owner title String Required Book title subtitle String Nullable Book subtitle author String Required Primary author co_authors JSON Default: [] Additional authors isbn String Nullable ISBN-10 isbn13 String Nullable ISBN-13 publication_date Date Nullable Publication date publisher String Nullable Publisher name language String Default: 'en' Language code (ISO 639-1) page_count Integer Nullable Total pages description Text Nullable Book summary cover_image_url String Nullable Cover image path/URL series_id UUID FK \u2192 Series, nullable Series reference series_number Decimal Nullable Position in series file_path String Nullable Digital file path (relative to storage) file_format String Nullable File format (EPUB, PDF, etc.) file_size BigInt Nullable File size in bytes file_hash String Nullable File checksum (SHA-256) storage_backend_id UUID FK \u2192 FileStorageBackend, nullable Storage location is_physical Boolean Default: false Physical book flag physical_location String Nullable Physical storage location lent_to String Nullable Borrower info lent_at Timestamp Nullable Lending date is_favorite Boolean Default: false Favorite flag rating Integer Range: 1-5, nullable User rating reading_status Enum not_started, in_progress, completed, paused, abandoned Current status current_page Integer Nullable Current page (physical) current_position Decimal Range: 0-1, nullable Reading position (digital) current_cfi String Nullable EPUB CFI position started_at Timestamp Nullable Reading start date completed_at Timestamp Nullable Completion date added_at Timestamp Auto Date added to library last_read_at Timestamp Nullable Last reading session custom_metadata JSON Default: {} User-defined fields is_ocr_processed Boolean Default: false OCR status ocr_confidence Decimal Range: 0-1, nullable OCR quality score <p>Relationships:</p> <ul> <li>Many-to-one with User (owner)</li> <li>Many-to-one with Series (optional)</li> <li>Many-to-one with FileStorageBackend (optional, for digital books)</li> <li>Many-to-many with Shelf</li> <li>Many-to-many with Tag</li> <li>One-to-many with Annotation, Note, Bookmark, ReadingSession</li> </ul> <p>Indexes:</p> <ul> <li>user_id (for library queries)</li> <li>title, author (for search)</li> <li>reading_status (for filtering)</li> <li>series_id (for series grouping)</li> <li>storage_backend_id (for storage queries)</li> </ul>"},{"location":"entities/#shelf","title":"Shelf","text":"<p>Represents a user-created collection for organizing books.</p> <p>Attributes:</p> Attribute Type Constraints Description shelf_id UUID PK Unique identifier user_id UUID FK \u2192 User Shelf owner parent_shelf_id UUID FK \u2192 Shelf, nullable Parent for nesting name String Required Shelf name description Text Nullable Shelf description color String Nullable Display color (hex) icon String Nullable Display icon name is_default Boolean Default: false System default shelf is_smart Boolean Default: false Dynamic/smart shelf smart_query String Nullable Query for smart shelves sort_order Integer Default: 0 Display order created_at Timestamp Auto Creation time updated_at Timestamp Auto Last update time <p>Relationships:</p> <ul> <li>Many-to-one with User (owner)</li> <li>Many-to-one with Shelf (parent, for nesting)</li> <li>One-to-many with Shelf (children)</li> <li>Many-to-many with Book</li> </ul> <p>Default Shelves:</p> <ul> <li>\"Currently Reading\" (is_default: true)</li> <li>\"Want to Read\" (is_default: true)</li> <li>\"Finished\" (is_default: true)</li> </ul>"},{"location":"entities/#tag","title":"Tag","text":"<p>Represents a color-coded label for categorizing books.</p> <p>Attributes:</p> Attribute Type Constraints Description tag_id UUID PK Unique identifier user_id UUID FK \u2192 User Tag owner name String Required Tag name color String Required Tag color (hex) description Text Nullable Tag description usage_count Integer Default: 0 Number of books with tag created_at Timestamp Auto Creation time <p>Relationships:</p> <ul> <li>Many-to-one with User (owner)</li> <li>Many-to-many with Book</li> </ul> <p>Constraints:</p> <ul> <li>Maximum 10 tags per book</li> <li>Tag name unique per user</li> </ul>"},{"location":"entities/#series","title":"Series","text":"<p>Represents a book series (e.g., \"Harry Potter\", \"Lord of the Rings\").</p> <p>Attributes:</p> Attribute Type Constraints Description series_id UUID PK Unique identifier user_id UUID FK \u2192 User Series owner name String Required Series name description Text Nullable Series description author String Nullable Primary series author total_books Integer Nullable Expected total books is_complete Boolean Default: false Series completion flag created_at Timestamp Auto Creation time updated_at Timestamp Auto Last update time <p>Relationships:</p> <ul> <li>Many-to-one with User (owner)</li> <li>One-to-many with Book</li> </ul>"},{"location":"entities/#annotation","title":"Annotation","text":"<p>Represents a text highlight with optional note in a digital book.</p> <p>Attributes:</p> Attribute Type Constraints Description annotation_id UUID PK Unique identifier book_id UUID FK \u2192 Book Associated book user_id UUID FK \u2192 User Annotation creator selected_text Text Required Highlighted text note Text Nullable User's note highlight_color String Required Highlight color (hex) start_position String Required Selection start (CFI/offset) end_position String Required Selection end chapter_title String Nullable Chapter name chapter_index Integer Nullable Chapter number page_number Integer Nullable Page (for PDF) created_at Timestamp Auto Creation time updated_at Timestamp Auto Last update time <p>Relationships:</p> <ul> <li>Many-to-one with Book</li> <li>Many-to-one with User</li> </ul> <p>Highlight Colors (defaults):</p> <ul> <li>Yellow (#FFEB3B)</li> <li>Green (#4CAF50)</li> <li>Blue (#2196F3)</li> <li>Pink (#E91E63)</li> <li>Orange (#FF9800)</li> </ul>"},{"location":"entities/#note","title":"Note","text":"<p>Represents a free-form note associated with a book.</p> <p>Attributes:</p> Attribute Type Constraints Description note_id UUID PK Unique identifier book_id UUID FK \u2192 Book Associated book user_id UUID FK \u2192 User Note creator title String Required Note title content Text Required Note content (Markdown) is_pinned Boolean Default: false Pinned note flag created_at Timestamp Auto Creation time updated_at Timestamp Auto Last update time <p>Relationships:</p> <ul> <li>Many-to-one with Book</li> <li>Many-to-one with User</li> </ul>"},{"location":"entities/#bookmark","title":"Bookmark","text":"<p>Represents a saved position within a book for quick navigation.</p> <p>Attributes:</p> Attribute Type Constraints Description bookmark_id UUID PK Unique identifier book_id UUID FK \u2192 Book Associated book user_id UUID FK \u2192 User Bookmark creator position String Required Position (CFI/page/offset) page_number Integer Nullable Page number (for display) chapter_title String Nullable Chapter name note String Nullable Optional note color String Default: '#FF5722' Bookmark color created_at Timestamp Auto Creation time <p>Relationships:</p> <ul> <li>Many-to-one with Book</li> <li>Many-to-one with User</li> </ul>"},{"location":"entities/#readingsession","title":"ReadingSession","text":"<p>Represents a period of reading activity.</p> <p>Attributes:</p> Attribute Type Constraints Description session_id UUID PK Unique identifier book_id UUID FK \u2192 Book Book being read user_id UUID FK \u2192 User Reader start_time Timestamp Required Session start end_time Timestamp Nullable Session end (null if active) start_position Decimal Nullable Position at start end_position Decimal Nullable Position at end pages_read Integer Nullable Pages read duration_minutes Integer Calculated Total reading time device_type String Nullable Device used device_name String Nullable Device identifier created_at Timestamp Auto Record creation time <p>Relationships:</p> <ul> <li>Many-to-one with Book</li> <li>Many-to-one with User</li> </ul>"},{"location":"entities/#readinggoal","title":"ReadingGoal","text":"<p>Represents a user-defined reading objective.</p> <p>Attributes:</p> Attribute Type Constraints Description goal_id UUID PK Unique identifier user_id UUID FK \u2192 User Goal owner title String Required Goal name description Text Nullable Goal description goal_type Enum books_count, pages_count, reading_time Goal metric target_value Integer Required, &gt; 0 Target number current_value Integer Default: 0 Current progress time_period Enum daily, weekly, monthly, yearly, custom Goal duration type start_date Date Required Goal start end_date Date Required Goal end is_active Boolean Default: true Active status is_completed Boolean Default: false Completion status completed_at Timestamp Nullable Completion time created_at Timestamp Auto Creation time updated_at Timestamp Auto Last update time <p>Relationships:</p> <ul> <li>Many-to-one with User</li> </ul>"},{"location":"entities/#readingprofile","title":"ReadingProfile","text":"<p>Represents saved reader customization settings.</p> <p>Attributes:</p> Attribute Type Constraints Description profile_id UUID PK Unique identifier user_id UUID FK \u2192 User Profile owner name String Required Profile name is_default Boolean Default: false Default profile flag font_family String Default: 'Georgia' Font name font_size Integer Range: 8-72, Default: 16 Font size (pt) font_weight Integer Default: 400 Font weight line_height Decimal Default: 1.5 Line spacing letter_spacing Decimal Default: 0 Letter spacing paragraph_spacing Decimal Default: 1.0 Paragraph spacing text_align Enum left, right, center, justify Text alignment margin_horizontal Integer Default: 20 Horizontal margin (px) margin_vertical Integer Default: 20 Vertical margin (px) background_color String Default: '#FFFFFF' Background (hex) text_color String Default: '#000000' Text color (hex) link_color String Default: '#0066CC' Link color (hex) selection_color String Default: '#B3D4FC' Selection color (hex) theme_mode Enum light, dark, sepia, custom Theme preset reading_mode Enum paginated, continuous Scroll mode page_turn_animation Boolean Default: true Animation enabled column_count Integer Default: 1 Column layout hyphenation Boolean Default: true Hyphenation enabled created_at Timestamp Auto Creation time updated_at Timestamp Auto Last update time <p>Relationships:</p> <ul> <li>Many-to-one with User</li> </ul> <p>Suggested Profiles:</p> <ul> <li>\"Day\" - Light background, dark text</li> <li>\"Night\" - Dark background, light text</li> <li>\"Sepia\" - Warm tones for reduced eye strain</li> <li>\"E-ink\" - High contrast, no animations</li> </ul>"},{"location":"entities/#metadataserverconfig","title":"MetadataServerConfig","text":"<p>Represents the user's connection to a metadata server for cross-device synchronization. Each user has at most one active metadata server connection.</p> <p>Attributes:</p> Attribute Type Constraints Description config_id UUID PK Unique identifier user_id UUID FK \u2192 User, Unique Config owner (one per user) server_url String Required Metadata server URL server_type Enum official, self_hosted Server type auth_token String Encrypted JWT or API token refresh_token String Encrypted, nullable Refresh token is_connected Boolean Default: false Connection status sync_enabled Boolean Default: true Auto-sync enabled sync_interval_seconds Integer Default: 30 Sync frequency last_sync_at Timestamp Nullable Last successful sync sync_status Enum idle, syncing, error Current sync state sync_error_message String Nullable Last error message created_at Timestamp Auto Creation time updated_at Timestamp Auto Last update time <p>Relationships:</p> <ul> <li>One-to-one with User</li> </ul> <p>Notes:</p> <ul> <li>If null, user is in local-only mode (no sync)</li> <li>Server URL validated on save</li> <li>See Server Architecture for details</li> </ul>"},{"location":"entities/#filestoragebackend","title":"FileStorageBackend","text":"<p>Represents a configured file storage backend where book files are stored. Users can have multiple backends.</p> <p>Attributes:</p> Attribute Type Constraints Description backend_id UUID PK Unique identifier user_id UUID FK \u2192 User Backend owner backend_type Enum local, google_drive, onedrive, dropbox, webdav, minio, s3, papyrus_server Backend type name String Required Display name is_primary Boolean Default: false Primary backend for uploads is_active Boolean Default: true Enabled status connection_config JSON Encrypted Type-specific connection settings credentials JSON Encrypted, nullable OAuth tokens or API keys base_path String Nullable Root directory/bucket storage_used_bytes BigInt Nullable Bytes used storage_quota_bytes BigInt Nullable Total capacity last_accessed_at Timestamp Nullable Last file access connection_status Enum connected, disconnected, error Current status error_message String Nullable Last error created_at Timestamp Auto Creation time updated_at Timestamp Auto Last update time <p>Relationships:</p> <ul> <li>Many-to-one with User</li> <li>One-to-many with Book (books reference storage backend)</li> </ul> <p>Connection Config Examples:</p> <pre><code>// Google Drive\n{\n  \"folder_id\": \"abc123\",\n  \"folder_path\": \"/Papyrus/Books\"\n}\n\n// WebDAV\n{\n  \"server_url\": \"https://nextcloud.example.com/remote.php/dav/files/user/\",\n  \"folder_path\": \"/Papyrus/Books\"\n}\n\n// MinIO/S3\n{\n  \"endpoint\": \"https://minio.example.com\",\n  \"bucket\": \"papyrus-books\",\n  \"region\": \"us-east-1\"\n}\n\n// Papyrus Server\n{\n  \"server_url\": \"https://papyrus.example.com\"\n}\n</code></pre> <p>Notes:</p> <ul> <li>Only one backend can be primary at a time</li> <li>Local backend always exists (implicit)</li> <li>See Server Architecture for details</li> </ul>"},{"location":"entities/#savedfilter","title":"SavedFilter","text":"<p>Represents a saved search or filter query for reuse.</p> <p>Attributes:</p> Attribute Type Constraints Description filter_id UUID PK Unique identifier user_id UUID FK \u2192 User Filter owner name String Required Filter display name description Text Nullable Filter description query String Required Filter query string filter_type Enum search, shelf, custom Filter category icon String Nullable Display icon color String Nullable Display color is_pinned Boolean Default: false Pinned to sidebar usage_count Integer Default: 0 Times used last_used_at Timestamp Nullable Last usage time created_at Timestamp Auto Creation time updated_at Timestamp Auto Last update time <p>Relationships:</p> <ul> <li>Many-to-one with User</li> </ul> <p>Query Language Examples:</p> <ul> <li><code>author:\"Isaac Asimov\" AND year:&gt;1970</code></li> <li><code>tag:science-fiction OR tag:fantasy</code></li> <li><code>status:in_progress AND rating:&gt;=4</code></li> <li><code>shelf:\"Currently Reading\" AND format:epub</code></li> </ul>"},{"location":"entities/#junction-tables","title":"Junction Tables","text":""},{"location":"entities/#bookshelf","title":"BookShelf","text":"<p>Many-to-many relationship between Book and Shelf.</p> Attribute Type Constraints book_id UUID FK \u2192 Book, PK shelf_id UUID FK \u2192 Shelf, PK added_at Timestamp Auto sort_order Integer Default: 0"},{"location":"entities/#booktag","title":"BookTag","text":"<p>Many-to-many relationship between Book and Tag.</p> Attribute Type Constraints book_id UUID FK \u2192 Book, PK tag_id UUID FK \u2192 Tag, PK created_at Timestamp Auto"},{"location":"entities/#entity-relationships-summary","title":"Entity Relationships Summary","text":""},{"location":"entities/#by-functional-area","title":"By Functional Area","text":"<p>User Management</p> <ul> <li>User owns all other entities through user_id foreign key</li> <li>User can be anonymous (no email) or registered</li> </ul> <p>Book Organization</p> <ul> <li>Books belong to Shelves (many-to-many)</li> <li>Books have Tags (many-to-many, max 10)</li> <li>Books can belong to a Series (many-to-one)</li> <li>Shelves can be nested (self-referential)</li> </ul> <p>Reading Experience</p> <ul> <li>Books have Annotations (one-to-many)</li> <li>Books have Notes (one-to-many)</li> <li>Books have Bookmarks (one-to-many)</li> <li>Users have ReadingProfiles (one-to-many)</li> </ul> <p>Progress &amp; Goals</p> <ul> <li>Books have ReadingSessions (one-to-many)</li> <li>Users have ReadingGoals (one-to-many)</li> </ul> <p>Configuration</p> <ul> <li>Users have MetadataServerConfig (one-to-one, optional)</li> <li>Users have FileStorageBackends (one-to-many)</li> <li>Users have SavedFilters (one-to-many)</li> <li>Books reference FileStorageBackend (many-to-one)</li> </ul>"},{"location":"entities/#data-integrity-rules","title":"Data Integrity Rules","text":"<ol> <li>Cascade Delete: When User is deleted, all owned entities are deleted</li> <li>Nullify: When Series is deleted, Book.series_id is set to null</li> <li>Restrict: Cannot delete Shelf/Tag while books are associated</li> <li>Unique Constraints:</li> <li>User email must be unique</li> <li>Tag name unique per user</li> <li>Shelf name unique within parent</li> </ol>"},{"location":"market-analysis/","title":"Market Analysis","text":"<p>This section provides market research, competitive analysis, and positioning strategy for Papyrus.</p>"},{"location":"market-analysis/#executive-summary","title":"Executive Summary","text":"<p>Papyrus enters the e-book management market with a focus on user data ownership, cross-platform consistency, and privacy-first design. Unlike existing solutions that lock users into ecosystems or require subscriptions, Papyrus provides a free, open-source alternative that respects user privacy and works across all devices.</p>"},{"location":"market-analysis/#target-audience","title":"Target Audience","text":""},{"location":"market-analysis/#primary-users","title":"Primary Users","text":"<p>1. Avid Digital Readers</p> <ul> <li>Read 10+ books per year</li> <li>Use multiple devices (phone, tablet, e-reader, computer)</li> <li>Frustrated with ecosystem lock-in (Kindle, Kobo)</li> <li>Want to own their book files</li> </ul> <p>2. Privacy-Conscious Users</p> <ul> <li>Prefer local-first applications</li> <li>Avoid cloud services with tracking</li> <li>Want control over their data</li> <li>May self-host services</li> </ul> <p>3. E-ink Device Owners</p> <ul> <li>Use dedicated e-readers (Kobo, Boox, etc.)</li> <li>Want a unified library across devices</li> <li>Need optimized reading experience</li> <li>Value battery efficiency</li> </ul> <p>4. Organized Readers</p> <ul> <li>Large book collections (500+ books)</li> <li>Need powerful organization tools</li> <li>Track reading progress and habits</li> <li>Set and achieve reading goals</li> </ul>"},{"location":"market-analysis/#secondary-users","title":"Secondary Users","text":"<p>5. Students and Researchers</p> <ul> <li>Heavy annotation and note-taking</li> <li>Need to export highlights</li> <li>Organize by topics/courses</li> <li>Reference and citation needs</li> </ul> <p>6. Book Clubs</p> <ul> <li>Shared reading lists</li> <li>Discussion coordination</li> <li>Progress tracking</li> </ul>"},{"location":"market-analysis/#competitive-landscape","title":"Competitive Landscape","text":""},{"location":"market-analysis/#direct-competitors","title":"Direct Competitors","text":"Product Strengths Weaknesses Calibre Powerful, free, open-source Complex UI, desktop-only, steep learning curve BookFusion Cross-platform, good UI Subscription required, cloud-dependent Moon+ Reader Feature-rich Android app Android-only, no sync KOReader Open-source, e-ink optimized Limited platforms, technical setup"},{"location":"market-analysis/#ecosystem-players","title":"Ecosystem Players","text":"Platform Lock-in Cross-platform Notes Amazon Kindle High Yes (apps) Proprietary format, tracking Apple Books High Apple only No export, iOS/macOS only Google Play Books Medium Yes Cloud-only, limited features Kobo Medium Limited Better DRM-free support"},{"location":"market-analysis/#feature-comparison","title":"Feature Comparison","text":"Feature Papyrus Calibre BookFusion Kindle Cross-platform Yes Desktop only Yes Yes Offline-first Yes Yes No Partial Open source Yes Yes No No Self-hostable Yes N/A No No E-ink optimized Yes No No Yes No subscription Yes Yes No Yes Privacy-first Yes Yes No No Format conversion Yes Yes Limited No Annotations export Yes Yes Yes Limited Reading stats Yes Limited Yes Yes"},{"location":"market-analysis/#market-opportunities","title":"Market Opportunities","text":""},{"location":"market-analysis/#gap-analysis","title":"Gap Analysis","text":"<p>1. Unified Cross-Platform Experience</p> <ul> <li>Most solutions are platform-specific or web-only</li> <li>Users want consistent experience across all devices</li> <li>Opportunity: Single app for Android, iOS, Web, Desktop, E-ink</li> </ul> <p>2. Privacy and Data Ownership</p> <ul> <li>Growing concern about data tracking</li> <li>Users want control over their reading data</li> <li>Opportunity: Local-first with optional self-hosted sync</li> </ul> <p>3. E-ink Device Support</p> <ul> <li>Existing apps poorly optimized for e-ink</li> <li>E-ink market growing (Boox, reMarkable, etc.)</li> <li>Opportunity: First-class e-ink support</li> </ul> <p>4. Open Standards</p> <ul> <li>Proprietary formats limit user freedom</li> <li>DRM frustrates legitimate users</li> <li>Opportunity: Focus on open formats (EPUB)</li> </ul> <p>5. Modern User Experience</p> <ul> <li>Calibre is powerful but dated UI</li> <li>Most alternatives are basic</li> <li>Opportunity: Modern, intuitive interface</li> </ul>"},{"location":"market-analysis/#market-trends","title":"Market Trends","text":"<ul> <li>E-reader growth: E-ink device market expanding beyond Kindle</li> <li>Privacy awareness: Post-GDPR users care about data control</li> <li>Self-hosting renaissance: Growing interest in self-hosted services</li> <li>Remote work: More reading time, need for organization</li> <li>Subscription fatigue: Users resisting yet another subscription</li> </ul>"},{"location":"market-analysis/#positioning-strategy","title":"Positioning Strategy","text":""},{"location":"market-analysis/#value-proposition","title":"Value Proposition","text":"<p>Papyrus: Your books, your data, every device.</p> <p>A free, open-source e-book manager that works everywhere you read. No subscriptions, no tracking, no lock-in.</p>"},{"location":"market-analysis/#key-differentiators","title":"Key Differentiators","text":"<ol> <li>True cross-platform: One app for all devices including e-ink</li> <li>Offline-first: Full functionality without internet</li> <li>Privacy by default: No analytics, no tracking</li> <li>Data ownership: Export everything, self-host if desired</li> <li>Modern UX: Clean, intuitive Material 3 design</li> <li>Open source: Transparent, community-driven development</li> </ol>"},{"location":"market-analysis/#target-positioning","title":"Target Positioning","text":"<pre><code>quadrantChart\n    title Market Positioning\n    x-axis Desktop Only --&gt; Mobile First\n    y-axis Simple --&gt; Complex\n    quadrant-1 Complex &amp; Mobile\n    quadrant-2 Complex &amp; Desktop\n    quadrant-3 Simple &amp; Desktop\n    quadrant-4 Simple &amp; Mobile\n    Calibre: [0.15, 0.85]\n    BookFusion: [0.45, 0.35]\n    Papyrus: [0.70, 0.40]</code></pre> <p>Positioning Notes:</p> <ul> <li>Calibre: Powerful but complex, desktop-only</li> <li>BookFusion: Cross-platform but subscription-based</li> <li>Papyrus (target): Mobile-first, simple UX, cross-platform</li> </ul>"},{"location":"market-analysis/#go-to-market-strategy","title":"Go-to-Market Strategy","text":""},{"location":"market-analysis/#phase-1-foundation-mvp","title":"Phase 1: Foundation (MVP)","text":"<p>Target: Early adopters, Calibre users wanting mobile access</p> <p>Features:</p> <ul> <li>Core reading and library management</li> <li>Local-only operation</li> <li>Android and iOS apps</li> <li>Web app</li> </ul> <p>Channels:</p> <ul> <li>GitHub releases</li> <li>Reddit (r/ebooks, r/selfhosted, r/kindle)</li> <li>Hacker News</li> <li>Tech blogs</li> </ul>"},{"location":"market-analysis/#phase-2-growth","title":"Phase 2: Growth","text":"<p>Target: Mainstream readers, privacy-conscious users</p> <p>Features:</p> <ul> <li>Cross-device sync</li> <li>Cloud storage integration</li> <li>E-ink optimization</li> <li>Reading goals</li> </ul> <p>Channels:</p> <ul> <li>App stores (Google Play, Apple App Store)</li> <li>Social media presence</li> <li>Partnerships with e-ink device makers</li> <li>Content marketing (reading tips, book organization)</li> </ul>"},{"location":"market-analysis/#phase-3-expansion","title":"Phase 3: Expansion","text":"<p>Target: Power users, institutions</p> <p>Features:</p> <ul> <li>Plugin ecosystem</li> <li>Team/family features</li> <li>Advanced analytics</li> <li>API for developers</li> </ul> <p>Channels:</p> <ul> <li>Enterprise outreach</li> <li>Educational institutions</li> <li>Developer community</li> </ul>"},{"location":"market-analysis/#risk-analysis","title":"Risk Analysis","text":"Risk Probability Impact Mitigation Limited adoption Medium High Focus on niche first, iterate based on feedback Competition from big players Low Medium Differentiate on privacy and openness E-book format changes Low Medium Modular format support, community plugins Funding sustainability Medium High Open-source donations, optional premium features Technical complexity Medium Medium Prioritize MVP, iterate quickly"},{"location":"market-analysis/#success-metrics","title":"Success Metrics","text":""},{"location":"market-analysis/#user-metrics","title":"User Metrics","text":"Metric Target (Year 1) Monthly Active Users 10,000 Daily Active Users 2,500 Books managed 500,000 User retention (30-day) 40%"},{"location":"market-analysis/#engagement-metrics","title":"Engagement Metrics","text":"Metric Target Reading sessions/user/week 5 Books completed/user/year 8 Annotations/user 50 App store rating 4.5+"},{"location":"market-analysis/#community-metrics","title":"Community Metrics","text":"Metric Target GitHub stars 1,000 Contributors 25 Plugin developers 10 Translations 10 languages"},{"location":"market-analysis/#conclusion","title":"Conclusion","text":"<p>Papyrus has a clear opportunity in the e-book management market by addressing unmet needs:</p> <ol> <li>Cross-platform consistency that ecosystem players can't provide</li> <li>Privacy and data ownership that cloud services don't prioritize</li> <li>Modern UX that Calibre lacks</li> <li>E-ink support that mobile apps ignore</li> </ol> <p>By focusing on these differentiators and targeting privacy-conscious, multi-device readers first, Papyrus can establish a loyal user base before expanding to mainstream adoption.</p>"},{"location":"server-architecture/","title":"Server Architecture","text":"<p>This document describes the server-side architecture for Papyrus, including the self-hostable Papyrus Server, file storage backends, and synchronization mechanisms that enable cross-device functionality.</p>"},{"location":"server-architecture/#architecture-overview","title":"Architecture Overview","text":"<p>Papyrus uses a flexible storage architecture with a central server for metadata and user-chosen file storage:</p> <pre><code>flowchart TB\n    subgraph Clients[\"Papyrus Clients\"]\n        Android[\"Android\"]\n        iOS[\"iOS\"]\n        Web[\"Web\"]\n        Desktop[\"Desktop\"]\n        Eink[\"E-ink\"]\n    end\n\n    subgraph Server[\"Papyrus Server (Self-Hostable)\"]\n        subgraph Metadata[\"Metadata Storage (Always)\"]\n            M1[\"User accounts\"]\n            M2[\"Book metadata\"]\n            M3[\"Reading progress\"]\n            M4[\"Annotations &amp; bookmarks\"]\n            M5[\"Shelves, tags, series\"]\n            M6[\"Reading goals\"]\n            M7[\"Sync coordination\"]\n        end\n        subgraph FileStorage[\"File Storage (Optional)\"]\n            F1[\"Book files (EPUB, PDF)\"]\n            F2[\"Cover images\"]\n        end\n    end\n\n    subgraph AltStorage[\"Alternative File Storage\"]\n        G[\"Google Drive\"]\n        O[\"OneDrive\"]\n        D[\"Dropbox\"]\n        W[\"WebDAV (Nextcloud)\"]\n        S3[\"MinIO / S3\"]\n        L[\"Local device only\"]\n    end\n\n    Android --&gt; Server\n    iOS --&gt; Server\n    Web --&gt; Server\n    Desktop --&gt; Server\n    Eink --&gt; Server\n\n    Server -.-&gt;|\"OR (user's choice)\"| AltStorage</code></pre>"},{"location":"server-architecture/#key-principles","title":"Key Principles","text":"<ol> <li>Unified Server: The Papyrus Server handles metadata (always) and can also handle files (optionally)</li> <li>User Choice: Users select their preferred file storage\u2014either the Papyrus Server or external providers</li> <li>Self-Hostable: The server can be self-hosted for complete data ownership</li> <li>Offline-First: Clients work fully offline, syncing when connected</li> <li>Data Portability: All data can be exported and migrated</li> </ol>"},{"location":"server-architecture/#papyrus-server","title":"Papyrus Server","text":"<p>The Papyrus Server is the central, self-hostable backend for cross-device synchronization. It always handles metadata storage and can optionally serve as the file storage backend.</p>"},{"location":"server-architecture/#responsibilities","title":"Responsibilities","text":"<p>Metadata (Always):</p> Component Description User Management Account registration, authentication, sessions Book Metadata Title, author, ISBN, description, cover URLs Library Organization Shelves, tags, series, custom fields Reading Progress Current position, completion status, time tracking Annotations Highlights, notes, bookmarks Goals Reading goals and progress tracking Sync Coordination Change tracking, conflict resolution File References Pointers to files in storage backends <p>File Storage (Optional\u2014when server is chosen as file backend):</p> Component Description Book Files EPUB, PDF, MOBI, and other e-book formats Cover Images Book cover artwork File API Upload, download, and delete operations Storage Management Quota tracking, cleanup"},{"location":"server-architecture/#data-model","title":"Data Model","text":"<pre><code>flowchart TB\n    subgraph PapyrusServer[\"Papyrus Server\"]\n        User[\"User\"]\n        Book[\"Book\"]\n        Shelf[\"Shelf\"]\n        Tag[\"Tag\"]\n        Annotation[\"Annotation\"]\n        Bookmark[\"Bookmark\"]\n        Note[\"Note\"]\n        Progress[\"Progress\"]\n        Goal[\"Goal\"]\n        Series[\"Series\"]\n        FileRef[\"FileRef\"]\n    end\n\n    User --&gt; Book\n    Book --&gt; Shelf\n    User --&gt; Tag\n    Book --&gt; Annotation\n    Book --&gt; Bookmark\n    Book --&gt; Note\n    Book --&gt; Progress\n    User --&gt; Goal\n    Book --&gt; Series\n    Book --&gt; FileRef\n\n    FileRef -.-&gt;|\"Points to storage\"| Storage[(\"Storage Backend\")]</code></pre>"},{"location":"server-architecture/#api-endpoints","title":"API Endpoints","text":"<p>The Papyrus Server exposes a RESTful API:</p> Category Endpoints Description Auth <code>/api/v1/auth/*</code> Register, login, OAuth, refresh tokens Users <code>/api/v1/users/*</code> Profile, preferences, account deletion Books <code>/api/v1/books/*</code> CRUD operations, metadata, cover images Shelves <code>/api/v1/shelves/*</code> Create, update, organize books Tags <code>/api/v1/tags/*</code> Tag management Series <code>/api/v1/series/*</code> Series management and ordering Annotations <code>/api/v1/annotations/*</code> Highlights, notes, bookmarks Progress <code>/api/v1/progress/*</code> Reading position, sessions, statistics Goals <code>/api/v1/goals/*</code> Goal creation and tracking Sync <code>/api/v1/sync/*</code> Change synchronization Storage <code>/api/v1/storage/*</code> Backend configuration Files <code>/api/v1/files/*</code> File upload/download (when server is file backend) <p>Full API specification: <code>/design/api/swagger.yaml</code></p>"},{"location":"server-architecture/#self-hosting","title":"Self-Hosting","text":"<p>The Papyrus Server is designed for easy self-hosting:</p> <p>Minimum Requirements:</p> <ul> <li>1 CPU core</li> <li>512MB RAM</li> <li>1GB storage for metadata (scales with library size)</li> <li>Additional storage for files (if using server as file backend)</li> <li>PostgreSQL 14+ or SQLite</li> <li>Docker (recommended) or Python 3.9+</li> </ul> <p>Deployment Options:</p> <pre><code># docker-compose.yml (minimal)\nversion: \"3.8\"\nservices:\n  papyrus-server:\n    image: papyrus/server:latest\n    ports:\n      - \"8080:8080\"\n    environment:\n      - DATABASE_URL=sqlite:///data/papyrus.db\n      - SECRET_KEY=${SECRET_KEY}\n    volumes:\n      - papyrus_data:/data\n\nvolumes:\n  papyrus_data:\n</code></pre> <pre><code># docker-compose.yml (production)\nversion: \"3.8\"\nservices:\n  papyrus-server:\n    image: papyrus/server:latest\n    ports:\n      - \"8080:8080\"\n    environment:\n      - DATABASE_URL=postgresql://papyrus:${DB_PASSWORD}@postgres/papyrus\n      - REDIS_URL=redis://redis:6379\n      - SECRET_KEY=${SECRET_KEY}\n    depends_on:\n      - postgres\n      - redis\n\n  postgres:\n    image: postgres:14-alpine\n    environment:\n      POSTGRES_DB: papyrus\n      POSTGRES_USER: papyrus\n      POSTGRES_PASSWORD: ${DB_PASSWORD}\n    volumes:\n      - postgres_data:/var/lib/postgresql/data\n\n  redis:\n    image: redis:7-alpine\n    command: redis-server --appendonly yes\n    volumes:\n      - redis_data:/data\n\nvolumes:\n  postgres_data:\n  redis_data:\n</code></pre>"},{"location":"server-architecture/#hosted-option","title":"Hosted Option","text":"<p>For users who don't want to self-host, an official hosted service may be provided:</p> Tier Features Metadata File Storage Free Basic sync, 1 device 100 books Not included (use external) Personal Full sync, 5 devices Unlimited 5 GB included Family 6 accounts, sharing Unlimited 25 GB shared <p>Note: Users can always use external file storage (Google Drive, etc.) with any tier.</p>"},{"location":"server-architecture/#file-storage-backends","title":"File Storage Backends","text":"<p>Users configure file storage backends in the application settings. Multiple backends can be configured, with one designated as primary.</p>"},{"location":"server-architecture/#supported-backends","title":"Supported Backends","text":""},{"location":"server-architecture/#1-local-storage-default","title":"1. Local Storage (Default)","text":"<p>Files stored only on the device. No sync capability.</p> Property Value Use Case Offline-only, single device Sync None Setup None required Capacity Device storage"},{"location":"server-architecture/#2-google-drive","title":"2. Google Drive","text":"<p>Files stored in user's Google Drive account.</p> Property Value Use Case Consumer users, existing Google users Sync Automatic via Google Setup OAuth 2.0 authorization Capacity User's Google storage quota <p>Configuration:</p> <pre><code>Storage Type: Google Drive\nFolder: /Papyrus/Books (customizable)\nAuth: OAuth 2.0 (sign in with Google)\n</code></pre>"},{"location":"server-architecture/#3-onedrive","title":"3. OneDrive","text":"<p>Files stored in user's Microsoft OneDrive account.</p> Property Value Use Case Microsoft ecosystem users Sync Automatic via OneDrive Setup OAuth 2.0 authorization Capacity User's OneDrive storage quota <p>Configuration:</p> <pre><code>Storage Type: OneDrive\nFolder: /Apps/Papyrus (customizable)\nAuth: OAuth 2.0 (sign in with Microsoft)\n</code></pre>"},{"location":"server-architecture/#4-dropbox","title":"4. Dropbox","text":"<p>Files stored in user's Dropbox account.</p> Property Value Use Case Dropbox users, cross-platform Sync Automatic via Dropbox Setup OAuth 2.0 authorization Capacity User's Dropbox storage quota <p>Configuration:</p> <pre><code>Storage Type: Dropbox\nFolder: /Apps/Papyrus (customizable)\nAuth: OAuth 2.0 (sign in with Dropbox)\n</code></pre>"},{"location":"server-architecture/#5-webdav","title":"5. WebDAV","text":"<p>Files stored on any WebDAV-compatible server (Nextcloud, ownCloud, etc.).</p> Property Value Use Case Self-hosters, NAS users Sync Via WebDAV server Setup Server URL + credentials Capacity Server storage <p>Configuration:</p> <pre><code>Storage Type: WebDAV\nServer URL: https://nextcloud.example.com/remote.php/dav/files/user/\nFolder: /Papyrus/Books\nUsername: user\nPassword: ********\n</code></pre>"},{"location":"server-architecture/#6-minio-s3-compatible","title":"6. MinIO / S3-Compatible","text":"<p>Files stored in MinIO, AWS S3, or any S3-compatible storage.</p> Property Value Use Case Self-hosters, enterprise, developers Sync Via S3 API Setup Endpoint + access keys Capacity Bucket capacity <p>Configuration:</p> <pre><code>Storage Type: S3-Compatible\nEndpoint: https://minio.example.com\nBucket: papyrus-books\nAccess Key: ********\nSecret Key: ********\nRegion: us-east-1 (optional)\n</code></pre>"},{"location":"server-architecture/#7-papyrus-server-unified-storage","title":"7. Papyrus Server (Unified Storage)","text":"<p>Files stored on the same Papyrus Server that handles metadata\u2014the simplest self-hosted setup.</p> Property Value Use Case Full self-hosting, single server Sync Via Papyrus API Setup Included with Papyrus Server Capacity Server storage <p>Configuration:</p> <pre><code>Storage Type: Papyrus Server\nServer URL: https://papyrus.example.com\nAuth: Same as Papyrus Server login\n</code></pre>"},{"location":"server-architecture/#backend-comparison","title":"Backend Comparison","text":"Backend Self-Hosted Free Tier Max File Size Offline Access Local Yes (device) Yes Device limit Full Google Drive No 15GB shared 5TB Selective OneDrive No 5GB 250GB Selective Dropbox No 2GB 2GB (free) Selective WebDAV Yes N/A Server limit Selective MinIO/S3 Yes N/A 5TB per object Selective Papyrus Server Yes N/A Server limit Selective"},{"location":"server-architecture/#storage-configuration-ui","title":"Storage Configuration UI","text":"<p>Users configure storage backends in Settings &gt; Storage:</p> <pre><code>flowchart TB\n    subgraph UI[\"Storage Configuration Screen\"]\n        direction TB\n        Primary[\"Primary Storage Selector\"]\n\n        subgraph Backends[\"Configured Backends\"]\n            GD[\"\u2713 Google Drive [Primary]&lt;br/&gt;user@gmail.com&lt;br/&gt;2.3 GB / 15 GB\"]\n            WD[\"WebDAV (Nextcloud) [Secondary]&lt;br/&gt;nextcloud.example.com&lt;br/&gt;Connected\"]\n        end\n\n        Add[\"+ Add Storage Backend\"]\n\n        subgraph Offline[\"Offline Books\"]\n            Status[\"Downloaded: 45 books (1.2 GB)\"]\n            Manage[\"Manage Offline Books\"]\n        end\n    end\n\n    Primary --&gt; Backends\n    Backends --&gt; Add\n    Add --&gt; Offline</code></pre>"},{"location":"server-architecture/#synchronization-architecture","title":"Synchronization Architecture","text":""},{"location":"server-architecture/#sync-flow","title":"Sync Flow","text":"<pre><code>sequenceDiagram\n    participant A as Client A (Phone)\n    participant LA as Local Store A\n    participant S as Papyrus Server\n    participant LB as Local Store B\n    participant B as Client B (Tablet)\n    participant FS as File Storage Backend\n\n    A-&gt;&gt;LA: 1. Local Change (read page 50)\n    LA-&gt;&gt;LA: Save to Sync Queue\n    LA-&gt;&gt;S: 2. Push to Server\n    S-&gt;&gt;S: Record in Change Log&lt;br/&gt;book_123.position = 50\n    S--&gt;&gt;B: 3. Notify/Poll\n    B-&gt;&gt;S: 4. Fetch Changes\n    S--&gt;&gt;LB: Return changes\n    LB-&gt;&gt;LB: Apply updates\n    LB-&gt;&gt;FS: 5. Sync Files (if needed)</code></pre>"},{"location":"server-architecture/#sync-components","title":"Sync Components","text":""},{"location":"server-architecture/#1-change-tracking","title":"1. Change Tracking","text":"<p>Every syncable entity includes:</p> <pre><code>{\n  \"id\": \"uuid\",\n  \"data\": { ... },\n  \"version\": 15,\n  \"updated_at\": \"2024-01-15T10:30:00Z\",\n  \"device_id\": \"device_abc123\",\n  \"deleted\": false\n}\n</code></pre>"},{"location":"server-architecture/#2-sync-queue","title":"2. Sync Queue","text":"<p>Local changes are queued for sync:</p> <pre><code>{\n  \"queue\": [\n    {\n      \"entity_type\": \"reading_progress\",\n      \"entity_id\": \"book_123\",\n      \"operation\": \"update\",\n      \"data\": { \"position\": \"chapter:5,paragraph:12\" },\n      \"timestamp\": \"2024-01-15T10:30:00Z\",\n      \"retry_count\": 0\n    }\n  ]\n}\n</code></pre>"},{"location":"server-architecture/#3-conflict-resolution","title":"3. Conflict Resolution","text":"<p>When concurrent edits occur:</p> Conflict Type Resolution Strategy Reading position Latest timestamp wins Metadata edits Last write wins + merge non-conflicting fields Annotations Keep both (no true conflict) Shelf membership Union of all changes Deletions Delete wins (with grace period) <p>Conflict Example:</p> <pre><code>Device A: Sets book title to \"Title A\" at T1\nDevice B: Sets book author to \"Author B\" at T2\nResolution: Title = \"Title A\", Author = \"Author B\" (merged)\n</code></pre>"},{"location":"server-architecture/#4-file-sync","title":"4. File Sync","text":"<p>Book files sync separately from metadata:</p> <pre><code>sequenceDiagram\n    participant C as Client\n    participant PS as Papyrus Server\n    participant SB as Storage Backend\n\n    Note over PS: Server stores file reference:&lt;br/&gt;file_id, storage_backend,&lt;br/&gt;storage_path, checksum, size\n\n    C-&gt;&gt;PS: GET /api/v1/books/{id}/file\n    PS--&gt;&gt;C: { download_url: \"signed_url\" }\n    C-&gt;&gt;SB: Download file directly\n    SB--&gt;&gt;C: Book file (EPUB, PDF, etc.)\n    C-&gt;&gt;C: Cache locally for offline access</code></pre>"},{"location":"server-architecture/#sync-settings","title":"Sync Settings","text":"<p>Users configure sync behavior in Settings &gt; Sync:</p> Setting Options Default Auto-sync On/Off On Sync frequency Real-time, 5min, 15min, Manual Real-time Sync on WiFi only On/Off Off Sync reading position On/Off On Sync annotations On/Off On Sync statistics On/Off On Conflict notification On/Off On"},{"location":"server-architecture/#offline-capabilities","title":"Offline Capabilities","text":""},{"location":"server-architecture/#offline-first-design","title":"Offline-First Design","text":"<p>Papyrus works fully offline with eventual sync:</p> Feature Offline Behavior Reading Full access to downloaded books Annotations Create, edit, delete (queued for sync) Progress tracking Tracked locally, synced later Library browsing Cached metadata available Search Local index searched Book import Import to local storage Goals Progress tracked offline"},{"location":"server-architecture/#offline-storage","title":"Offline Storage","text":"<p>Local device storage structure:</p> <pre><code>/papyrus/\n\u251c\u2500\u2500 database/\n\u2502   \u251c\u2500\u2500 metadata.db          # SQLite: books, shelves, etc.\n\u2502   \u251c\u2500\u2500 annotations.db       # SQLite: highlights, notes\n\u2502   \u2514\u2500\u2500 sync_queue.db        # Pending sync operations\n\u251c\u2500\u2500 books/\n\u2502   \u2514\u2500\u2500 {book_id}/\n\u2502       \u251c\u2500\u2500 book.epub        # Downloaded book file\n\u2502       \u251c\u2500\u2500 cover.jpg        # Cached cover image\n\u2502       \u2514\u2500\u2500 index.json       # Search index (if enabled)\n\u251c\u2500\u2500 cache/\n\u2502   \u251c\u2500\u2500 covers/              # Cover image cache\n\u2502   \u2514\u2500\u2500 metadata/            # API response cache\n\u2514\u2500\u2500 config/\n    \u251c\u2500\u2500 settings.json        # User preferences\n    \u2514\u2500\u2500 storage.json         # Backend configuration\n</code></pre>"},{"location":"server-architecture/#download-management","title":"Download Management","text":"<p>Users control which books are available offline in Settings &gt; Offline Books:</p> <p>Auto-download rules:</p> <ul> <li>None (manual only)</li> <li>Currently reading shelf (default)</li> <li>All books</li> <li>Custom shelves</li> </ul> <p>Storage settings:</p> <ul> <li>Storage limit: configurable (e.g., 5 GB)</li> <li>Shows current usage (e.g., 1.2 GB, 45 books)</li> </ul> <p>Book list shows:</p> Book Size Status The Great Gatsby 12 MB \u2611 Downloaded 1984 8 MB \u2611 Downloaded Dune 15 MB \u2611 Downloaded War and Peace 45 MB \u2610 Cloud only <p>Actions: Download Selected, Remove All</p>"},{"location":"server-architecture/#security","title":"Security","text":""},{"location":"server-architecture/#authentication","title":"Authentication","text":"Method Use Case JWT Tokens API authentication Refresh Tokens Long-lived sessions with rotation OAuth 2.0 Google sign-in, storage backends API Keys Third-party integrations (optional)"},{"location":"server-architecture/#data-protection","title":"Data Protection","text":"Layer Protection In Transit TLS 1.3 for all connections At Rest (Server) Database encryption (optional) At Rest (Client) Platform keychain for credentials Storage Backends Provider's encryption (Google, etc.)"},{"location":"server-architecture/#privacy","title":"Privacy","text":"<ul> <li>No analytics by default (opt-in only)</li> <li>Metadata server does not access file contents</li> <li>Storage backend credentials stored locally only</li> <li>Complete data export available</li> <li>Account deletion removes all server data</li> </ul>"},{"location":"server-architecture/#deployment-scenarios","title":"Deployment Scenarios","text":""},{"location":"server-architecture/#scenario-1-cloud-first-user","title":"Scenario 1: Cloud-First User","text":"<p>Uses hosted Papyrus Server + Google Drive for files.</p> <pre><code>Client \u2500\u2500\u25b6 Hosted Papyrus Server (papyrus.app)\n       \u2514\u2500\u2500\u25b6 Google Drive (user's account)\n</code></pre> <p>Setup: Sign up, connect Google Drive, done.</p>"},{"location":"server-architecture/#scenario-2-privacy-conscious-self-hoster","title":"Scenario 2: Privacy-Conscious Self-Hoster","text":"<p>Self-hosts everything on home server.</p> <pre><code>Client \u2500\u2500\u25b6 Self-Hosted Papyrus Server (home.local)\n       \u2514\u2500\u2500\u25b6 Self-Hosted MinIO (home.local)\n</code></pre> <p>Setup: Deploy Docker stack, configure DNS/VPN.</p>"},{"location":"server-architecture/#scenario-3-hybrid-user","title":"Scenario 3: Hybrid User","text":"<p>Self-hosted metadata, Dropbox for files (for mobile access).</p> <pre><code>Client \u2500\u2500\u25b6 Self-Hosted Papyrus Server (VPS)\n       \u2514\u2500\u2500\u25b6 Dropbox (user's account)\n</code></pre> <p>Setup: Deploy server on VPS, connect Dropbox.</p>"},{"location":"server-architecture/#scenario-4-offline-only-user","title":"Scenario 4: Offline-Only User","text":"<p>No server, local storage only.</p> <pre><code>Client \u2500\u2500\u25b6 Local Storage Only\n</code></pre> <p>Setup: None. Works out of the box.</p>"},{"location":"server-architecture/#related-documents","title":"Related Documents","text":"<ul> <li>Technologies - Technology stack details</li> <li>Database Model - Data schema</li> <li>Functional Requirements - FR-7.x (Storage &amp; Sync)</li> <li>Non-Functional Requirements - NFR-2.x (Synchronization)</li> <li>API Specification - Full API documentation</li> </ul>"},{"location":"technologies/","title":"Technologies","text":"<p>This section describes the technology stack, architecture decisions, and deployment options for Papyrus.</p>"},{"location":"technologies/#technology-stack-overview","title":"Technology Stack Overview","text":"Layer Technology Purpose Frontend Flutter 3.x (Dart 3.x) Cross-platform UI Backend FastAPI (Python 3.9+) REST API server Database PostgreSQL 14+ Primary data store Caching Redis 6+ Sessions, caching Storage Multiple backends Book file storage Deployment Docker, Kubernetes Container orchestration"},{"location":"technologies/#frontend-flutter","title":"Frontend: Flutter","text":""},{"location":"technologies/#why-flutter","title":"Why Flutter?","text":"<ul> <li>Single codebase for Android, iOS, Web, Desktop, and e-ink devices</li> <li>High performance with native compilation</li> <li>Rich widget library with Material 3 support</li> <li>Strong typing with Dart language</li> <li>Active community and extensive packages</li> </ul>"},{"location":"technologies/#target-platforms","title":"Target Platforms","text":"Platform SDK Build Target Android Flutter SDK APK/AAB iOS Flutter SDK + Xcode IPA Web Flutter SDK PWA Windows Flutter SDK + MSVC EXE macOS Flutter SDK + Xcode DMG Linux Flutter SDK + GTK AppImage/Snap E-ink Android APK Optimized build"},{"location":"technologies/#key-packages","title":"Key Packages","text":"<pre><code>dependencies:\n  # State Management\n  provider: ^6.0.0          # ChangeNotifier pattern\n\n  # Navigation\n  go_router: ^12.0.0        # Declarative routing\n\n  # Storage\n  hive: ^2.2.0              # Local key-value store\n  sqflite: ^2.3.0           # SQLite for mobile\n\n  # E-book Rendering\n  epub_view: ^3.0.0         # EPUB reader\n  pdfx: ^2.4.0              # PDF viewer\n\n  # Networking\n  dio: ^5.3.0               # HTTP client\n  connectivity_plus: ^5.0.0  # Network detection\n\n  # UI Components\n  flutter_slidable: ^3.0.0   # Swipe actions\n  cached_network_image: ^3.3.0 # Image caching\n\n  # Authentication\n  firebase_auth: ^4.0.0     # Firebase auth\n  google_sign_in: ^6.1.0    # Google OAuth\n</code></pre>"},{"location":"technologies/#architecture-clean-architecture","title":"Architecture: Clean Architecture","text":"<pre><code>lib/\n\u251c\u2500\u2500 main.dart                    # App entry point\n\u251c\u2500\u2500 config/\n\u2502   \u251c\u2500\u2500 app_router.dart          # Route configuration\n\u2502   \u251c\u2500\u2500 themes.dart              # Theme definitions\n\u2502   \u2514\u2500\u2500 constants.dart           # App constants\n\u251c\u2500\u2500 core/\n\u2502   \u251c\u2500\u2500 errors/                  # Error handling\n\u2502   \u251c\u2500\u2500 network/                 # API client\n\u2502   \u2514\u2500\u2500 utils/                   # Utilities\n\u251c\u2500\u2500 data/\n\u2502   \u251c\u2500\u2500 datasources/             # Remote &amp; local data\n\u2502   \u251c\u2500\u2500 models/                  # Data models (DTOs)\n\u2502   \u2514\u2500\u2500 repositories/            # Repository implementations\n\u251c\u2500\u2500 domain/\n\u2502   \u251c\u2500\u2500 entities/                # Business entities\n\u2502   \u251c\u2500\u2500 repositories/            # Repository interfaces\n\u2502   \u2514\u2500\u2500 usecases/                # Business logic\n\u251c\u2500\u2500 presentation/\n\u2502   \u251c\u2500\u2500 pages/                   # Screen widgets\n\u2502   \u251c\u2500\u2500 widgets/                 # Reusable components\n\u2502   \u251c\u2500\u2500 providers/               # State management\n\u2502   \u2514\u2500\u2500 forms/                   # Form widgets\n\u2514\u2500\u2500 services/\n    \u251c\u2500\u2500 storage/                 # Storage backends\n    \u251c\u2500\u2500 sync/                    # Synchronization\n    \u2514\u2500\u2500 reader/                  # E-book rendering\n</code></pre>"},{"location":"technologies/#offline-first-architecture","title":"Offline-First Architecture","text":"<p>Papyrus uses an offline-first approach where all data is stored locally first, then synchronized with the server when online.</p> <pre><code>flowchart TB\n    subgraph FlutterApp[\"Flutter App\"]\n        subgraph Presentation[\"Presentation Layer\"]\n            UI[\"UI Layer&lt;br/&gt;(Widgets)\"]\n        end\n\n        subgraph Domain[\"Domain Layer\"]\n            UseCases[\"UseCases\"]\n        end\n\n        subgraph Data[\"Data Layer\"]\n            Repository[\"Repository\"]\n        end\n\n        UI --&gt; UseCases --&gt; Repository\n\n        subgraph Storage[\"Storage\"]\n            Local[\"Local Storage&lt;br/&gt;(Hive/SQLite)\"]\n            Remote[\"Remote API&lt;br/&gt;(Optional)\"]\n            SyncQueue[\"Sync Queue&lt;br/&gt;(Pending Changes)\"]\n        end\n\n        Repository --&gt; Local\n        Repository --&gt; Remote\n        Local --&gt; SyncQueue\n        Remote --&gt; SyncQueue\n    end</code></pre> <p>Key Principles:</p> <ol> <li>All reads go to local storage first</li> <li>Writes are saved locally immediately</li> <li>Background sync pushes changes to server</li> <li>Conflict resolution on sync</li> <li>Works fully without internet</li> </ol>"},{"location":"technologies/#e-ink-optimization","title":"E-ink Optimization","text":"<p>For e-ink devices, the app implements specific optimizations:</p> <p>E-ink Mode Features:</p> <ul> <li>High contrast black/white color scheme</li> <li>Disabled or minimal animations</li> <li>Larger touch targets (minimum 48px)</li> <li>Reduced screen refresh operations</li> <li>Hardware page-turn button support</li> <li>Optimized font rendering for grayscale</li> </ul> <p>Detection and Configuration:</p> <ul> <li>Automatic detection via device model (Boox, Kobo, etc.)</li> <li>Manual toggle in settings</li> <li>E-ink specific reading profile defaults</li> <li>Reduced refresh rate for battery efficiency</li> </ul>"},{"location":"technologies/#backend-fastapi","title":"Backend: FastAPI","text":""},{"location":"technologies/#why-fastapi","title":"Why FastAPI?","text":"<ul> <li>High performance with async support</li> <li>Automatic API docs via OpenAPI/Swagger</li> <li>Type safety with Pydantic models</li> <li>Easy to deploy with Docker</li> <li>Python ecosystem for OCR, ML features</li> </ul>"},{"location":"technologies/#api-structure","title":"API Structure","text":"<pre><code>server/\n\u251c\u2500\u2500 app/\n\u2502   \u251c\u2500\u2500 main.py              # FastAPI app\n\u2502   \u251c\u2500\u2500 config.py            # Settings\n\u2502   \u251c\u2500\u2500 database.py          # DB connection\n\u2502   \u251c\u2500\u2500 api/\n\u2502   \u2502   \u251c\u2500\u2500 v1/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 auth.py      # Authentication\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 books.py     # Book endpoints\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 shelves.py   # Shelf endpoints\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 sync.py      # Sync endpoints\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 ...\n\u2502   \u2502   \u2514\u2500\u2500 deps.py          # Dependencies\n\u2502   \u251c\u2500\u2500 models/              # SQLAlchemy models\n\u2502   \u251c\u2500\u2500 schemas/             # Pydantic schemas\n\u2502   \u251c\u2500\u2500 services/            # Business logic\n\u2502   \u2514\u2500\u2500 utils/               # Utilities\n\u251c\u2500\u2500 tests/\n\u251c\u2500\u2500 alembic/                 # Migrations\n\u251c\u2500\u2500 Dockerfile\n\u2514\u2500\u2500 requirements.txt\n</code></pre>"},{"location":"technologies/#api-endpoints-summary","title":"API Endpoints (Summary)","text":"Method Endpoint Description POST /api/v1/auth/register Register account POST /api/v1/auth/login Login POST /api/v1/auth/google Google OAuth GET /api/v1/books List books POST /api/v1/books Create book GET /api/v1/books/{id} Get book PUT /api/v1/books/{id} Update book DELETE /api/v1/books/{id} Delete book POST /api/v1/books/{id}/upload Upload file GET /api/v1/shelves List shelves POST /api/v1/sync Sync changes GET /api/v1/sync/status Sync status <p>Full API specification: <code>/design/api/swagger.yaml</code></p>"},{"location":"technologies/#database-postgresql","title":"Database: PostgreSQL","text":""},{"location":"technologies/#why-postgresql","title":"Why PostgreSQL?","text":"<ul> <li>JSONB support for flexible metadata</li> <li>Full-text search for book content</li> <li>Reliability and ACID compliance</li> <li>Scalability with read replicas</li> <li>Rich ecosystem of tools</li> </ul>"},{"location":"technologies/#configuration","title":"Configuration","text":"<pre><code># docker-compose.yml\nservices:\n  postgres:\n    image: postgres:14-alpine\n    environment:\n      POSTGRES_DB: papyrus\n      POSTGRES_USER: papyrus\n      POSTGRES_PASSWORD: ${DB_PASSWORD}\n    volumes:\n      - postgres_data:/var/lib/postgresql/data\n    ports:\n      - \"5432:5432\"\n</code></pre>"},{"location":"technologies/#caching-redis","title":"Caching: Redis","text":""},{"location":"technologies/#use-cases","title":"Use Cases","text":"<ul> <li>Session storage - JWT token blacklist</li> <li>Rate limiting - API request throttling</li> <li>Cache - Frequently accessed data</li> <li>Pub/Sub - Real-time sync notifications</li> </ul> <pre><code># docker-compose.yml\nservices:\n  redis:\n    image: redis:6-alpine\n    command: redis-server --appendonly yes\n    volumes:\n      - redis_data:/data\n    ports:\n      - \"6379:6379\"\n</code></pre>"},{"location":"technologies/#storage-architecture","title":"Storage Architecture","text":"<p>Papyrus uses a split storage architecture separating metadata from files:</p> <ul> <li>Metadata Server: Stores user data, book metadata, reading progress, annotations, sync state</li> <li>File Storage Backends: Store actual book files (user's choice)</li> </ul> <p>This separation allows users to choose their preferred file storage while using a centralized (or self-hosted) metadata server for synchronization.</p> <p>See Server Architecture for complete details.</p>"},{"location":"technologies/#file-storage-backends","title":"File Storage Backends","text":"Backend Use Case Configuration Local Default, single device Device file system Google Drive Consumer cloud OAuth 2.0 OneDrive Microsoft ecosystem OAuth 2.0 Dropbox Cross-platform cloud OAuth 2.0 WebDAV NAS, Nextcloud Username/Password MinIO/S3 Self-hosted S3-compatible Access/Secret keys Papyrus Server Unified self-hosting Same as metadata server"},{"location":"technologies/#storage-interface","title":"Storage Interface","text":"<pre><code>abstract class StorageBackend {\n  Future&lt;void&gt; connect();\n  Future&lt;void&gt; disconnect();\n  Future&lt;String&gt; uploadFile(String localPath, String remotePath);\n  Future&lt;String&gt; downloadFile(String remotePath, String localPath);\n  Future&lt;void&gt; deleteFile(String remotePath);\n  Future&lt;List&lt;String&gt;&gt; listFiles(String path);\n  Future&lt;bool&gt; fileExists(String path);\n  Future&lt;StorageInfo&gt; getStorageInfo();\n}\n</code></pre>"},{"location":"technologies/#security","title":"Security","text":""},{"location":"technologies/#authentication","title":"Authentication","text":"<ul> <li>JWT tokens for API authentication</li> <li>Refresh token rotation for security</li> <li>OAuth 2.0 for Google sign-in</li> <li>bcrypt/Argon2 for password hashing</li> </ul>"},{"location":"technologies/#encryption","title":"Encryption","text":"<ul> <li>TLS 1.3 for all network traffic</li> <li>AES-256 for sensitive data at rest</li> <li>Key derivation using PBKDF2</li> </ul>"},{"location":"technologies/#privacy","title":"Privacy","text":"<ul> <li>No default analytics - opt-in telemetry only</li> <li>Data minimization - collect only necessary data</li> <li>Right to deletion - complete data removal</li> <li>Data export - full user data portability</li> </ul>"},{"location":"technologies/#deployment","title":"Deployment","text":""},{"location":"technologies/#docker-compose-developmentsmall-scale","title":"Docker Compose (Development/Small Scale)","text":"<pre><code># docker-compose.yml\nversion: \"3.8\"\nservices:\n  api:\n    build: ./server\n    ports:\n      - \"8000:8000\"\n    environment:\n      - DATABASE_URL=postgresql://papyrus:password@postgres/papyrus\n      - REDIS_URL=redis://redis:6379\n    depends_on:\n      - postgres\n      - redis\n\n  postgres:\n    image: postgres:14-alpine\n    volumes:\n      - postgres_data:/var/lib/postgresql/data\n\n  redis:\n    image: redis:6-alpine\n    volumes:\n      - redis_data:/data\n\nvolumes:\n  postgres_data:\n  redis_data:\n</code></pre>"},{"location":"technologies/#kubernetes-production","title":"Kubernetes (Production)","text":"<p>For production deployments with scaling requirements, Kubernetes manifests are provided with:</p> <ul> <li>Horizontal pod autoscaling</li> <li>Secrets management</li> <li>Persistent volume claims</li> <li>Ingress configuration</li> <li>Health checks</li> </ul>"},{"location":"technologies/#development-environment","title":"Development Environment","text":""},{"location":"technologies/#prerequisites","title":"Prerequisites","text":"Tool Version Purpose Flutter SDK 3.x Frontend development Dart 3.x Flutter language Python 3.9+ Backend development Docker 20+ Container runtime VS Code Latest Recommended IDE"},{"location":"technologies/#setup-commands","title":"Setup Commands","text":"<pre><code># Clone repository\ngit clone https://github.com/user/papyrus.git\ncd papyrus\n\n# Frontend setup\ncd client\nflutter pub get\nflutter run\n\n# Backend setup (in another terminal)\ncd server\npython -m venv venv\nsource venv/bin/activate\npip install -r requirements.txt\nuvicorn app.main:app --reload\n\n# Or with Docker\ndocker-compose up -d\n</code></pre>"},{"location":"technologies/#code-quality","title":"Code Quality","text":"<pre><code># Frontend\ndart analyze\ndart format .\nflutter test\n\n# Backend\nflake8 app/\nblack app/\npytest tests/\n</code></pre>"},{"location":"technologies/#third-party-services-optional","title":"Third-Party Services (Optional)","text":"Service Purpose Required Firebase Auth Authentication Optional Google Books API Metadata Optional Open Library API Metadata Optional Sentry Error tracking Optional Plausible Privacy-friendly analytics Optional"},{"location":"use-cases/","title":"Use Cases","text":"<p>This section presents the main use cases derived from the functional requirements. Each use case includes actors, requirements traceability, detailed flows, and alternative scenarios.</p>"},{"location":"use-cases/#use-case-notation","title":"Use Case Notation","text":"Element Description UC-X.Y Use case identifier (section X, item Y) Actors User types involved Priority P0-P3 (matches requirement priority) Requirements Links to FR and NFR Preconditions State required before use case Main Flow Primary success scenario Alternative Flows Variations and edge cases Postconditions State after successful completion"},{"location":"use-cases/#1-user-management-use-cases","title":"1. User Management Use Cases","text":""},{"location":"use-cases/#uc-11-create-user-account","title":"UC-1.1: Create User Account","text":"<p>Actors: Anonymous User \u2192 Registered User Priority: P0 Requirements: FR-1.1</p> <p>Description: User creates a new account to access synchronization and cloud features.</p> <p>Preconditions:</p> <ul> <li>User is not logged in</li> <li>User has valid email address</li> </ul> <p>Main Flow:</p> <ol> <li>User navigates to registration screen</li> <li>User enters email address and password</li> <li>System validates email format and uniqueness</li> <li>System validates password strength (8+ chars, mixed case, number)</li> <li>System creates account in inactive state</li> <li>System sends verification email</li> <li>User clicks verification link</li> <li>System activates account</li> <li>User is redirected to login screen</li> </ol> <p>Alternative Flows:</p> <p>A1: Email already registered</p> <ul> <li>At step 3, if email exists:</li> <li>System displays \"Email already registered\" error</li> <li>User can choose to log in or recover password</li> </ul> <p>A2: Weak password</p> <ul> <li>At step 4, if password is too weak:</li> <li>System displays password requirements</li> <li>User must enter a stronger password</li> </ul> <p>A3: Verification link expired</p> <ul> <li>At step 7, if link expired (24 hours):</li> <li>System displays expiration message</li> <li>User can request new verification email</li> </ul> <p>Postconditions:</p> <ul> <li>New user account exists</li> <li>User can log in with credentials</li> </ul>"},{"location":"use-cases/#uc-12-login-with-credentials","title":"UC-1.2: Login with Credentials","text":"<p>Actors: Registered User Priority: P0 Requirements: FR-1.2</p> <p>Description: User authenticates using email and password.</p> <p>Preconditions:</p> <ul> <li>User has registered account</li> <li>Account is verified and active</li> </ul> <p>Main Flow:</p> <ol> <li>User navigates to login screen</li> <li>User enters email and password</li> <li>System validates credentials</li> <li>System creates session token</li> <li>User is redirected to library</li> </ol> <p>Alternative Flows:</p> <p>A1: Invalid credentials</p> <ul> <li>At step 3, if credentials invalid:</li> <li>System displays \"Invalid email or password\"</li> <li>Failed attempt is logged</li> <li>After 5 failures, temporary lockout (15 minutes)</li> </ul> <p>A2: Account not verified</p> <ul> <li>At step 3, if account not verified:</li> <li>System prompts to resend verification email</li> </ul> <p>A3: Account disabled</p> <ul> <li>At step 3, if account disabled:</li> <li>System displays account disabled message</li> <li>User is directed to support contact</li> </ul> <p>Postconditions:</p> <ul> <li>User is authenticated</li> <li>Session token is stored on device</li> <li>User has access to their library</li> </ul>"},{"location":"use-cases/#uc-13-login-with-google-account","title":"UC-1.3: Login with Google Account","text":"<p>Actors: Registered User Priority: P1 Requirements: FR-1.3</p> <p>Description: User authenticates via Google OAuth 2.0.</p> <p>Preconditions:</p> <ul> <li>User has Google account</li> <li>Device has internet connection</li> </ul> <p>Main Flow:</p> <ol> <li>User selects \"Sign in with Google\"</li> <li>System redirects to Google OAuth</li> <li>User authorizes application</li> <li>Google returns authorization code</li> <li>System exchanges code for user info</li> <li>If new user, system creates account</li> <li>System creates session token</li> <li>User is redirected to library</li> </ol> <p>Alternative Flows:</p> <p>A1: User denies authorization</p> <ul> <li>At step 3, if user denies:</li> <li>System returns to login screen</li> <li>Message: \"Google sign-in cancelled\"</li> </ul> <p>A2: Link to existing account</p> <ul> <li>At step 6, if email matches existing account:</li> <li>System prompts to link accounts</li> <li>User confirms linking</li> </ul> <p>Postconditions:</p> <ul> <li>User is authenticated</li> <li>Google account linked to Papyrus account</li> </ul>"},{"location":"use-cases/#uc-14-use-application-offline","title":"UC-1.4: Use Application Offline","text":"<p>Actors: Anonymous User, Registered User Priority: P0 Requirements: FR-1.4, NFR-2.1</p> <p>Description: User accesses application without internet connection.</p> <p>Preconditions:</p> <ul> <li>Application is installed on device</li> <li>For registered users: at least one previous online session</li> </ul> <p>Main Flow:</p> <ol> <li>User opens application without internet</li> <li>System detects offline state</li> <li>System loads local data</li> <li>User accesses library and books</li> <li>User can read, annotate, organize</li> <li>Changes are stored locally</li> <li>Offline indicator is displayed</li> </ol> <p>Alternative Flows:</p> <p>A1: First launch (Anonymous)</p> <ul> <li>User can immediately use all local features</li> <li>No account required</li> </ul> <p>A2: First launch (Registered, never synced)</p> <ul> <li>System shows \"Connect to sync your data\"</li> <li>User can continue with empty library</li> </ul> <p>A3: Sync when online</p> <ul> <li>When internet restored:</li> <li>System begins background sync</li> <li>Pending changes indicator updates</li> </ul> <p>Postconditions:</p> <ul> <li>User can use reading and management features</li> <li>Changes are queued for sync</li> </ul>"},{"location":"use-cases/#uc-15-recover-password","title":"UC-1.5: Recover Password","text":"<p>Actors: Registered User Priority: P1 Requirements: FR-1.5</p> <p>Description: User resets forgotten password via email.</p> <p>Preconditions:</p> <ul> <li>User has registered account</li> <li>User has access to registered email</li> </ul> <p>Main Flow:</p> <ol> <li>User clicks \"Forgot password\"</li> <li>User enters registered email</li> <li>System sends recovery email with link</li> <li>User clicks link (valid 24 hours)</li> <li>User enters new password</li> <li>System validates password strength</li> <li>System updates password</li> <li>All existing sessions are invalidated</li> <li>User is redirected to login</li> </ol> <p>Alternative Flows:</p> <p>A1: Email not found</p> <ul> <li>At step 3, system still shows success message (security)</li> <li>No email sent if account doesn't exist</li> </ul> <p>A2: Link expired</p> <ul> <li>At step 4, if link expired:</li> <li>System displays expiration message</li> <li>User can request new link</li> </ul> <p>Postconditions:</p> <ul> <li>Password is updated</li> <li>User must log in with new password</li> </ul>"},{"location":"use-cases/#uc-16-delete-account","title":"UC-1.6: Delete Account","text":"<p>Actors: Registered User Priority: P1 Requirements: FR-1.6</p> <p>Description: User permanently deletes their account and all data.</p> <p>Preconditions:</p> <ul> <li>User is logged in</li> <li>User understands consequences</li> </ul> <p>Main Flow:</p> <ol> <li>User navigates to account settings</li> <li>User selects \"Delete account\"</li> <li>System displays warning about data loss</li> <li>User confirms by entering password</li> <li>System marks account for deletion</li> <li>System logs user out</li> <li>Account and data deleted within 30 days</li> </ol> <p>Alternative Flows:</p> <p>A1: Export data first</p> <ul> <li>Before step 4, user can export all data</li> <li>See UC-2.7 for export process</li> </ul> <p>A2: Cancel deletion</p> <ul> <li>Within 7 days, user can log in to cancel</li> <li>Account is restored to active state</li> </ul> <p>Postconditions:</p> <ul> <li>Account is deleted</li> <li>User data removed from server</li> <li>Local data remains on device</li> </ul>"},{"location":"use-cases/#2-book-management-use-cases","title":"2. Book Management Use Cases","text":""},{"location":"use-cases/#uc-21-import-book-files","title":"UC-2.1: Import Book Files","text":"<p>Actors: Reader Priority: P0 Requirements: FR-2.6, FR-7.2</p> <p>Description: User adds books to library from files.</p> <p>Preconditions:</p> <ul> <li>User has book files in supported format</li> </ul> <p>Main Flow:</p> <ol> <li>User selects \"Add books\"</li> <li>User chooses import source (device, cloud, URL)</li> <li>User selects files</li> <li>System uploads/imports files</li> <li>System extracts metadata from files</li> <li>System checks for duplicates</li> <li>Books are added to library</li> <li>User receives confirmation</li> </ol> <p>Alternative Flows:</p> <p>A1: Unsupported format</p> <ul> <li>System displays format error</li> <li>Lists supported formats</li> </ul> <p>A2: Duplicate detected</p> <ul> <li>System shows existing book</li> <li>User can: skip, replace, keep both</li> </ul> <p>A3: Bulk import</p> <ul> <li>User selects folder</li> <li>System imports all supported files</li> <li>Progress shown for large imports</li> </ul> <p>A4: Import from URL</p> <ul> <li>User enters URL</li> <li>System downloads and imports</li> </ul> <p>Postconditions:</p> <ul> <li>Books are in user's library</li> <li>Metadata is populated</li> </ul>"},{"location":"use-cases/#uc-22-convert-book-formats","title":"UC-2.2: Convert Book Formats","text":"<p>Actors: Reader Priority: P2 Requirements: FR-2.1</p> <p>Description: User converts book to different format.</p> <p>Preconditions:</p> <ul> <li>Book exists in library</li> <li>Source format supports conversion</li> </ul> <p>Main Flow:</p> <ol> <li>User opens book details</li> <li>User selects \"Convert format\"</li> <li>User chooses target format</li> <li>User sets conversion options (optional)</li> <li>System processes conversion</li> <li>Converted file is added to library</li> <li>Original file is preserved</li> </ol> <p>Alternative Flows:</p> <p>A1: Conversion fails</p> <ul> <li>System shows error details</li> <li>User can retry with different options</li> </ul> <p>A2: Large file</p> <ul> <li>Progress indicator shown</li> <li>Conversion runs in background</li> <li>Notification when complete</li> </ul> <p>Postconditions:</p> <ul> <li>New file in target format exists</li> <li>Original file unchanged</li> </ul>"},{"location":"use-cases/#uc-23-edit-book-metadata","title":"UC-2.3: Edit Book Metadata","text":"<p>Actors: Reader Priority: P0 Requirements: FR-2.2, FR-2.13</p> <p>Description: User modifies book information.</p> <p>Preconditions:</p> <ul> <li>Book exists in library</li> </ul> <p>Main Flow:</p> <ol> <li>User opens book details</li> <li>User selects \"Edit\"</li> <li>User modifies metadata fields</li> <li>User saves changes</li> <li>System validates and stores changes</li> </ol> <p>Alternative Flows:</p> <p>A1: Fetch metadata online</p> <ul> <li>User clicks \"Fetch metadata\"</li> <li>System searches online sources</li> <li>User reviews and selects matches</li> <li>Selected metadata is applied</li> </ul> <p>A2: Edit cover image</p> <ul> <li>User can upload new cover</li> <li>User can crop/adjust cover</li> <li>User can fetch cover online</li> </ul> <p>Postconditions:</p> <ul> <li>Book metadata is updated</li> </ul>"},{"location":"use-cases/#uc-24-organize-books-into-shelves","title":"UC-2.4: Organize Books into Shelves","text":"<p>Actors: Reader Priority: P0 Requirements: FR-2.9</p> <p>Description: User creates and manages book collections.</p> <p>Preconditions:</p> <ul> <li>User has books in library</li> </ul> <p>Main Flow:</p> <ol> <li>User navigates to Shelves</li> <li>User creates new shelf (name, description, color)</li> <li>User adds books to shelf</li> <li>Shelf is saved</li> </ol> <p>Alternative Flows:</p> <p>A1: Add from library view</p> <ul> <li>User long-presses book</li> <li>User selects \"Add to shelf\"</li> <li>User chooses shelf(s)</li> </ul> <p>A2: Create nested shelf</p> <ul> <li>User creates shelf within existing shelf</li> <li>Hierarchy is maintained</li> </ul> <p>A3: Drag and drop</p> <ul> <li>User drags book to shelf</li> <li>Book is added to shelf</li> </ul> <p>Postconditions:</p> <ul> <li>Books are organized in shelves</li> </ul>"},{"location":"use-cases/#uc-25-tag-books","title":"UC-2.5: Tag Books","text":"<p>Actors: Reader Priority: P0 Requirements: FR-2.10</p> <p>Description: User assigns colored labels to books.</p> <p>Preconditions:</p> <ul> <li>User has books in library</li> </ul> <p>Main Flow:</p> <ol> <li>User opens book details or context menu</li> <li>User selects \"Tags\"</li> <li>User creates or selects tags</li> <li>Tags are applied to book</li> </ol> <p>Alternative Flows:</p> <p>A1: Create new tag</p> <ul> <li>User enters tag name</li> <li>User selects color</li> <li>Tag is created and applied</li> </ul> <p>A2: Batch tagging</p> <ul> <li>User selects multiple books</li> <li>User applies tags to all</li> </ul> <p>Postconditions:</p> <ul> <li>Books have assigned tags</li> <li>Tags visible in library view</li> </ul>"},{"location":"use-cases/#uc-26-search-books","title":"UC-2.6: Search Books","text":"<p>Actors: Reader Priority: P0 Requirements: FR-2.7, FR-2.8, FR-2.11</p> <p>Description: User finds books using search and filters.</p> <p>Preconditions:</p> <ul> <li>User has books in library</li> </ul> <p>Main Flow:</p> <ol> <li>User opens search</li> <li>User enters query</li> <li>System searches metadata</li> <li>Results are displayed</li> <li>User can filter/sort results</li> </ol> <p>Alternative Flows:</p> <p>A1: Full-text search</p> <ul> <li>User searches book contents</li> <li>Results show matched text with context</li> </ul> <p>A2: Advanced filters</p> <ul> <li>User uses filter panel</li> <li>Multiple criteria combined</li> </ul> <p>A3: Query language</p> <ul> <li>User types query like <code>author:\"Name\" AND year:&gt;2000</code></li> <li>System parses and executes</li> </ul> <p>A4: Save search</p> <ul> <li>User saves search as filter</li> <li>Filter available for reuse</li> </ul> <p>Postconditions:</p> <ul> <li>Matching books are displayed</li> </ul>"},{"location":"use-cases/#uc-27-export-books-and-data","title":"UC-2.7: Export Books and Data","text":"<p>Actors: Reader Priority: P0/P1 Requirements: FR-2.4, FR-2.5</p> <p>Description: User exports library data for backup or migration.</p> <p>Preconditions:</p> <ul> <li>User has books in library</li> </ul> <p>Main Flow:</p> <ol> <li>User navigates to Export</li> <li>User selects what to export (books, metadata, annotations)</li> <li>User chooses format (ZIP, JSON, CSV)</li> <li>System creates export file</li> <li>User downloads export</li> </ol> <p>Alternative Flows:</p> <p>A1: Selective export</p> <ul> <li>User selects specific books</li> <li>Only selected items exported</li> </ul> <p>A2: Export to cloud</p> <ul> <li>User chooses cloud destination</li> <li>File uploaded directly</li> </ul> <p>Postconditions:</p> <ul> <li>Export file is created</li> <li>User has backup of data</li> </ul>"},{"location":"use-cases/#uc-28-scan-isbn-barcode","title":"UC-2.8: Scan ISBN Barcode","text":"<p>Actors: Reader Priority: P2 Requirements: FR-2.12</p> <p>Description: User adds physical book by scanning barcode.</p> <p>Preconditions:</p> <ul> <li>Device has camera</li> <li>Physical book has ISBN barcode</li> </ul> <p>Main Flow:</p> <ol> <li>User selects \"Scan ISBN\"</li> <li>Camera opens</li> <li>User scans barcode</li> <li>System decodes ISBN</li> <li>System fetches metadata</li> <li>User reviews and confirms</li> <li>Book is added as physical</li> </ol> <p>Alternative Flows:</p> <p>A1: Manual ISBN entry</p> <ul> <li>If scan fails, user types ISBN</li> <li>System fetches metadata</li> </ul> <p>A2: No metadata found</p> <ul> <li>System shows \"Not found\"</li> <li>User can enter details manually</li> </ul> <p>Postconditions:</p> <ul> <li>Physical book added to library</li> </ul>"},{"location":"use-cases/#uc-29-track-physical-book","title":"UC-2.9: Track Physical Book","text":"<p>Actors: Reader Priority: P1 Requirements: FR-2.14</p> <p>Description: User manages physical books in library.</p> <p>Preconditions:</p> <ul> <li>None</li> </ul> <p>Main Flow:</p> <ol> <li>User selects \"Add physical book\"</li> <li>User enters book details</li> <li>User sets reading status</li> <li>User can add location (e.g., \"Shelf 3\")</li> <li>Book is added to library</li> </ol> <p>Alternative Flows:</p> <p>A1: Mark as lent</p> <ul> <li>User marks book as lent</li> <li>User enters borrower info</li> <li>Reminder can be set</li> </ul> <p>Postconditions:</p> <ul> <li>Physical book tracked in library</li> </ul>"},{"location":"use-cases/#3-reading-and-viewer-use-cases","title":"3. Reading and Viewer Use Cases","text":""},{"location":"use-cases/#uc-31-read-books-with-integrated-viewer","title":"UC-3.1: Read Books with Integrated Viewer","text":"<p>Actors: Reader, E-ink Reader Priority: P0 Requirements: FR-3.1</p> <p>Description: User reads e-books in the viewer.</p> <p>Preconditions:</p> <ul> <li>Book exists in library</li> <li>Book format is supported</li> </ul> <p>Main Flow:</p> <ol> <li>User opens book from library</li> <li>System loads book in viewer</li> <li>System restores last position</li> <li>User reads and navigates</li> <li>System saves progress automatically</li> </ol> <p>Alternative Flows:</p> <p>A1: Navigate via TOC</p> <ul> <li>User opens table of contents</li> <li>User selects chapter</li> </ul> <p>A2: Go to page/position</p> <ul> <li>User enters page number or percentage</li> <li>System jumps to position</li> </ul> <p>A3: E-ink mode</p> <ul> <li>System detects e-ink display</li> <li>UI adapts (no animations, high contrast)</li> </ul> <p>Postconditions:</p> <ul> <li>Reading position is saved</li> <li>Time tracked for statistics</li> </ul>"},{"location":"use-cases/#uc-32-customize-reading-experience","title":"UC-3.2: Customize Reading Experience","text":"<p>Actors: Reader, E-ink Reader Priority: P0 Requirements: FR-3.2</p> <p>Description: User personalizes viewer appearance.</p> <p>Preconditions:</p> <ul> <li>Book is open in viewer</li> </ul> <p>Main Flow:</p> <ol> <li>User opens reader settings</li> <li>User adjusts typography (font, size, spacing)</li> <li>User sets colors (background, text)</li> <li>User configures layout (margins, mode)</li> <li>Changes apply immediately</li> <li>Settings are saved</li> </ol> <p>Alternative Flows:</p> <p>A1: Quick theme switch</p> <ul> <li>User taps theme button</li> <li>Cycles through presets</li> </ul> <p>A2: E-ink optimized</p> <ul> <li>User enables e-ink mode</li> <li>High contrast, no animations</li> </ul> <p>Postconditions:</p> <ul> <li>Reader customized to preference</li> </ul>"},{"location":"use-cases/#uc-33-manage-reading-profiles","title":"UC-3.3: Manage Reading Profiles","text":"<p>Actors: Reader, E-ink Reader Priority: P1 Requirements: FR-3.3</p> <p>Description: User saves and switches reader configurations.</p> <p>Preconditions:</p> <ul> <li>Reader settings have been customized</li> </ul> <p>Main Flow:</p> <ol> <li>User opens profile management</li> <li>User creates new profile</li> <li>User names profile (e.g., \"Night reading\")</li> <li>Current settings saved to profile</li> <li>User can switch between profiles</li> </ol> <p>Alternative Flows:</p> <p>A1: Set default profile</p> <ul> <li>User marks profile as default</li> <li>Applied to new books</li> </ul> <p>A2: Export/import profiles</p> <ul> <li>User exports profile to file</li> <li>Can import on other devices</li> </ul> <p>Postconditions:</p> <ul> <li>Profiles saved for quick switching</li> </ul>"},{"location":"use-cases/#uc-34-manage-bookmarks","title":"UC-3.4: Manage Bookmarks","text":"<p>Actors: Reader Priority: P0 Requirements: FR-3.4</p> <p>Description: User creates and uses bookmarks.</p> <p>Preconditions:</p> <ul> <li>Book is open in viewer</li> </ul> <p>Main Flow:</p> <ol> <li>User taps bookmark button</li> <li>Bookmark created at current position</li> <li>User can add note (optional)</li> <li>Bookmark saved</li> </ol> <p>Alternative Flows:</p> <p>A1: View all bookmarks</p> <ul> <li>User opens bookmark panel</li> <li>Sees list with positions</li> <li>Taps to navigate</li> </ul> <p>A2: Delete bookmark</p> <ul> <li>User swipes or long-press</li> <li>Confirms deletion</li> </ul> <p>Postconditions:</p> <ul> <li>Bookmark saved and accessible</li> </ul>"},{"location":"use-cases/#4-annotations-and-notes-use-cases","title":"4. Annotations and Notes Use Cases","text":""},{"location":"use-cases/#uc-41-create-text-annotations","title":"UC-4.1: Create Text Annotations","text":"<p>Actors: Reader Priority: P0 Requirements: FR-4.1</p> <p>Description: User highlights text while reading.</p> <p>Preconditions:</p> <ul> <li>Book is open in viewer</li> </ul> <p>Main Flow:</p> <ol> <li>User selects text</li> <li>Context menu appears</li> <li>User chooses highlight color</li> <li>User adds note (optional)</li> <li>Annotation saved</li> </ol> <p>Alternative Flows:</p> <p>A1: Quick highlight</p> <ul> <li>User selects and taps color</li> <li>Instant highlight without menu</li> </ul> <p>Postconditions:</p> <ul> <li>Text is highlighted</li> <li>Annotation appears in panel</li> </ul>"},{"location":"use-cases/#uc-42-create-book-notes","title":"UC-4.2: Create Book Notes","text":"<p>Actors: Reader Priority: P0 Requirements: FR-4.2</p> <p>Description: User creates free-form notes for books.</p> <p>Preconditions:</p> <ul> <li>Book exists in library</li> </ul> <p>Main Flow:</p> <ol> <li>User opens book notes</li> <li>User creates new note</li> <li>User enters title and content</li> <li>Note saved</li> </ol> <p>Alternative Flows:</p> <p>A1: Rich text editing</p> <ul> <li>User uses formatting (bold, lists)</li> <li>Markdown syntax supported</li> </ul> <p>Postconditions:</p> <ul> <li>Note attached to book</li> </ul>"},{"location":"use-cases/#uc-43-manage-annotations","title":"UC-4.3: Manage Annotations","text":"<p>Actors: Reader Priority: P0 Requirements: FR-4.3</p> <p>Description: User edits or deletes annotations.</p> <p>Preconditions:</p> <ul> <li>Annotations exist for book</li> </ul> <p>Main Flow:</p> <ol> <li>User opens annotation panel</li> <li>User selects annotation</li> <li>User edits (color, note) or deletes</li> <li>Changes saved</li> </ol> <p>Postconditions:</p> <ul> <li>Annotations updated</li> </ul>"},{"location":"use-cases/#uc-44-export-annotations","title":"UC-4.4: Export Annotations","text":"<p>Actors: Reader Priority: P1 Requirements: FR-4.4</p> <p>Description: User exports annotations to file.</p> <p>Preconditions:</p> <ul> <li>Book has annotations</li> </ul> <p>Main Flow:</p> <ol> <li>User opens export options</li> <li>User selects format (Markdown, PDF, TXT)</li> <li>User configures options (include context, metadata)</li> <li>System generates export</li> <li>User downloads file</li> </ol> <p>Postconditions:</p> <ul> <li>Annotations exported to file</li> </ul>"},{"location":"use-cases/#uc-45-search-annotations","title":"UC-4.5: Search Annotations","text":"<p>Actors: Reader Priority: P1 Requirements: FR-4.5</p> <p>Description: User searches through annotations.</p> <p>Preconditions:</p> <ul> <li>User has annotations</li> </ul> <p>Main Flow:</p> <ol> <li>User opens annotation search</li> <li>User enters search query</li> <li>Results from all books shown</li> <li>User can filter by book, color, date</li> </ol> <p>Postconditions:</p> <ul> <li>Matching annotations displayed</li> </ul>"},{"location":"use-cases/#5-progress-tracking-use-cases","title":"5. Progress Tracking Use Cases","text":""},{"location":"use-cases/#uc-51-track-reading-progress","title":"UC-5.1: Track Reading Progress","text":"<p>Actors: Reader Priority: P0 Requirements: FR-5.1</p> <p>Description: System tracks and displays reading activity.</p> <p>Preconditions:</p> <ul> <li>User reads books in viewer</li> </ul> <p>Main Flow:</p> <ol> <li>System monitors reading sessions</li> <li>System records time and pages</li> <li>User views progress dashboard</li> <li>Statistics displayed (charts, metrics)</li> </ol> <p>Postconditions:</p> <ul> <li>Reading activity is tracked</li> <li>Statistics available</li> </ul>"},{"location":"use-cases/#uc-52-filter-progress-statistics","title":"UC-5.2: Filter Progress Statistics","text":"<p>Actors: Reader Priority: P1 Requirements: FR-5.2</p> <p>Description: User customizes statistics view.</p> <p>Preconditions:</p> <ul> <li>Reading data exists</li> </ul> <p>Main Flow:</p> <ol> <li>User opens statistics</li> <li>User selects time range</li> <li>User filters by books/shelves</li> <li>Filtered results displayed</li> </ol> <p>Postconditions:</p> <ul> <li>Statistics filtered to selection</li> </ul>"},{"location":"use-cases/#6-goal-management-use-cases","title":"6. Goal Management Use Cases","text":""},{"location":"use-cases/#uc-61-create-reading-goals","title":"UC-6.1: Create Reading Goals","text":"<p>Actors: Reader Priority: P1 Requirements: FR-6.1</p> <p>Description: User sets reading objectives.</p> <p>Preconditions:</p> <ul> <li>User wants to track goals</li> </ul> <p>Main Flow:</p> <ol> <li>User opens Goals</li> <li>User creates new goal</li> <li>User selects type (books, pages, time)</li> <li>User sets target and period</li> <li>Goal is saved and tracking begins</li> </ol> <p>Postconditions:</p> <ul> <li>Goal is active</li> <li>Progress tracked automatically</li> </ul>"},{"location":"use-cases/#uc-62-manage-goal-progress","title":"UC-6.2: Manage Goal Progress","text":"<p>Actors: Reader Priority: P1 Requirements: FR-6.2, FR-6.3</p> <p>Description: User and system update goal progress.</p> <p>Preconditions:</p> <ul> <li>Active goal exists</li> </ul> <p>Main Flow:</p> <ol> <li>System updates progress automatically</li> <li>User can manually adjust if needed</li> <li>Progress displayed with visualizations</li> <li>Notifications sent at milestones</li> </ol> <p>Postconditions:</p> <ul> <li>Goal progress is current</li> </ul>"},{"location":"use-cases/#7-storage-and-synchronization-use-cases","title":"7. Storage and Synchronization Use Cases","text":""},{"location":"use-cases/#uc-71-configure-storage-options","title":"UC-7.1: Configure Storage Options","text":"<p>Actors: Registered User, System Administrator Priority: P0 Requirements: FR-7.1, FR-7.1.1</p> <p>Description: User configures metadata server connection and file storage backend(s) for synchronization and book storage.</p> <p>Preconditions:</p> <ul> <li>Application is installed</li> <li>Internet connection available (for server configuration)</li> </ul> <p>Main Flow (Metadata Server):</p> <ol> <li>User opens Settings &gt; Sync &amp; Storage</li> <li>User selects metadata server option:</li> <li>Official hosted server (default)</li> <li>Self-hosted server (enter URL)</li> <li>User logs in or registers on metadata server</li> <li>System validates connection</li> <li>Sync capabilities are enabled</li> </ol> <p>Main Flow (File Storage Backend):</p> <ol> <li>User opens Settings &gt; Storage &gt; File Storage</li> <li>User clicks \"Add Storage Backend\"</li> <li>User selects backend type (Google Drive, WebDAV, MinIO, etc.)</li> <li>User configures credentials:</li> <li>OAuth flow for Google/OneDrive/Dropbox</li> <li>URL + credentials for WebDAV/MinIO</li> <li>System validates connection and shows storage info</li> <li>User sets backend as primary (optional)</li> <li>Backend is available for file storage</li> </ol> <p>Alternative Flows:</p> <p>A1: Cloud storage OAuth (Google Drive, OneDrive, Dropbox)</p> <ol> <li>User clicks \"Connect with [Provider]\"</li> <li>OAuth popup opens</li> <li>User authorizes Papyrus access</li> <li>System stores tokens securely</li> <li>Storage folder is created automatically</li> </ol> <p>A2: Self-hosted metadata server</p> <ol> <li>User enters server URL (e.g., https://papyrus.home.local)</li> <li>System tests connection and retrieves server info</li> <li>User registers or logs in on self-hosted server</li> <li>Connection is established</li> </ol> <p>A3: WebDAV server (Nextcloud, etc.)</p> <ol> <li>User enters WebDAV URL</li> <li>User enters username and password</li> <li>System tests connection</li> <li>User specifies folder path</li> </ol> <p>A4: MinIO/S3-compatible storage</p> <ol> <li>User enters endpoint URL</li> <li>User enters bucket name</li> <li>User enters access key and secret key</li> <li>System tests connection</li> </ol> <p>A5: Local-only mode (no sync)</p> <ol> <li>User skips metadata server setup</li> <li>User uses only local storage</li> <li>All data stored on device only</li> <li>No cross-device sync available</li> </ol> <p>A6: Dedicated Papyrus server for files</p> <ol> <li>User selects \"Papyrus Server\" as file storage</li> <li>Files stored on same server as metadata</li> <li>Single server handles everything</li> </ol> <p>Postconditions:</p> <ul> <li>Metadata server connected (optional)</li> <li>File storage backend(s) configured</li> <li>Cross-device sync enabled (if metadata server connected)</li> <li>Books can be uploaded to selected storage</li> </ul> <p>See Server Architecture for technical details.</p>"},{"location":"use-cases/#uc-72-process-scanned-documents","title":"UC-7.2: Process Scanned Documents","text":"<p>Actors: Reader Priority: P2 Requirements: FR-7.3</p> <p>Description: System applies OCR to scanned books.</p> <p>Preconditions:</p> <ul> <li>PDF with scanned images uploaded</li> </ul> <p>Main Flow:</p> <ol> <li>System detects scanned content</li> <li>System queues OCR processing</li> <li>OCR runs in background</li> <li>Text extracted and indexed</li> <li>User notified of completion</li> </ol> <p>Postconditions:</p> <ul> <li>Book content is searchable</li> </ul>"},{"location":"use-cases/#uc-73-synchronize-data-across-devices","title":"UC-7.3: Synchronize Data Across Devices","text":"<p>Actors: Registered User Priority: P0 Requirements: FR-5.3, NFR-2.1</p> <p>Description: System keeps metadata, reading progress, and annotations consistent across devices via the metadata server.</p> <p>Preconditions:</p> <ul> <li>User logged into metadata server on multiple devices</li> <li>At least one device has internet connection</li> </ul> <p>Main Flow:</p> <ol> <li>User makes changes on device A (e.g., reads pages, adds annotation)</li> <li>Changes are saved locally immediately</li> <li>Changes are queued in sync queue</li> <li>When online, client pushes changes to metadata server</li> <li>Metadata server records changes with timestamps</li> <li>Device B polls or receives push notification</li> <li>Device B fetches changes from metadata server</li> <li>Device B applies changes to local storage</li> <li>UI updates to reflect synchronized state</li> </ol> <p>Synchronized Data:</p> <ul> <li>Reading position (page, chapter, percentage)</li> <li>Annotations (highlights, notes)</li> <li>Bookmarks</li> <li>Book metadata edits</li> <li>Shelf and tag assignments</li> <li>Reading goals and progress</li> <li>Reading session statistics</li> </ul> <p>Alternative Flows:</p> <p>A1: Conflict detected (same book, both devices)</p> <ol> <li>System compares timestamps</li> <li>For reading position: latest timestamp wins</li> <li>For metadata: merge non-conflicting fields, latest wins for conflicts</li> <li>For annotations: keep both (no conflict, additive)</li> <li>User notified of resolved conflicts (optional)</li> </ol> <p>A2: Offline changes accumulated</p> <ol> <li>User works offline on device A</li> <li>Multiple changes queued locally</li> <li>When device comes online, all queued changes sync</li> <li>Server processes changes in timestamp order</li> </ol> <p>A3: Book file sync</p> <ol> <li>If book exists on server but not locally</li> <li>User can download for offline access</li> <li>File downloaded from configured storage backend</li> <li>Local reading position preserved after download</li> </ol> <p>A4: Metadata server unavailable</p> <ol> <li>Client detects connection failure</li> <li>UI shows \"Offline\" or \"Sync unavailable\" indicator</li> <li>All changes continue to be saved locally</li> <li>Sync resumes automatically when server available</li> </ol> <p>Postconditions:</p> <ul> <li>All devices have consistent metadata</li> <li>Reading position synchronized</li> <li>Annotations available on all devices</li> </ul> <p>See Server Architecture for sync details.</p>"},{"location":"use-cases/#uc-74-browse-opds-catalog","title":"UC-7.4: Browse OPDS Catalog","text":"<p>Actors: Reader Priority: P2 Requirements: FR-7.5</p> <p>Description: User downloads books from online catalogs.</p> <p>Preconditions:</p> <ul> <li>OPDS catalog URL known</li> <li>Internet connection available</li> </ul> <p>Main Flow:</p> <ol> <li>User adds OPDS catalog URL</li> <li>System loads catalog</li> <li>User browses or searches</li> <li>User selects book to download</li> <li>Book added to library</li> </ol> <p>Alternative Flows:</p> <p>A1: Protected catalog</p> <ul> <li>User enters credentials</li> <li>System authenticates</li> </ul> <p>Postconditions:</p> <ul> <li>Book downloaded to library</li> </ul>"},{"location":"use-cases/#use-case-summary","title":"Use Case Summary","text":""},{"location":"use-cases/#by-priority","title":"By Priority","text":"Priority Use Cases Description P0 UC-1.1, UC-1.2, UC-1.4, UC-2.1, UC-2.3, UC-2.4, UC-2.5, UC-2.6, UC-2.7, UC-3.1, UC-3.2, UC-3.4, UC-4.1, UC-4.2, UC-4.3, UC-5.1, UC-7.1, UC-7.3 MVP critical P1 UC-1.3, UC-1.5, UC-1.6, UC-2.9, UC-3.3, UC-4.4, UC-4.5, UC-5.2, UC-6.1, UC-6.2 MVP high priority P2 UC-2.2, UC-2.8, UC-7.2, UC-7.4 Post-MVP"},{"location":"use-cases/#by-actor","title":"By Actor","text":"Actor Primary Use Cases Anonymous User UC-1.4 Registered User UC-1.1, UC-1.2, UC-1.3, UC-1.5, UC-1.6, UC-7.1, UC-7.3 Reader UC-2.x, UC-3.x, UC-4.x, UC-5.x, UC-6.x E-ink Reader UC-3.1, UC-3.2, UC-3.3 System Administrator UC-7.1"},{"location":"user-interface/","title":"User Interface","text":"<p>This section outlines the user interface design principles, layout patterns, and key screen specifications for the Papyrus cross-platform book management system. The design follows Material 3 guidelines while maintaining consistency across all supported platforms, with special considerations for e-ink devices.</p>"},{"location":"user-interface/#design-principles","title":"Design Principles","text":""},{"location":"user-interface/#material-3-foundation","title":"Material 3 Foundation","text":"<ul> <li>Modern, clean design based on Material 3 design system</li> <li>Adaptive color schemes with dynamic theming support</li> <li>Consistent typography and spacing throughout the application</li> <li>Platform-specific adaptations while maintaining core design language</li> </ul>"},{"location":"user-interface/#cross-platform-consistency","title":"Cross-Platform Consistency","text":"<ul> <li>Unified experience across Android, iOS, Web, Desktop, and E-ink platforms</li> <li>Responsive layouts that adapt to different screen sizes and orientations</li> <li>Consistent navigation patterns and interaction behaviors</li> <li>Platform-appropriate UI elements while maintaining brand identity</li> </ul>"},{"location":"user-interface/#e-ink-first-design","title":"E-ink First Design","text":"<p>For e-ink devices, the design prioritizes:</p> <ul> <li>High contrast: Pure black on white (or inverse) for maximum readability</li> <li>No animations: Static UI transitions to avoid ghosting artifacts</li> <li>Reduced refresh: Minimize screen updates to improve battery life and reduce flicker</li> <li>Larger touch targets: Accommodate slower touch response on e-ink screens</li> <li>Hardware button support: Navigation via physical buttons when available</li> </ul>"},{"location":"user-interface/#accessibility","title":"Accessibility","text":"<ul> <li>High contrast color options for better readability</li> <li>Scalable text and UI elements</li> <li>Keyboard navigation support for desktop platforms</li> <li>Screen reader compatibility</li> <li>Color-blind friendly design choices</li> <li>E-ink optimized modes with maximum contrast</li> </ul>"},{"location":"user-interface/#user-centric-design","title":"User-Centric Design","text":"<ul> <li>Intuitive navigation with minimal learning curve</li> <li>Contextual actions and smart defaults</li> <li>Customizable interface elements based on user preferences</li> <li>Efficient workflows for common tasks</li> </ul>"},{"location":"user-interface/#information-architecture","title":"Information Architecture","text":""},{"location":"user-interface/#primary-navigation-structure","title":"Primary Navigation Structure","text":"<pre><code>Home / Library\n\u251c\u2500\u2500 All Books\n\u251c\u2500\u2500 Shelves\n\u2502   \u251c\u2500\u2500 Currently Reading\n\u2502   \u251c\u2500\u2500 Planning to Read\n\u2502   \u251c\u2500\u2500 Completed\n\u2502   \u2514\u2500\u2500 Custom Shelves\n\u251c\u2500\u2500 Series\n\u251c\u2500\u2500 Tags\n\u251c\u2500\u2500 Search &amp; Filters\n\u2514\u2500\u2500 Recently Added\n\nReader\n\u251c\u2500\u2500 Book Content\n\u251c\u2500\u2500 Table of Contents\n\u251c\u2500\u2500 Annotations &amp; Notes\n\u251c\u2500\u2500 Bookmarks\n\u251c\u2500\u2500 Reading Settings\n\u2514\u2500\u2500 Progress Information\n\nProgress &amp; Goals\n\u251c\u2500\u2500 Reading Statistics\n\u251c\u2500\u2500 Active Goals\n\u251c\u2500\u2500 Progress Charts\n\u2514\u2500\u2500 Reading History\n\nSettings\n\u251c\u2500\u2500 Account Management\n\u251c\u2500\u2500 Reading Preferences\n\u251c\u2500\u2500 Storage Configuration\n\u251c\u2500\u2500 Synchronization\n\u251c\u2500\u2500 Import / Export\n\u251c\u2500\u2500 E-ink Mode Settings\n\u2514\u2500\u2500 About\n</code></pre>"},{"location":"user-interface/#key-screen-specifications","title":"Key Screen Specifications","text":""},{"location":"user-interface/#1-libraryhome-screen","title":"1. Library/Home Screen","text":"<p>Purpose: Primary entry point showing user's book collection</p> <p>Layout Components:</p> <ul> <li>Header bar: App logo, search icon, user profile menu</li> <li>Navigation tabs: All Books, Shelves, Series, Tags, Search</li> <li>Filter bar: Quick filters (reading status, format, recently added)</li> <li>Book grid/list: Configurable view with cover thumbnails</li> <li>Floating action button: Add new book</li> <li>Bottom navigation: Library, Reader, Progress, Settings (mobile)</li> </ul> <p>Responsive Behavior:</p> <ul> <li>Desktop: Sidebar navigation with main content area</li> <li>Tablet: Adaptive grid layout with 3-4 columns</li> <li>Mobile: Single column list with compact view option</li> <li>E-ink: High-contrast list view with larger text and touch targets</li> </ul> <p>Key Interactions:</p> <ul> <li>Tap book cover to open in reader</li> <li>Long press for context menu (add to shelf, edit, delete)</li> <li>Swipe gestures for quick actions (mark as read, favorite) - disabled on e-ink</li> <li>Search with auto-complete and recent searches</li> </ul>"},{"location":"user-interface/#2-book-reader-screen","title":"2. Book Reader Screen","text":"<p>Purpose: Immersive reading experience with customization options</p> <p>Layout Components:</p> <ul> <li>Reading area: Full-screen book content with minimal UI</li> <li>Top toolbar: Back button, book title, reading settings (auto-hide)</li> <li>Bottom toolbar: Progress bar, page indicators, navigation controls</li> <li>Side panels: Table of contents, annotations, notes, bookmarks (collapsible)</li> <li>Reading settings overlay: Font, spacing, colors, theme options</li> <li>Annotation tools: Highlight colors, note creation, bookmark</li> </ul> <p>Adaptive Features:</p> <ul> <li>Automatic day/night theme switching (disabled on e-ink)</li> <li>Reading profiles for different contexts (indoor/outdoor, device type)</li> <li>Gesture-based navigation (tap zones, swipe for pages)</li> <li>Adjustable UI element visibility and timing</li> <li>E-ink mode with page-turn only refresh</li> </ul> <p>Customization Options:</p> <ul> <li>Font family, size, weight selection</li> <li>Line height and letter spacing adjustments</li> <li>Margin and padding controls</li> <li>Background and text color customization</li> <li>Reading mode (paginated vs. continuous scroll)</li> <li>Column layout for wide screens</li> <li>E-ink refresh mode (full page, partial, fast)</li> </ul> <p>E-ink Reader Optimizations:</p> <ul> <li>Full page refresh option to clear ghosting</li> <li>Hardware button mapping for page turns</li> <li>Reduced UI chrome for maximum reading area</li> <li>High contrast text rendering</li> <li>Optional inverted mode (white text on black)</li> </ul>"},{"location":"user-interface/#3-book-details-screen","title":"3. Book Details Screen","text":"<p>Purpose: Comprehensive book information and management</p> <p>Layout Components:</p> <ul> <li>Header: Book cover, title, author, rating</li> <li>Metadata section: Publication info, ISBN, page count, format</li> <li>Description: Expandable book summary</li> <li>Action buttons: Read, add to shelf, mark as favorite, edit</li> <li>Progress section: Reading status, current position, time spent</li> <li>Notes and annotations: Quick access to user content</li> <li>Series information: Series name, book number, other books in series</li> <li>Related information: Author's other works, similar books</li> </ul> <p>Management Features:</p> <ul> <li>Metadata editing with form validation</li> <li>Tag assignment with color coding</li> <li>Shelf management with multiple selection</li> <li>Series assignment and ordering</li> <li>Export options (book file, metadata, notes)</li> <li>Delete confirmation with data preservation options</li> </ul>"},{"location":"user-interface/#4-search-and-discovery-screen","title":"4. Search and Discovery Screen","text":"<p>Purpose: Advanced book finding and filtering capabilities</p> <p>Layout Components:</p> <ul> <li>Search bar: Text input with voice search option (voice disabled on e-ink)</li> <li>Filter chips: Quick access to common filters</li> <li>Advanced filters panel: Detailed filtering options</li> <li>Results area: Filtered book grid with sort options</li> <li>Search suggestions: Recent searches, popular tags, saved filters</li> </ul> <p>Search Capabilities:</p> <ul> <li>Full-text search across book content (where supported)</li> <li>Metadata search (title, author, ISBN, description)</li> <li>Tag and shelf filtering</li> <li>Series filtering</li> <li>Complex query language support</li> <li>Saved search patterns</li> <li>Search history and suggestions</li> </ul> <p>Filter Options:</p> <ul> <li>Reading status (not started, in progress, completed)</li> <li>Book format (EPUB, PDF, physical, etc.)</li> <li>Date added ranges</li> <li>Publication date ranges</li> <li>Rating and favorite status</li> <li>File size and page count ranges</li> <li>Series membership</li> <li>Custom metadata fields</li> </ul>"},{"location":"user-interface/#5-progress-and-statistics-screen","title":"5. Progress and Statistics Screen","text":"<p>Purpose: Reading analytics and goal tracking</p> <p>Layout Components:</p> <ul> <li>Summary cards: Books read, time spent, current streak</li> <li>Charts area: Reading progress visualizations</li> <li>Goals section: Active goals with progress indicators</li> <li>Time filters: Week, month, year, custom range selectors</li> <li>Achievement badges: Reading milestones and accomplishments</li> <li>Detailed statistics: Books by genre, reading speed, completion rates</li> </ul> <p>Visualization Types:</p> <ul> <li>Reading time trends (line charts)</li> <li>Books completed over time (bar charts)</li> <li>Reading distribution by day/hour (heat maps)</li> <li>Genre preferences (pie charts)</li> <li>Goal progress indicators (progress bars, circular indicators)</li> </ul> <p>E-ink Adaptations:</p> <ul> <li>Static, high-contrast charts without animations</li> <li>Simplified visualizations with clear labels</li> <li>Text-based statistics as primary, charts as secondary</li> <li>Manual refresh button for updated data</li> </ul>"},{"location":"user-interface/#6-settings-and-preferences-screen","title":"6. Settings and Preferences Screen","text":"<p>Purpose: Application configuration and user account management</p> <p>Layout Organization:</p> <ul> <li>Account section: Profile info, authentication, data sync</li> <li>Reading preferences: Default reader settings, profiles</li> <li>Storage configuration: File storage backends, sync settings</li> <li>Display settings: Theme, font size, e-ink mode toggle</li> <li>Import/Export: Data migration and backup options</li> <li>Notifications: Goal reminders, sync status, updates</li> <li>About: Version info, licenses, support contact</li> </ul> <p>Key Configuration Areas:</p> <ul> <li>Reading profile management with import/export</li> <li>Storage backend selection and configuration</li> <li>Synchronization preferences and conflict resolution</li> <li>Data export formats and destinations</li> <li>Privacy settings and data retention policies</li> <li>E-ink mode settings and optimizations</li> </ul>"},{"location":"user-interface/#platform-specific-adaptations","title":"Platform-Specific Adaptations","text":""},{"location":"user-interface/#desktop-windows-macos-linux","title":"Desktop (Windows, macOS, Linux)","text":"<ul> <li>Window management: Resizable windows with minimum size constraints</li> <li>Keyboard shortcuts: Full keyboard navigation and shortcuts</li> <li>Menu bar: Native menu integration with platform conventions</li> <li>File management: Drag-and-drop support for book imports</li> <li>Multi-window: Optional separate reader windows</li> </ul>"},{"location":"user-interface/#mobile-android-ios","title":"Mobile (Android, iOS)","text":"<ul> <li>Touch optimization: Large touch targets, gesture navigation</li> <li>Status bar integration: Adaptive status bar colors</li> <li>Notification support: Reading reminders, sync status</li> <li>Share integration: Share books and notes with other apps</li> <li>Background sync: Offline reading with background synchronization</li> </ul>"},{"location":"user-interface/#web-browser","title":"Web Browser","text":"<ul> <li>Responsive design: Adaptive layouts for various screen sizes</li> <li>Progressive web app: Offline functionality and app-like experience</li> <li>File upload: Web-based book import with drag-and-drop</li> <li>Cross-browser compatibility: Support for modern browsers</li> <li>Bookmark integration: Browser bookmark sync for reading positions</li> </ul>"},{"location":"user-interface/#e-ink-devices","title":"E-ink Devices","text":"<p>E-ink devices require special UI considerations due to their unique display characteristics:</p> <p>Display Optimizations:</p> <ul> <li>No animations: All transitions are instant cuts, no fades or slides</li> <li>Minimal refresh: UI updates batched to reduce screen flicker</li> <li>Full page refresh: Optional periodic full refresh to clear ghosting</li> <li>High contrast: Pure black (#000000) and white (#FFFFFF) only</li> <li>Sharp edges: No anti-aliasing on UI elements for crisp rendering</li> </ul> <p>Navigation:</p> <ul> <li>Hardware buttons: Page turn buttons mapped to forward/back navigation</li> <li>Larger touch targets: Minimum 56px touch areas (vs 44px on other platforms)</li> <li>Simplified menus: Reduced nesting, more items per screen</li> <li>Confirmation dialogs: Extra confirmation for destructive actions (slower to undo)</li> </ul> <p>Reader Specific:</p> <ul> <li>Page-based reading: Pagination preferred over scrolling</li> <li>Refresh modes:</li> <li>Full refresh: Complete screen update, clearest but slowest</li> <li>Partial refresh: Updates changed areas only, faster but may ghost</li> <li>Fast refresh: Optimized for page turns, some quality trade-off</li> <li>Contrast adjustment: Fine-tune text darkness for different e-ink panels</li> <li>Font optimization: Use fonts optimized for e-ink (e.g., Bookerly, Literata)</li> </ul> <p>Performance:</p> <ul> <li>Lazy loading: Load content only when needed</li> <li>Reduced imagery: Downscale or hide decorative images</li> <li>Battery optimization: Minimize background activity</li> <li>Offline first: Assume intermittent connectivity</li> </ul>"},{"location":"user-interface/#color-scheme-and-theming","title":"Color Scheme and Theming","text":"<p>The application uses Material 3 design system with custom color schemes optimized for reading applications.</p>"},{"location":"user-interface/#light-theme-default","title":"Light Theme (Default)","text":"<p>Based on Material 3 light color scheme with purple primary colors:</p> Role Color Hex Usage Primary Purple #5654A8 Main brand color for buttons, links, key UI elements Primary Container Light Purple #E2DFFF Backgrounds for primary actions Secondary Dark Purple-Gray #5D5C71 Secondary buttons and text Secondary Container Light Gray-Purple #E3E0F9 Secondary backgrounds Surface Pure White #FFFBFF Main content backgrounds Surface Container Light Gray #E4E1EC Card and container backgrounds On Surface Dark Gray #1C1B1F Primary text color On Surface Variant Medium Gray #47464F Secondary text color Outline Medium Gray #787680 Borders and dividers"},{"location":"user-interface/#dark-theme","title":"Dark Theme","text":"<p>Optimized dark color scheme for comfortable night reading:</p> Role Color Hex Usage Primary Light Purple #C3C0FF Adjusted for dark backgrounds Primary Container Dark Purple #3E3C8F Primary action backgrounds Secondary Light Purple-Gray #C7C4DD Secondary elements Secondary Container Dark Gray #464559 Secondary backgrounds Surface Very Dark Gray #1C1B1F Main content backgrounds Surface Container Medium Dark Gray #47464F Card backgrounds On Surface Light Gray #E5E1E6 Primary text color On Surface Variant Medium Light Gray #C8C5D0 Secondary text color Outline Gray #928F9A Borders and dividers"},{"location":"user-interface/#e-ink-theme","title":"E-ink Theme","text":"<p>Maximum contrast theme optimized for e-ink displays:</p> Role Color Hex Usage Primary Black #000000 All interactive elements Primary Container Light Gray #E0E0E0 Button backgrounds Secondary Dark Gray #404040 Secondary text Secondary Container Light Gray #F0F0F0 Card backgrounds Surface White #FFFFFF Main backgrounds Surface Container Off White #F5F5F5 Elevated surfaces On Surface Black #000000 Primary text On Surface Variant Dark Gray #606060 Secondary text Outline Black #000000 Borders (2px minimum) Inverse Surface Black #000000 Inverted mode background Inverse On Surface White #FFFFFF Inverted mode text <p>E-ink Theme Characteristics:</p> <ul> <li>No gradients or shadows</li> <li>2px minimum border width for visibility</li> <li>Bold font weights preferred</li> <li>No transparency or alpha blending</li> <li>Icons use solid fills, not outlines</li> </ul>"},{"location":"user-interface/#sepia-theme-reading","title":"Sepia Theme (Reading)","text":"<p>Warm-toned theme for extended reading sessions:</p> Role Color Hex Usage Surface Cream #FDF6E3 Reading background On Surface Dark Brown #5C4A32 Text color Primary Brown #8B7355 Links and accents"},{"location":"user-interface/#reading-specific-color-considerations","title":"Reading-Specific Color Considerations","text":"<ul> <li>Error colors: Red tones (#BA1A1A light, #FFB4AB dark) for validation and warnings</li> <li>Tertiary colors: Pink-purple accent (#7A5368 light, #EAB9D2 dark) for special highlights</li> <li>Shadow and scrim: Pure black (#000000) for depth and overlays</li> <li>Inverse colors: Automatically calculated contrasting colors for accessibility</li> </ul>"},{"location":"user-interface/#dynamic-theming-features","title":"Dynamic Theming Features","text":"<ul> <li>System integration: Automatic theme switching based on system preferences</li> <li>Material You support: Dynamic color generation from wallpaper (Android 12+)</li> <li>Time-based switching: Optional automatic day/night theme changes</li> <li>Reading profiles: Theme preferences saved per reading profile</li> <li>Custom accent colors: User-customizable accent colors while maintaining accessibility</li> <li>E-ink auto-detection: Automatic switch to e-ink theme on compatible devices</li> </ul>"},{"location":"user-interface/#responsive-design-breakpoints","title":"Responsive Design Breakpoints","text":""},{"location":"user-interface/#breakpoint-definitions","title":"Breakpoint Definitions","text":"Breakpoint Width Layout Navigation Mobile 0-599px Single column Bottom tabs Tablet 600-839px Adaptive grid Side navigation option Desktop Small 840-1199px Sidebar + multi-column Sidebar navigation Desktop Large 1200px+ Multiple panels Sidebar navigation E-ink Any Simplified single column Tab bar or hardware buttons"},{"location":"user-interface/#layout-adaptations","title":"Layout Adaptations","text":"Element Mobile Tablet Desktop E-ink Navigation Bottom tabs Side nav Sidebar Top tabs + buttons Content Grid 1 column 2-3 columns 4+ columns 1-2 columns Reader Full screen Centered Centered + margins Full screen Panels Overlay Side panels Side panels Full screen overlay Touch Targets 44px 44px 36px 56px Font Size 16px base 16px base 14px base 18px base"},{"location":"user-interface/#e-ink-specific-layout-rules","title":"E-ink Specific Layout Rules","text":"<ul> <li>Maximum content width: 600px (typical e-reader width)</li> <li>Minimum touch target: 56px \u00d7 56px</li> <li>Line height: 1.5 minimum for readability</li> <li>Paragraph spacing: 1em minimum</li> <li>Button padding: 16px minimum</li> <li>Border width: 2px minimum for visibility</li> </ul>"},{"location":"user-interface/#accessibility-features","title":"Accessibility Features","text":""},{"location":"user-interface/#visual-accessibility","title":"Visual Accessibility","text":"<ul> <li>High contrast modes: Enhanced contrast ratios for better visibility</li> <li>Font scaling: Support for system font size preferences (up to 200%)</li> <li>Color indicators: Non-color-dependent status indicators</li> <li>Focus indicators: Clear focus states for keyboard navigation</li> <li>E-ink compatibility: Full functionality in grayscale</li> </ul>"},{"location":"user-interface/#motor-accessibility","title":"Motor Accessibility","text":"<ul> <li>Touch targets: Minimum 44px touch targets (56px on e-ink)</li> <li>Gesture alternatives: Tap alternatives for all swipe gestures</li> <li>Keyboard navigation: Full keyboard accessibility for desktop</li> <li>Voice control: Voice command support where available</li> <li>Hardware button support: Physical button navigation on supported devices</li> </ul>"},{"location":"user-interface/#cognitive-accessibility","title":"Cognitive Accessibility","text":"<ul> <li>Simple navigation: Clear, consistent navigation patterns</li> <li>Help tooltips: Contextual help for complex features</li> <li>Undo actions: Easy reversal of accidental actions</li> <li>Progress indicators: Clear feedback for long-running operations</li> <li>Confirmation dialogs: Explicit confirmation for destructive actions</li> </ul>"},{"location":"user-interface/#e-ink-accessibility-considerations","title":"E-ink Accessibility Considerations","text":"<ul> <li>Slow refresh accommodation: Extra time for users to read before screen updates</li> <li>Clear state indication: Obvious visual feedback for selected/active states</li> <li>Reduced cognitive load: Simplified screens with essential information only</li> <li>Consistent layout: Predictable element positioning across screens</li> <li>Text-first design: Information conveyed through text, not color or icons alone</li> </ul>"},{"location":"user-interface/#component-library","title":"Component Library","text":""},{"location":"user-interface/#button-variants","title":"Button Variants","text":"Variant Standard E-ink Primary Filled with brand color Black fill, white text Secondary Outlined 2px black border Tertiary Text only Underlined text Disabled 50% opacity Gray fill, no interaction"},{"location":"user-interface/#form-elements","title":"Form Elements","text":"Element Standard E-ink Text Input 1px border, focus ring 2px border, bold on focus Checkbox Filled square 2px border checkbox, X mark Radio Filled circle 2px border circle, filled dot Toggle Animated switch Static on/off states Dropdown Animated expand Full screen picker"},{"location":"user-interface/#feedback-components","title":"Feedback Components","text":"Component Standard E-ink Loading Spinner animation \"Loading...\" text Progress Animated bar Segmented bar (static) Toast Fade in/out Full width banner Dialog Fade + scale Instant overlay Snackbar Slide up Top banner <p>This user interface specification provides a comprehensive framework for developing a modern, accessible, and user-friendly book management application that works seamlessly across all target platforms\u2014including e-ink devices\u2014while maintaining the clean, Material 3-inspired design aesthetic.</p>"},{"location":"external/","title":"External Resources","text":"<p>This section contains links to external resources, references, and supporting documentation.</p>"},{"location":"external/#design-resources","title":"Design Resources","text":"<ul> <li>Figma Prototype - UI/UX design mockups</li> <li>Material 3 Design System - Design guidelines</li> </ul>"},{"location":"external/#technical-references","title":"Technical References","text":"<ul> <li>Flutter Documentation - Official Flutter docs</li> <li>FastAPI Documentation - Backend framework docs</li> <li>PostgreSQL Documentation - Database docs</li> </ul>"},{"location":"external/#standards-specifications","title":"Standards &amp; Specifications","text":"<ul> <li>EPUB 3.3 Specification - E-book format standard</li> <li>OPDS Catalog 1.2 - Open Publication Distribution System</li> </ul>"},{"location":"external/#community","title":"Community","text":"<ul> <li>GitHub Repository - Source code and issue tracking</li> <li>Discord Server - Community discussions</li> </ul>"},{"location":"requirements/","title":"Requirements Overview","text":"<p>This section provides an overview of the requirements specification for Papyrus, including the structure, notation, and traceability between requirements, use cases, and entities.</p>"},{"location":"requirements/#document-structure","title":"Document Structure","text":"Document Purpose Functional Requirements What the system does Non-Functional Requirements How the system performs"},{"location":"requirements/#requirement-notation","title":"Requirement Notation","text":""},{"location":"requirements/#identifiers","title":"Identifiers","text":"Pattern Meaning Example FR-X.Y Functional Requirement FR-2.1 (Format Conversion) NFR-X.Y Non-Functional Requirement NFR-4.1 (Startup Time) UC-X.Y Use Case UC-2.1 (Import Books)"},{"location":"requirements/#priority-levels","title":"Priority Levels","text":"Priority Label MVP Target Description P0 Critical v1.0 Must have - core functionality P1 High v1.0 Should have - important for launch P2 Medium v1.x Nice to have - post-MVP planned P3 Low v2.x+ Future - not yet planned"},{"location":"requirements/#requirement-categories","title":"Requirement Categories","text":""},{"location":"requirements/#functional-requirements-fr","title":"Functional Requirements (FR)","text":"Category ID Range Count Description User Management FR-1.x 6 Account, auth, offline mode Book Management FR-2.x 14 Import, organize, search Integrated Viewer FR-3.x 4 Reading, customization, profiles Annotations &amp; Notes FR-4.x 5 Highlights, notes, export Progress Tracking FR-5.x 3 Statistics, sync Goal Management FR-6.x 4 Goals, progress, notifications Storage &amp; Sync FR-7.x 6 Metadata server, file storage backends, OPDS Total 42"},{"location":"requirements/#non-functional-requirements-nfr","title":"Non-Functional Requirements (NFR)","text":"Category ID Range Count Description Storage NFR-1.x 4 File size, backends, encryption Synchronization NFR-2.x 4 Offline, conflicts, performance Platform Support NFR-3.x 4 Web, desktop, mobile, e-ink Performance NFR-4.x 5 Startup, open, search, scale Usability NFR-5.x 5 Design, accessibility, i18n Security NFR-6.x 5 Auth, encryption, privacy Reliability NFR-7.x 4 Uptime, integrity, backup Extensibility NFR-8.x 1 Plugin architecture Maintainability NFR-9.x 2 Code quality, logging Total 34"},{"location":"requirements/#mvp-scope-summary","title":"MVP Scope Summary","text":""},{"location":"requirements/#p0-requirements-must-have","title":"P0 Requirements (Must Have)","text":"Category Requirements User Management FR-1.1, FR-1.2, FR-1.4 Book Management FR-2.2, FR-2.4, FR-2.6, FR-2.8, FR-2.9, FR-2.10 Viewer FR-3.1, FR-3.2, FR-3.4 Annotations FR-4.1, FR-4.2, FR-4.3 Progress FR-5.1, FR-5.3 Storage FR-7.1, FR-7.1.1, FR-7.2 Platform NFR-3.1, NFR-3.2, NFR-3.3 Performance NFR-4.1, NFR-4.2, NFR-4.3 Sync NFR-2.1, NFR-2.2, NFR-2.4 Security NFR-6.1, NFR-6.2, NFR-6.4, NFR-6.5 Reliability NFR-7.2, NFR-7.3 Usability NFR-5.1, NFR-5.2 <p>Total P0: 18 FR + 17 NFR = 35 requirements</p>"},{"location":"requirements/#p1-requirements-should-have","title":"P1 Requirements (Should Have)","text":"Category Requirements User Management FR-1.3, FR-1.5, FR-1.6 Book Management FR-2.5, FR-2.7, FR-2.13, FR-2.14 Viewer FR-3.3 Annotations FR-4.4, FR-4.5 Progress FR-5.2 Goals FR-6.1, FR-6.2, FR-6.3 Platform NFR-3.4 Performance NFR-4.4, NFR-4.5 Sync NFR-2.3 Storage NFR-1.3 Usability NFR-5.3, NFR-5.4, NFR-5.5 Reliability NFR-7.1, NFR-7.4 Maintainability NFR-9.1, NFR-9.2 <p>Total P1: 16 FR + 12 NFR = 28 requirements</p>"},{"location":"requirements/#traceability-matrix","title":"Traceability Matrix","text":""},{"location":"requirements/#requirements-to-use-cases","title":"Requirements to Use Cases","text":"FR Use Case Description FR-1.1 UC-1.1 Account registration FR-1.2 UC-1.2 Login with credentials FR-1.3 UC-1.3 OAuth login FR-1.4 UC-1.4 Offline mode FR-1.5 UC-1.5 Password recovery FR-1.6 UC-1.6 Account deletion FR-2.1 UC-2.2 Format conversion FR-2.2, FR-2.13 UC-2.3 Metadata editing FR-2.4, FR-2.5 UC-2.7 Export FR-2.6, FR-7.2 UC-2.1 Import FR-2.7, FR-2.8, FR-2.11 UC-2.6 Search FR-2.9 UC-2.4 Shelves FR-2.10 UC-2.5 Tags FR-2.12 UC-2.8 ISBN scanning FR-2.14 UC-2.9 Physical books FR-3.1 UC-3.1 Reading FR-3.2 UC-3.2 Reader customization FR-3.3 UC-3.3 Reading profiles FR-3.4 UC-3.4 Bookmarks FR-4.1 UC-4.1 Annotations FR-4.2 UC-4.2 Notes FR-4.3 UC-4.3 Annotation management FR-4.4 UC-4.4 Annotation export FR-4.5 UC-4.5 Annotation search FR-5.1 UC-5.1 Progress tracking FR-5.2 UC-5.2 Statistics filtering FR-5.3 UC-7.3 Cross-device sync FR-6.1 UC-6.1 Create goals FR-6.2, FR-6.3 UC-6.2 Goal progress FR-7.1 UC-7.1 File storage backend selection FR-7.1.1 UC-7.1 Metadata server configuration FR-7.3 UC-7.2 OCR processing FR-7.5 UC-7.4 OPDS browsing"},{"location":"requirements/#requirements-to-entities","title":"Requirements to Entities","text":"FR Primary Entities FR-1.x User FR-2.x Book, Shelf, Tag, Series FR-3.x Book, ReadingProfile, Bookmark FR-4.x Annotation, Note FR-5.x ReadingSession, Book FR-6.x ReadingGoal FR-7.x StorageConfig, FileStorageBackend, SavedFilter"},{"location":"requirements/#core-principles","title":"Core Principles","text":"<p>The requirements reflect these core principles:</p>"},{"location":"requirements/#1-user-data-ownership","title":"1. User Data Ownership","text":"<ul> <li>All data exportable in open formats</li> <li>No vendor lock-in</li> <li>Self-hosting option available</li> </ul>"},{"location":"requirements/#2-cross-platform-accessibility","title":"2. Cross-Platform Accessibility","text":"<ul> <li>Consistent experience across all devices</li> <li>E-ink devices as first-class citizens</li> <li>Progressive Web App support</li> </ul>"},{"location":"requirements/#3-offline-functionality","title":"3. Offline Functionality","text":"<ul> <li>Full feature parity offline</li> <li>Sync when connected</li> <li>No account required for basic use</li> </ul>"},{"location":"requirements/#4-privacy-first","title":"4. Privacy First","text":"<ul> <li>No default analytics</li> <li>Opt-in telemetry only</li> <li>Local-first architecture</li> </ul>"},{"location":"requirements/#5-developer-friendly","title":"5. Developer Friendly","text":"<ul> <li>Open source</li> <li>Public REST API</li> <li>Plugin extensibility</li> </ul>"},{"location":"requirements/#related-documents","title":"Related Documents","text":"<ul> <li>Functional Requirements</li> <li>Non-Functional Requirements</li> <li>Use Cases</li> <li>Entities</li> <li>Database Model</li> <li>Server Architecture</li> </ul>"},{"location":"requirements/functional-requirements/","title":"Functional Requirements","text":"<p>This document defines the functional requirements for Papyrus, organized by feature area. Each requirement includes a priority level and references to related use cases.</p>"},{"location":"requirements/functional-requirements/#priority-levels","title":"Priority Levels","text":"Priority Description Target P0 Critical - Must have for MVP v1.0 P1 High - Should have for MVP v1.0 P2 Medium - Post-MVP planned feature v1.x P3 Low - Future consideration v2.x+"},{"location":"requirements/functional-requirements/#1-user-management","title":"1. User Management","text":""},{"location":"requirements/functional-requirements/#fr-11-account-registration","title":"FR-1.1: Account Registration","text":"<p>Priority: P0 | Use Case: UC-1.1</p> <p>User can create an account using an email address and password.</p> <p>Acceptance Criteria:</p> <ul> <li>Email must be valid and unique in the system</li> <li>Password must meet minimum security requirements (8+ characters, mixed case, number)</li> <li>Email verification is sent upon registration</li> <li>Account is created in inactive state until email is verified</li> </ul>"},{"location":"requirements/functional-requirements/#fr-12-emailpassword-login","title":"FR-1.2: Email/Password Login","text":"<p>Priority: P0 | Use Case: UC-1.2</p> <p>User can log in to the system using email and password.</p> <p>Acceptance Criteria:</p> <ul> <li>System validates credentials against stored hash</li> <li>Failed attempts are rate-limited (max 5 per minute)</li> <li>Successful login creates a secure session token</li> <li>User is redirected to their library after login</li> </ul>"},{"location":"requirements/functional-requirements/#fr-13-oauth-login-google","title":"FR-1.3: OAuth Login (Google)","text":"<p>Priority: P1 | Use Case: UC-1.3</p> <p>User can log in using their Google account via OAuth 2.0.</p> <p>Acceptance Criteria:</p> <ul> <li>Google OAuth flow completes securely</li> <li>New users are automatically registered on first OAuth login</li> <li>Existing users can link Google account to email account</li> <li>Google profile photo and name are imported (optional)</li> </ul>"},{"location":"requirements/functional-requirements/#fr-14-offline-mode","title":"FR-1.4: Offline Mode","text":"<p>Priority: P0 | Use Case: UC-1.4</p> <p>User can use the application in offline mode without credentials or internet connection.</p> <p>Acceptance Criteria:</p> <ul> <li>All reading and library management features work offline</li> <li>Data is stored locally on device</li> <li>No account required for offline-only usage</li> <li>Offline users can later create account and migrate data</li> </ul>"},{"location":"requirements/functional-requirements/#fr-15-password-recovery","title":"FR-1.5: Password Recovery","text":"<p>Priority: P1 | Use Case: UC-1.5</p> <p>User can reset their password via email recovery link.</p> <p>Acceptance Criteria:</p> <ul> <li>Recovery link is sent to registered email</li> <li>Link expires after 24 hours</li> <li>Link is single-use and invalidated after password change</li> <li>User must set new password meeting security requirements</li> </ul>"},{"location":"requirements/functional-requirements/#fr-16-account-deletion","title":"FR-1.6: Account Deletion","text":"<p>Priority: P1 | Use Case: UC-1.6</p> <p>User can permanently delete their account and all associated data.</p> <p>Acceptance Criteria:</p> <ul> <li>Deletion requires password confirmation</li> <li>User is warned about data loss</li> <li>All user data is removed from server within 30 days</li> <li>Local device data remains unless explicitly deleted</li> </ul>"},{"location":"requirements/functional-requirements/#2-book-management","title":"2. Book Management","text":""},{"location":"requirements/functional-requirements/#fr-21-format-conversion","title":"FR-2.1: Format Conversion","text":"<p>Priority: P2 | Use Case: UC-2.2</p> <p>User can convert e-book files between supported formats (EPUB, PDF, MOBI).</p> <p>Acceptance Criteria:</p> <ul> <li>Conversion preserves content and basic formatting</li> <li>Original file is retained after conversion</li> <li>Progress indicator shown for large files</li> <li>Conversion errors are reported clearly</li> </ul>"},{"location":"requirements/functional-requirements/#fr-22-manual-metadata-editing","title":"FR-2.2: Manual Metadata Editing","text":"<p>Priority: P0 | Use Case: UC-2.3</p> <p>User can manually edit book metadata (title, author, description, etc.).</p> <p>Acceptance Criteria:</p> <ul> <li>Editable fields: title, subtitle, author, co-authors, publisher, publication date, ISBN, language, description, series, series number</li> <li>Changes are saved immediately</li> <li>Cover image can be replaced from file or URL</li> </ul>"},{"location":"requirements/functional-requirements/#fr-23-custom-metadata-fields","title":"FR-2.3: Custom Metadata Fields","text":"<p>Priority: P2 | Use Case: UC-2.3</p> <p>User can add and remove custom metadata fields to books.</p> <p>Acceptance Criteria:</p> <ul> <li>Custom fields have user-defined names</li> <li>Field values can be text, number, date, or boolean</li> <li>Custom fields are searchable</li> <li>Batch editing of custom fields is supported</li> </ul>"},{"location":"requirements/functional-requirements/#fr-24-book-file-export","title":"FR-2.4: Book File Export","text":"<p>Priority: P0 | Use Case: UC-2.7</p> <p>User can export selected book files from the system.</p> <p>Acceptance Criteria:</p> <ul> <li>Single or multiple books can be selected</li> <li>Export as individual files or ZIP archive</li> <li>Original file format is preserved</li> <li>Export includes embedded metadata</li> </ul>"},{"location":"requirements/functional-requirements/#fr-25-library-data-export","title":"FR-2.5: Library Data Export","text":"<p>Priority: P1 | Use Case: UC-2.7</p> <p>User can export library data in structured, human-readable formats.</p> <p>Acceptance Criteria:</p> <ul> <li>Export formats: JSON, CSV, OPML</li> <li>Includes all metadata, shelves, tags, and reading progress</li> <li>Annotations and notes can be included optionally</li> <li>Export can be filtered by shelf or tags</li> </ul>"},{"location":"requirements/functional-requirements/#fr-26-book-import","title":"FR-2.6: Book Import","text":"<p>Priority: P0 | Use Case: UC-2.1</p> <p>User can import books from files, URLs, or cloud storage.</p> <p>Acceptance Criteria:</p> <ul> <li>Supported import sources: local files, URLs, Google Drive, OneDrive, Dropbox</li> <li>Bulk import of multiple files/folders</li> <li>Metadata is automatically extracted from file</li> <li>Duplicate detection with merge options</li> </ul>"},{"location":"requirements/functional-requirements/#fr-27-full-text-search","title":"FR-2.7: Full-Text Search","text":"<p>Priority: P1 | Use Case: UC-2.6</p> <p>System provides full-text search within book contents.</p> <p>Acceptance Criteria:</p> <ul> <li>Search works for EPUB, TXT formats (PDF requires OCR)</li> <li>Results show matched text with context</li> <li>Search is case-insensitive by default</li> <li>Results link directly to location in book</li> </ul>"},{"location":"requirements/functional-requirements/#fr-28-advanced-search","title":"FR-2.8: Advanced Search","text":"<p>Priority: P0 | Use Case: UC-2.6</p> <p>System supports searching by metadata, tags, categories, and content.</p> <p>Acceptance Criteria:</p> <ul> <li>Searchable fields: title, author, description, ISBN, tags, shelves</li> <li>Filters: reading status, format, date added, publication date, rating</li> <li>Search results are sortable</li> <li>Recent searches are saved</li> </ul>"},{"location":"requirements/functional-requirements/#fr-29-shelf-organization","title":"FR-2.9: Shelf Organization","text":"<p>Priority: P0 | Use Case: UC-2.4</p> <p>User can create shelves to group books into collections.</p> <p>Acceptance Criteria:</p> <ul> <li>Shelves have name, description, and optional color</li> <li>Books can belong to multiple shelves</li> <li>Default shelves: \"Currently Reading\", \"Want to Read\", \"Finished\"</li> <li>Shelves can be nested (sub-shelves)</li> <li>Drag-and-drop organization</li> </ul>"},{"location":"requirements/functional-requirements/#fr-210-book-tagging","title":"FR-2.10: Book Tagging","text":"<p>Priority: P0 | Use Case: UC-2.5</p> <p>User can assign colored tags to books for organization and filtering.</p> <p>Acceptance Criteria:</p> <ul> <li>Tags have title and color (from palette or custom)</li> <li>Books can have 0-10 tags</li> <li>Tags are visible in library view</li> <li>Quick tag assignment via context menu</li> <li>Batch tagging supported</li> </ul>"},{"location":"requirements/functional-requirements/#fr-211-query-language-filters","title":"FR-2.11: Query Language Filters","text":"<p>Priority: P2 | Use Case: UC-2.6</p> <p>User can create complex filters using a query language.</p> <p>Acceptance Criteria:</p> <ul> <li>Query syntax similar to Jira/GitHub (e.g., <code>author:\"Name\" AND year:&gt;2000</code>)</li> <li>Supports AND, OR, NOT operators</li> <li>Date ranges, numeric comparisons</li> <li>Filters can be saved and named</li> <li>Graphical filter builder as alternative</li> </ul>"},{"location":"requirements/functional-requirements/#fr-212-isbn-barcode-scanning","title":"FR-2.12: ISBN Barcode Scanning","text":"<p>Priority: P2 | Use Case: UC-2.8</p> <p>User can scan ISBN barcodes to add physical books with fetched metadata.</p> <p>Acceptance Criteria:</p> <ul> <li>Camera-based barcode scanning (mobile/desktop with camera)</li> <li>ISBN lookup from multiple sources</li> <li>User can edit fetched metadata before saving</li> <li>Works offline with manual ISBN entry fallback</li> </ul>"},{"location":"requirements/functional-requirements/#fr-213-metadata-fetching","title":"FR-2.13: Metadata Fetching","text":"<p>Priority: P1 | Use Case: UC-2.3</p> <p>System can automatically fetch metadata from online sources.</p> <p>Acceptance Criteria:</p> <ul> <li>Sources: Open Library, Google Books (configurable)</li> <li>Fetch triggered manually or on import</li> <li>User reviews and confirms changes before applying</li> <li>Cover images can be fetched automatically</li> </ul>"},{"location":"requirements/functional-requirements/#fr-214-physical-book-tracking","title":"FR-2.14: Physical Book Tracking","text":"<p>Priority: P1 | Use Case: UC-2.9</p> <p>User can add and track physical books in their library.</p> <p>Acceptance Criteria:</p> <ul> <li>Manual entry of all metadata fields</li> <li>Physical books appear in library alongside digital</li> <li>Reading status and progress tracking</li> <li>Location field (e.g., \"Shelf 3\", \"Lent to John\")</li> </ul>"},{"location":"requirements/functional-requirements/#3-integrated-viewer","title":"3. Integrated Viewer","text":""},{"location":"requirements/functional-requirements/#fr-31-e-book-reading","title":"FR-3.1: E-book Reading","text":"<p>Priority: P0 | Use Case: UC-3.1</p> <p>User can read e-books using the integrated viewer.</p> <p>Acceptance Criteria:</p> <ul> <li>Supports: EPUB, PDF, MOBI, AZW3, TXT, CBR, CBZ</li> <li>Responsive layout adapts to screen size</li> <li>Reading position is automatically saved</li> <li>Table of contents navigation</li> <li>Page/chapter navigation</li> </ul>"},{"location":"requirements/functional-requirements/#fr-32-viewer-customization","title":"FR-3.2: Viewer Customization","text":"<p>Priority: P0 | Use Case: UC-3.2</p> <p>User can customize the viewer appearance and behavior.</p> <p>Acceptance Criteria:</p> <ul> <li>Typography: font family, size (8-72pt), weight, line height, letter spacing, paragraph spacing</li> <li>Colors: background, text, links (presets + custom)</li> <li>Layout: margins, padding, single/dual page, pagination/scroll</li> <li>Navigation: tap zones, swipe, volume keys, on-screen buttons</li> <li>Brightness: in-app control independent of system</li> </ul>"},{"location":"requirements/functional-requirements/#fr-33-reading-profiles","title":"FR-3.3: Reading Profiles","text":"<p>Priority: P1 | Use Case: UC-3.3</p> <p>User can create and manage named reading profiles.</p> <p>Acceptance Criteria:</p> <ul> <li>Profile contains all viewer customization settings</li> <li>Quick switch between profiles</li> <li>One profile can be set as default</li> <li>Profiles can be exported/imported</li> <li>Device-specific default profiles</li> </ul>"},{"location":"requirements/functional-requirements/#fr-34-bookmarks","title":"FR-3.4: Bookmarks","text":"<p>Priority: P0 | Use Case: UC-3.4</p> <p>User can create and manage bookmarks within books.</p> <p>Acceptance Criteria:</p> <ul> <li>Create bookmark at current position with optional note</li> <li>List all bookmarks for a book</li> <li>Jump to bookmark location</li> <li>Delete bookmarks</li> <li>Bookmarks sync across devices</li> </ul>"},{"location":"requirements/functional-requirements/#4-annotations-and-notes","title":"4. Annotations and Notes","text":""},{"location":"requirements/functional-requirements/#fr-41-text-highlighting","title":"FR-4.1: Text Highlighting","text":"<p>Priority: P0 | Use Case: UC-4.1</p> <p>User can highlight text while reading with optional notes.</p> <p>Acceptance Criteria:</p> <ul> <li>Select text and choose highlight color</li> <li>Multiple color options (at least 5)</li> <li>Optional note attached to highlight</li> <li>Highlights visible in text</li> <li>View all highlights in dedicated panel</li> </ul>"},{"location":"requirements/functional-requirements/#fr-42-book-notes","title":"FR-4.2: Book Notes","text":"<p>Priority: P0 | Use Case: UC-4.2</p> <p>User can create free-form notes associated with books.</p> <p>Acceptance Criteria:</p> <ul> <li>Notes have title and content</li> <li>Rich text or Markdown support</li> <li>Notes are not tied to specific text location</li> <li>Multiple notes per book</li> <li>Notes are searchable</li> </ul>"},{"location":"requirements/functional-requirements/#fr-43-annotation-editing","title":"FR-4.3: Annotation Editing","text":"<p>Priority: P0 | Use Case: UC-4.3</p> <p>User can edit and delete existing annotations and notes.</p> <p>Acceptance Criteria:</p> <ul> <li>Edit highlight color and attached note</li> <li>Edit note title and content</li> <li>Delete with confirmation</li> <li>Undo delete within session</li> </ul>"},{"location":"requirements/functional-requirements/#fr-44-annotation-export","title":"FR-4.4: Annotation Export","text":"<p>Priority: P1 | Use Case: UC-4.4</p> <p>User can export annotations and notes to external formats.</p> <p>Acceptance Criteria:</p> <ul> <li>Export formats: plain text, Markdown, PDF, HTML</li> <li>Include highlighted text with context</li> <li>Group by book or export all</li> <li>Include metadata (book title, date, page)</li> </ul>"},{"location":"requirements/functional-requirements/#fr-45-annotation-search","title":"FR-4.5: Annotation Search","text":"<p>Priority: P1 | Use Case: UC-4.5</p> <p>User can search through all annotations and notes.</p> <p>Acceptance Criteria:</p> <ul> <li>Search across all books or specific book</li> <li>Search in highlight text and note content</li> <li>Filter by color, date, book</li> <li>Results link to source location</li> </ul>"},{"location":"requirements/functional-requirements/#5-progress-tracking","title":"5. Progress Tracking","text":""},{"location":"requirements/functional-requirements/#fr-51-reading-statistics","title":"FR-5.1: Reading Statistics","text":"<p>Priority: P0 | Use Case: UC-5.1</p> <p>User can view comprehensive reading progress and statistics.</p> <p>Acceptance Criteria:</p> <ul> <li>Metrics: total time read, books completed, pages read, current streaks</li> <li>Per-book stats: time spent, sessions, reading velocity</li> <li>Visual charts and graphs</li> <li>Comparison to previous periods</li> </ul>"},{"location":"requirements/functional-requirements/#fr-52-statistics-filtering","title":"FR-5.2: Statistics Filtering","text":"<p>Priority: P1 | Use Case: UC-5.2</p> <p>User can filter statistics by time frame and book selection.</p> <p>Acceptance Criteria:</p> <ul> <li>Time frames: today, week, month, year, custom range</li> <li>Filter by: specific books, shelves, tags</li> <li>Export statistics data</li> <li>Save filter presets</li> </ul>"},{"location":"requirements/functional-requirements/#fr-53-cross-device-sync","title":"FR-5.3: Cross-Device Sync","text":"<p>Priority: P0 | Use Case: UC-7.3</p> <p>System synchronizes reading progress, metadata, and annotations across all logged-in devices via the metadata server.</p> <p>Acceptance Criteria:</p> <ul> <li>Reading position syncs within 30 seconds when online</li> <li>Metadata, shelves, tags, annotations sync automatically</li> <li>Offline changes queued and sync when connection restored</li> <li>Conflict resolution: latest timestamp wins for position, merge for metadata</li> <li>Sync status indicator visible in app (synced, syncing, offline, error)</li> <li>Requires metadata server connection (self-hosted or official)</li> </ul> <p>See Server Architecture for sync details.</p>"},{"location":"requirements/functional-requirements/#6-goal-management","title":"6. Goal Management","text":""},{"location":"requirements/functional-requirements/#fr-61-reading-goals","title":"FR-6.1: Reading Goals","text":"<p>Priority: P1 | Use Case: UC-6.1</p> <p>User can create time-based reading goals.</p> <p>Acceptance Criteria:</p> <ul> <li>Goal types: books per period, pages per period, time per period</li> <li>Periods: daily, weekly, monthly, yearly, custom</li> <li>Multiple active goals allowed</li> <li>Goal templates for quick creation</li> </ul>"},{"location":"requirements/functional-requirements/#fr-62-manual-goal-updates","title":"FR-6.2: Manual Goal Updates","text":"<p>Priority: P1 | Use Case: UC-6.2</p> <p>User can manually update goal progress values.</p> <p>Acceptance Criteria:</p> <ul> <li>Increment/decrement progress</li> <li>Set exact value</li> <li>Add notes to progress updates</li> <li>History of manual updates</li> </ul>"},{"location":"requirements/functional-requirements/#fr-63-automatic-goal-progress","title":"FR-6.3: Automatic Goal Progress","text":"<p>Priority: P1 | Use Case: UC-6.2</p> <p>System automatically updates goal progress based on reading activity.</p> <p>Acceptance Criteria:</p> <ul> <li>Book completion updates book-count goals</li> <li>Reading time updates time-based goals</li> <li>Pages read updates page-count goals</li> <li>Progress is calculated in real-time</li> </ul>"},{"location":"requirements/functional-requirements/#fr-64-goal-notifications","title":"FR-6.4: Goal Notifications","text":"<p>Priority: P2 | Use Case: UC-6.2</p> <p>System sends notifications about goal progress and reminders.</p> <p>Acceptance Criteria:</p> <ul> <li>Reminder notifications (configurable frequency)</li> <li>Milestone notifications (50%, 75%, complete)</li> <li>Streak notifications</li> <li>Notifications can be disabled per goal</li> </ul>"},{"location":"requirements/functional-requirements/#7-storage-and-synchronization","title":"7. Storage and Synchronization","text":""},{"location":"requirements/functional-requirements/#fr-71-file-storage-backend-selection","title":"FR-7.1: File Storage Backend Selection","text":"<p>Priority: P0 | Use Case: UC-7.1</p> <p>User can choose where book files are stored from application settings.</p> <p>Acceptance Criteria:</p> <ul> <li>Options: device local, Google Drive, OneDrive, Dropbox, WebDAV, MinIO/S3, dedicated Papyrus server</li> <li>Multiple backends can be configured simultaneously</li> <li>One backend is designated as primary for new uploads</li> <li>Files can be migrated between backends without data loss</li> <li>Backend configuration accessible from Settings &gt; Storage</li> <li>Connection status and storage usage displayed</li> </ul> <p>See Server Architecture for details.</p>"},{"location":"requirements/functional-requirements/#fr-711-metadata-server-configuration","title":"FR-7.1.1: Metadata Server Configuration","text":"<p>Priority: P0 | Use Case: UC-7.1</p> <p>User can configure connection to a metadata server for cross-device synchronization.</p> <p>Acceptance Criteria:</p> <ul> <li>Default: use official hosted server (optional)</li> <li>Self-hosted option: user provides server URL</li> <li>Server URL validation and connection testing</li> <li>Login/registration on metadata server</li> <li>Clear indication when offline or disconnected</li> <li>Works without metadata server (local-only mode)</li> </ul>"},{"location":"requirements/functional-requirements/#fr-72-file-upload","title":"FR-7.2: File Upload","text":"<p>Priority: P0 | Use Case: UC-2.1</p> <p>User can upload book files from their device.</p> <p>Acceptance Criteria:</p> <ul> <li>File picker with format filtering</li> <li>Drag-and-drop support (desktop/web)</li> <li>Progress indicator for large files</li> <li>Duplicate detection</li> </ul>"},{"location":"requirements/functional-requirements/#fr-73-ocr-processing","title":"FR-7.3: OCR Processing","text":"<p>Priority: P2 | Use Case: UC-7.2</p> <p>System can apply OCR to scanned documents for text extraction.</p> <p>Acceptance Criteria:</p> <ul> <li>Processes PDF files with scanned images</li> <li>Text becomes searchable after OCR</li> <li>Processing happens in background</li> <li>Quality/confidence indicator shown</li> <li>Multiple language support</li> </ul>"},{"location":"requirements/functional-requirements/#fr-74-plugin-system","title":"FR-7.4: Plugin System","text":"<p>Priority: P3 | Use Case: N/A</p> <p>System supports optional plugins for extended functionality.</p> <p>Acceptance Criteria:</p> <ul> <li>Plugin types: metadata sources, storage backends, reader features</li> <li>Plugins are sandboxed for security</li> <li>Enable/disable individual plugins</li> <li>Plugin marketplace/repository</li> </ul>"},{"location":"requirements/functional-requirements/#fr-75-opds-catalog-support","title":"FR-7.5: OPDS Catalog Support","text":"<p>Priority: P2 | Use Case: UC-7.4</p> <p>User can browse and download books from OPDS catalogs.</p> <p>Acceptance Criteria:</p> <ul> <li>Add OPDS catalog URLs</li> <li>Browse catalog hierarchy</li> <li>Search within catalogs</li> <li>Download books directly to library</li> <li>Authentication for protected catalogs</li> </ul>"},{"location":"requirements/functional-requirements/#requirements-traceability-matrix","title":"Requirements Traceability Matrix","text":"Requirement Priority Use Cases Actors FR-1.1 P0 UC-1.1 Anonymous \u2192 Registered FR-1.2 P0 UC-1.2 Registered FR-1.3 P1 UC-1.3 Registered FR-1.4 P0 UC-1.4 Anonymous, Registered FR-1.5 P1 UC-1.5 Registered FR-1.6 P1 UC-1.6 Registered FR-2.1 P2 UC-2.2 Reader FR-2.2 P0 UC-2.3 Reader FR-2.3 P2 UC-2.3 Reader FR-2.4 P0 UC-2.7 Reader FR-2.5 P1 UC-2.7 Reader FR-2.6 P0 UC-2.1 Reader FR-2.7 P1 UC-2.6 Reader FR-2.8 P0 UC-2.6 Reader FR-2.9 P0 UC-2.4 Reader FR-2.10 P0 UC-2.5 Reader FR-2.11 P2 UC-2.6 Reader FR-2.12 P2 UC-2.8 Reader FR-2.13 P1 UC-2.3 Reader FR-2.14 P1 UC-2.9 Reader FR-3.1 P0 UC-3.1 Reader, E-ink Reader FR-3.2 P0 UC-3.2 Reader, E-ink Reader FR-3.3 P1 UC-3.3 Reader, E-ink Reader FR-3.4 P0 UC-3.4 Reader FR-4.1 P0 UC-4.1 Reader FR-4.2 P0 UC-4.2 Reader FR-4.3 P0 UC-4.3 Reader FR-4.4 P1 UC-4.4 Reader FR-4.5 P1 UC-4.5 Reader FR-5.1 P0 UC-5.1 Reader FR-5.2 P1 UC-5.2 Reader FR-5.3 P0 UC-7.3 Registered FR-6.1 P1 UC-6.1 Reader FR-6.2 P1 UC-6.2 Reader FR-6.3 P1 UC-6.2 Reader FR-6.4 P2 UC-6.2 Reader FR-7.1 P0 UC-7.1 Registered, Admin FR-7.1.1 P0 UC-7.1 Registered FR-7.2 P0 UC-2.1 Reader FR-7.3 P2 UC-7.2 Reader FR-7.4 P3 N/A Developer FR-7.5 P2 UC-7.4 Reader"},{"location":"requirements/non-functional-requirements/","title":"Non-Functional Requirements","text":"<p>This document defines the non-functional requirements (quality attributes) for Papyrus. These requirements specify how the system should perform rather than what it should do.</p>"},{"location":"requirements/non-functional-requirements/#priority-levels","title":"Priority Levels","text":"Priority Description Target P0 Critical - Must meet for MVP v1.0 P1 High - Should meet for MVP v1.0 P2 Medium - Post-MVP target v1.x P3 Low - Future enhancement v2.x+"},{"location":"requirements/non-functional-requirements/#1-storage","title":"1. Storage","text":""},{"location":"requirements/non-functional-requirements/#nfr-11-maximum-file-size","title":"NFR-1.1: Maximum File Size","text":"<p>Priority: P0</p> <p>Maximum allowed file size shall not exceed 2048 MB (2 GB) per book file.</p> <p>Acceptance Criteria:</p> <ul> <li>Files up to 2 GB upload successfully</li> <li>Files exceeding 2 GB are rejected with clear error message</li> <li>Large file uploads show progress indicator</li> <li>Upload can be resumed after interruption (for files &gt; 100 MB)</li> </ul>"},{"location":"requirements/non-functional-requirements/#nfr-12-storage-backend-support","title":"NFR-1.2: Storage Backend Support","text":"<p>Priority: P0</p> <p>The system shall support multiple storage backends.</p> <p>Supported Backends:</p> <ol> <li>Local storage (device file system)</li> <li>Cloud storage: Google Drive, OneDrive, Dropbox</li> <li>Self-hosted server (MinIO, local file system)</li> <li>Network-attached storage (NAS via SMB/NFS)</li> </ol> <p>Acceptance Criteria:</p> <ul> <li>Each backend can be configured independently</li> <li>User can switch between backends without data loss</li> <li>Backend credentials are stored securely (encrypted)</li> <li>Connection status is visible to user</li> </ul>"},{"location":"requirements/non-functional-requirements/#nfr-13-multi-backend-configuration","title":"NFR-1.3: Multi-Backend Configuration","text":"<p>Priority: P1</p> <p>The system shall support multiple storage backends per user with automatic failover.</p> <p>Acceptance Criteria:</p> <ul> <li>User can configure up to 3 storage backends</li> <li>One backend is designated as primary</li> <li>Automatic failover to secondary if primary is unavailable</li> <li>Manual override to force specific backend</li> </ul>"},{"location":"requirements/non-functional-requirements/#nfr-14-file-encryption","title":"NFR-1.4: File Encryption","text":"<p>Priority: P2</p> <p>File encryption shall be available for sensitive content with user-controlled keys.</p> <p>Acceptance Criteria:</p> <ul> <li>AES-256 encryption for files at rest</li> <li>User-managed encryption keys</li> <li>Encrypted files are decrypted on-device only</li> <li>Key recovery mechanism available</li> </ul>"},{"location":"requirements/non-functional-requirements/#2-synchronization","title":"2. Synchronization","text":""},{"location":"requirements/non-functional-requirements/#nfr-21-onlineoffline-parity","title":"NFR-2.1: Online/Offline Parity","text":"<p>Priority: P0</p> <p>The system shall work in online and offline mode with full feature parity for core reading features.</p> <p>Acceptance Criteria:</p> <ul> <li>All reading features work offline</li> <li>Library management works offline</li> <li>Annotations and notes work offline</li> <li>Only sync and cloud features require connectivity</li> <li>Clear indicator of online/offline status</li> </ul>"},{"location":"requirements/non-functional-requirements/#nfr-22-offline-change-indicators","title":"NFR-2.2: Offline Change Indicators","text":"<p>Priority: P0</p> <p>Any changes made offline shall have an appropriate visual indicator.</p> <p>Acceptance Criteria:</p> <ul> <li>Unsynced items show sync-pending icon</li> <li>Last sync timestamp visible in settings</li> <li>Number of pending changes displayed</li> <li>User can manually trigger sync when online</li> </ul>"},{"location":"requirements/non-functional-requirements/#nfr-23-conflict-resolution","title":"NFR-2.3: Conflict Resolution","text":"<p>Priority: P1</p> <p>Synchronization conflicts shall be resolved with user-selectable strategies.</p> <p>Resolution Strategies:</p> <ol> <li>Server wins (default)</li> <li>Client wins</li> <li>Manual resolution (user chooses)</li> <li>Merge (where possible)</li> </ol> <p>Acceptance Criteria:</p> <ul> <li>User can set default strategy in settings</li> <li>Per-conflict override option</li> <li>Conflict history log</li> <li>No silent data loss</li> </ul>"},{"location":"requirements/non-functional-requirements/#nfr-24-sync-performance","title":"NFR-2.4: Sync Performance","text":"<p>Priority: P0</p> <p>Cross-device synchronization shall complete within 30 seconds under normal network conditions (&gt;= 1 Mbps).</p> <p>Acceptance Criteria:</p> <ul> <li>Reading position syncs within 30 seconds</li> <li>Metadata changes sync within 1 minute</li> <li>Book files sync based on file size and bandwidth</li> <li>Background sync does not impact reading performance</li> </ul>"},{"location":"requirements/non-functional-requirements/#3-platform-support","title":"3. Platform Support","text":""},{"location":"requirements/non-functional-requirements/#nfr-31-web-browser-support","title":"NFR-3.1: Web Browser Support","text":"<p>Priority: P0</p> <p>The system shall be available in modern web browsers.</p> <p>Supported Browsers:</p> <ul> <li>Chrome 90+</li> <li>Firefox 90+</li> <li>Safari 14+</li> <li>Edge 90+</li> </ul> <p>Acceptance Criteria:</p> <ul> <li>All core features work in supported browsers</li> <li>Progressive Web App (PWA) installable</li> <li>Offline capability via service worker</li> <li>Responsive design for all viewport sizes</li> </ul>"},{"location":"requirements/non-functional-requirements/#nfr-32-desktop-operating-system-support","title":"NFR-3.2: Desktop Operating System Support","text":"<p>Priority: P0</p> <p>The system shall be available on major desktop operating systems.</p> <p>Supported Operating Systems:</p> <ul> <li>Windows 10 or later</li> <li>macOS 10.15 (Catalina) or later</li> <li>Major Linux distributions (Ubuntu 20.04+, Fedora 35+, Debian 11+)</li> </ul> <p>Acceptance Criteria:</p> <ul> <li>Native application available for each platform</li> <li>Platform-specific keyboard shortcuts</li> <li>System tray/menu bar integration</li> <li>File association for supported formats</li> </ul>"},{"location":"requirements/non-functional-requirements/#nfr-33-mobile-operating-system-support","title":"NFR-3.3: Mobile Operating System Support","text":"<p>Priority: P0</p> <p>The system shall work on mobile devices.</p> <p>Supported Platforms:</p> <ul> <li>Android 8.0 (API level 26) or later</li> <li>iOS 12.0 or later</li> </ul> <p>Acceptance Criteria:</p> <ul> <li>App available in Google Play Store and Apple App Store</li> <li>Touch-optimized interface</li> <li>Support for device orientation changes</li> <li>Background sync support</li> <li>Push notifications (optional)</li> </ul>"},{"location":"requirements/non-functional-requirements/#nfr-34-e-ink-device-support","title":"NFR-3.4: E-ink Device Support","text":"<p>Priority: P1</p> <p>The system shall support e-ink readers and tablets with touch interfaces.</p> <p>Target Devices:</p> <ul> <li>Kobo readers (via sideloading)</li> <li>Android-based e-ink devices (Boox, Hisense)</li> <li>reMarkable (future consideration)</li> </ul> <p>Acceptance Criteria:</p> <ul> <li>E-ink optimized UI mode (high contrast, grayscale)</li> <li>Reduced/disabled animations</li> <li>Larger touch targets (minimum 48px)</li> <li>Support for hardware page-turn buttons</li> <li>Reduced screen refresh for battery efficiency</li> <li>Dark-on-light and light-on-dark themes optimized for e-ink</li> </ul>"},{"location":"requirements/non-functional-requirements/#4-performance","title":"4. Performance","text":""},{"location":"requirements/non-functional-requirements/#nfr-41-application-startup","title":"NFR-4.1: Application Startup","text":"<p>Priority: P0</p> <p>Application startup time shall not exceed 3 seconds on supported devices.</p> <p>Acceptance Criteria:</p> <ul> <li>Cold start &lt; 3 seconds on mid-range devices (2020+)</li> <li>Warm start &lt; 1 second</li> <li>Library view loads within 2 seconds of app start</li> <li>Progress indicator shown if startup exceeds 1 second</li> </ul>"},{"location":"requirements/non-functional-requirements/#nfr-42-book-opening","title":"NFR-4.2: Book Opening","text":"<p>Priority: P0</p> <p>Book opening time shall not exceed 2 seconds for files up to 50 MB.</p> <p>Acceptance Criteria:</p> <ul> <li>EPUB &lt; 50 MB opens in &lt; 2 seconds</li> <li>PDF &lt; 50 MB opens in &lt; 3 seconds</li> <li>Progress indicator for larger files</li> <li>Last reading position restored automatically</li> <li>Opening performance measured on mid-range devices</li> </ul>"},{"location":"requirements/non-functional-requirements/#nfr-43-search-performance","title":"NFR-4.3: Search Performance","text":"<p>Priority: P0</p> <p>Search results shall be returned within 1 second for libraries up to 10,000 books.</p> <p>Acceptance Criteria:</p> <ul> <li>Metadata search returns in &lt; 500ms</li> <li>Full-text search returns in &lt; 1 second</li> <li>Results are paginated for large result sets</li> <li>Search is cancelable</li> <li>Incremental results shown as available</li> </ul>"},{"location":"requirements/non-functional-requirements/#nfr-44-library-scalability","title":"NFR-4.4: Library Scalability","text":"<p>Priority: P1</p> <p>The system shall support libraries with up to 50,000 books without performance degradation.</p> <p>Acceptance Criteria:</p> <ul> <li>Library view loads in &lt; 3 seconds with 50,000 books</li> <li>Search remains under 2 seconds</li> <li>Scrolling remains smooth (60 FPS on capable devices)</li> <li>Memory usage scales linearly with library size</li> <li>Virtual scrolling for large lists</li> </ul>"},{"location":"requirements/non-functional-requirements/#nfr-45-e-ink-performance","title":"NFR-4.5: E-ink Performance","text":"<p>Priority: P1</p> <p>The system shall be optimized for e-ink display refresh characteristics.</p> <p>Acceptance Criteria:</p> <ul> <li>Page turns complete in &lt; 500ms</li> <li>Minimal full-refresh operations</li> <li>Partial refresh used where possible</li> <li>UI updates batched to reduce flicker</li> <li>Animation duration configurable (default: 0 for e-ink)</li> </ul>"},{"location":"requirements/non-functional-requirements/#5-usability","title":"5. Usability","text":""},{"location":"requirements/non-functional-requirements/#nfr-51-design-system","title":"NFR-5.1: Design System","text":"<p>Priority: P0</p> <p>The user interface shall follow Material 3 design guidelines.</p> <p>Acceptance Criteria:</p> <ul> <li>Consistent use of Material 3 components</li> <li>Dynamic color theming support</li> <li>Consistent typography scale</li> <li>Proper use of elevation and surfaces</li> <li>Dark/light theme support</li> </ul>"},{"location":"requirements/non-functional-requirements/#nfr-52-accessibility","title":"NFR-5.2: Accessibility","text":"<p>Priority: P0</p> <p>The application shall be accessible to users with disabilities (WCAG 2.1 AA compliance).</p> <p>Acceptance Criteria:</p> <ul> <li>Screen reader compatibility (TalkBack, VoiceOver)</li> <li>Minimum color contrast ratio 4.5:1</li> <li>All interactive elements keyboard accessible</li> <li>Focus indicators visible</li> <li>Text scalable up to 200%</li> <li>No information conveyed by color alone</li> <li>Touch targets minimum 44x44 points</li> </ul>"},{"location":"requirements/non-functional-requirements/#nfr-53-rtl-and-internationalization","title":"NFR-5.3: RTL and Internationalization","text":"<p>Priority: P1</p> <p>The system shall support right-to-left (RTL) languages and internationalization.</p> <p>Acceptance Criteria:</p> <ul> <li>UI mirrors correctly for RTL languages</li> <li>Book content renders correctly for RTL text</li> <li>Date/time formats localized</li> <li>Number formats localized</li> <li>Bidirectional text support</li> </ul>"},{"location":"requirements/non-functional-requirements/#nfr-54-localization","title":"NFR-5.4: Localization","text":"<p>Priority: P1</p> <p>All user-facing text shall be localizable.</p> <p>Acceptance Criteria:</p> <ul> <li>English as primary language</li> <li>Localization framework in place for additional languages</li> <li>No hardcoded user-facing strings</li> <li>Locale can be overridden in settings</li> <li>Pluralization rules supported</li> </ul>"},{"location":"requirements/non-functional-requirements/#nfr-55-e-ink-usability","title":"NFR-5.5: E-ink Usability","text":"<p>Priority: P1</p> <p>The system shall provide optimized usability for e-ink displays.</p> <p>Acceptance Criteria:</p> <ul> <li>High contrast theme option</li> <li>Simplified UI with fewer visual elements</li> <li>Large, clear typography</li> <li>Reduced reliance on hover states</li> <li>Clear button/touch feedback without animations</li> </ul>"},{"location":"requirements/non-functional-requirements/#6-security","title":"6. Security","text":""},{"location":"requirements/non-functional-requirements/#nfr-61-password-security","title":"NFR-6.1: Password Security","text":"<p>Priority: P0</p> <p>User passwords shall be hashed using industry-standard algorithms.</p> <p>Acceptance Criteria:</p> <ul> <li>Passwords hashed with bcrypt or Argon2</li> <li>Minimum password length: 8 characters</li> <li>Password strength indicator during registration</li> <li>No plaintext password storage or transmission</li> <li>Secure password reset mechanism</li> </ul>"},{"location":"requirements/non-functional-requirements/#nfr-62-transport-security","title":"NFR-6.2: Transport Security","text":"<p>Priority: P0</p> <p>All data transmission shall use TLS 1.3 or higher encryption.</p> <p>Acceptance Criteria:</p> <ul> <li>HTTPS required for all API communication</li> <li>Certificate pinning for mobile apps (optional)</li> <li>No fallback to unencrypted connections</li> <li>TLS 1.2 minimum (1.3 preferred)</li> </ul>"},{"location":"requirements/non-functional-requirements/#nfr-63-two-factor-authentication","title":"NFR-6.3: Two-Factor Authentication","text":"<p>Priority: P2</p> <p>The system shall support two-factor authentication (TOTP).</p> <p>Acceptance Criteria:</p> <ul> <li>TOTP-based 2FA (Google Authenticator compatible)</li> <li>Backup codes available</li> <li>2FA can be enabled/disabled by user</li> <li>Graceful recovery if 2FA device lost</li> </ul>"},{"location":"requirements/non-functional-requirements/#nfr-64-session-management","title":"NFR-6.4: Session Management","text":"<p>Priority: P0</p> <p>Session management shall include automatic timeout and secure token handling.</p> <p>Acceptance Criteria:</p> <ul> <li>JWT tokens with configurable expiration</li> <li>Refresh token rotation</li> <li>Sessions can be revoked remotely</li> <li>Automatic logout after inactivity (configurable)</li> <li>Secure token storage on device</li> </ul>"},{"location":"requirements/non-functional-requirements/#nfr-65-privacy-by-default","title":"NFR-6.5: Privacy by Default","text":"<p>Priority: P0</p> <p>The application shall collect no analytics by default; telemetry is opt-in.</p> <p>Acceptance Criteria:</p> <ul> <li>No analytics without explicit consent</li> <li>Clear privacy policy accessible in-app</li> <li>Telemetry settings easily accessible</li> <li>No third-party tracking SDKs by default</li> <li>Data collection scope clearly explained</li> </ul>"},{"location":"requirements/non-functional-requirements/#7-reliability","title":"7. Reliability","text":""},{"location":"requirements/non-functional-requirements/#nfr-71-system-uptime","title":"NFR-7.1: System Uptime","text":"<p>Priority: P1</p> <p>The system shall have 99.5% uptime for self-hosted deployments under normal conditions.</p> <p>Acceptance Criteria:</p> <ul> <li>Maximum planned downtime: 4 hours/month</li> <li>Health check endpoints available</li> <li>Graceful degradation during partial outages</li> <li>Automatic recovery from transient failures</li> </ul>"},{"location":"requirements/non-functional-requirements/#nfr-72-data-integrity","title":"NFR-7.2: Data Integrity","text":"<p>Priority: P0</p> <p>Data corruption shall be prevented through checksums and integrity verification.</p> <p>Acceptance Criteria:</p> <ul> <li>File checksums verified on upload/download</li> <li>Database transactions are atomic</li> <li>Corrupted files detected and reported</li> <li>No silent data corruption</li> </ul>"},{"location":"requirements/non-functional-requirements/#nfr-73-network-resilience","title":"NFR-7.3: Network Resilience","text":"<p>Priority: P0</p> <p>The system shall gracefully handle network interruptions without data loss.</p> <p>Acceptance Criteria:</p> <ul> <li>Operations are idempotent where possible</li> <li>Uploads/downloads resumable</li> <li>No data loss on network failure</li> <li>Clear error messages for network issues</li> <li>Automatic retry with exponential backoff</li> </ul>"},{"location":"requirements/non-functional-requirements/#nfr-74-backup-and-restore","title":"NFR-7.4: Backup and Restore","text":"<p>Priority: P1</p> <p>Automatic backup and restore capabilities shall be available for user data.</p> <p>Acceptance Criteria:</p> <ul> <li>Export all user data in portable format</li> <li>Import/restore from backup</li> <li>Scheduled automatic backups (optional)</li> <li>Backup integrity verification</li> </ul>"},{"location":"requirements/non-functional-requirements/#8-extensibility","title":"8. Extensibility","text":""},{"location":"requirements/non-functional-requirements/#nfr-81-plugin-architecture","title":"NFR-8.1: Plugin Architecture","text":"<p>Priority: P3</p> <p>The architecture shall support modular plugins without compromising core stability.</p> <p>Acceptance Criteria:</p> <ul> <li>Plugin API documented</li> <li>Plugins run in sandboxed environment</li> <li>Core functionality unaffected by plugin failures</li> <li>Plugin enable/disable without restart</li> <li>Version compatibility checking</li> </ul>"},{"location":"requirements/non-functional-requirements/#9-maintainability","title":"9. Maintainability","text":""},{"location":"requirements/non-functional-requirements/#nfr-91-code-quality","title":"NFR-9.1: Code Quality","text":"<p>Priority: P1</p> <p>The codebase shall maintain high quality standards.</p> <p>Acceptance Criteria:</p> <ul> <li>Automated linting (dart analyze)</li> <li>Code formatting enforced (dart format)</li> <li>Minimum 70% test coverage for core functionality</li> <li>No critical security vulnerabilities</li> <li>Documentation for public APIs</li> </ul>"},{"location":"requirements/non-functional-requirements/#nfr-92-logging-and-monitoring","title":"NFR-9.2: Logging and Monitoring","text":"<p>Priority: P1</p> <p>The system shall provide comprehensive logging and monitoring capabilities.</p> <p>Acceptance Criteria:</p> <ul> <li>Structured logging for all components</li> <li>Log levels configurable (debug, info, warning, error)</li> <li>No sensitive data in logs</li> <li>Log rotation and retention policies</li> <li>Error tracking integration (optional)</li> </ul>"},{"location":"requirements/non-functional-requirements/#requirements-summary","title":"Requirements Summary","text":""},{"location":"requirements/non-functional-requirements/#mvp-p0p1-requirements-count","title":"MVP (P0/P1) Requirements Count","text":"Category P0 P1 Total Storage 2 1 3 Synchronization 3 1 4 Platforms 3 1 4 Performance 3 2 5 Usability 2 3 5 Security 3 0 3 Reliability 1 2 3 Extensibility 0 0 0 Maintainability 0 2 2 Total 17 12 29"},{"location":"requirements/non-functional-requirements/#post-mvp-p2p3-requirements","title":"Post-MVP (P2/P3) Requirements","text":"Requirement Priority Description NFR-1.4 P2 File Encryption NFR-6.3 P2 Two-Factor Authentication NFR-8.1 P3 Plugin Architecture"}]}